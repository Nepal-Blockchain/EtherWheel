<!DOCTYPE html>
<html>
  <head>
    <title>Ether Wheel</title>
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no" />
    <base href="/">

    <!-- Styles -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/styles.min.css">

    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
  </head>

  <body ng-app="ether-spinner" ng-cloak>
    <div class="container" style="height: 100%;">
      <div class="jumbotron">
        <h1>
          <img src="./assets/ethereumLogo.png" class="ethereum-logo">
          <strong>ether wheel<span style="color: #5cb85c;">.io</span></strong>
        </h1>

        <p>
          Each time an Ether Wheel is filled, <span style="font-weight: bold;">all of the ether<small style="font-weight: normal;">*</small> in the wheel will be awarded to a randomly-selected participant</span>. The more ether you contribute, the higher your odds of being the winner. For example, contributing 0.2 ether to the 1-ether wheel would give you a 20% chance of winning it all.
        </p>
      </div>

      <div ng-controller="SpinnerCtrl as vm" class="row">
        <div class="wheel-area col-md-6" style="position: ">
          <canvas id="wheel" height="260px"></canvas>
          <div class="wheel-text">
            <span class="current-ether" ng-if="vm.isConnected()">{{ vm.newBalance | currency:"":2 }}</span>
            <span class="current-ether" ng-if="!vm.isConnected()">?</span>
            of {{ vm.goal }} ether
            <div class="percentage">({{ vm.newBalance / vm.goal * 100 | number:0 }}% full)</div>
          </div>
        </div>

        <div class="row col-md-6">
          <ul class="panel panel-default nav nav-pills col-xlg-6" style="display: flex; justify-content: space-between;">
            <li role="presentation" class="active"><a href="#"><small>Ξ </small>1.0 Wheel</a></li>
            <li role="presentation"><a href="#"><small>Ξ </small>3.0 Wheel</a></li>
            <li role="presentation"><a href="#"><small>Ξ </small>5.0 Wheel</a></li>
          </ul>

          <div class="col-xlg-6">
            <div class="panel panel-default" ng-if="vm.isConnected()">
              <div class="panel-heading">
                Your Contribution
                <select class="form-control pull-right account-selector" style="height: auto; width: auto;" ng-model="vm.selectedAccount" ng-change="vm.onAccountChanged()">
                  <option ng-repeat="account in vm.accounts | orderBy:account" value="{{ account }}">
                    {{ account.toString() }} (<small>Ξ </small>{{ vm.getBalance(account).toString() | number:2}})
                  </option>
                </select>
              </div>
              <div class="panel-body">
                You currently have <strong style="font-size: 1.3em"><small>Ξ </small>{{ vm.currentContribution | number:2 }}</strong> in this wheel and <strong style="font-size: 1.3em"><small>Ξ </small>{{ vm.getBalance(vm.selectedAccount).toString() | number:2 }}</strong> in your account.

                <div class="row">
                  <div class="col-xs-7">
                    <rzslider
                      rz-slider-model="vm.desiredContribution"
                      rz-slider-options="{ floor: 0, ceil: (vm.goal - vm.balance + vm.currentContribution).toFixed(2), step: vm.sliderStep, precision: 2, onChange: vm.onSliderChanged }"
                    >
                    </rzslider>
                  </div>

                  <div class="col-xs-5" style="position: relative;">
                    <button
                      class="btn btn-success btn-set-contribution"
                      ng-disabled="vm.currentContribution == vm.desiredContribution"
                      ng-click="vm.setContribution()"
                      >
                      <span ng-hide="vm.newBalance == vm.goal">
                        Set Contribution to <small>Ξ </small>{{ vm.desiredContribution | number:2}}
                      </span>

                      <span ng-show="vm.newBalance == vm.goal">
                        Complete the Wheel! (<small>Ξ </small>{{ vm.desiredContribution | number:2}})
                      </span>
                    </button>
                  </div>

                  <p class="subtext pull-right" style="margin-top: 10px; margin-right: 15px; margin-bottom: 0; text-align: right;">
                    This would give you a <span style="font-weight:bold">{{ vm.desiredContribution / vm.goal * 100 | number:0 }}%</span> chance of winning all <small>Ξ </small>{{ vm.goal }}*.
                  </p>
                </div>
              </div>
            </div>
          </div>

          <div class="col-xlg-6">
            <div class="panel panel-default recent-winners-box" ng-if="vm.isConnected()">
              <div class="panel-heading">
                Recent Winners
              </div>
              <div class="panel-body">
                <div ng-if="vm.recentWins.length === 0" style="margin:30px;"><em>This wheel is still on its first round. You could be the first winner!</em></div>
                <table class="table table-striped">
                  <tbody>
                    <tr ng-repeat="winner in vm.recentWins | orderBy:'winner[1]':true">
                      <td>
                        <span ng-if="winner[0] == vm.selectedAccount"><i class="fa fa-star" style="color: #f0ad4e; margin-right: 7px;"></i>You <small>({{ winner[0] }})</small></span>
                        <span ng-if="winner[0] != vm.selectedAccount">{{ winner[0] }}</span>
                        <span class="pull-right">
                          {{ vm.moment(winner[1].toString(), 'X').fromNow() }}
                        </span>
                        <br>
                        <span class="subtext">contributed <small>Ξ </small>{{ vm.fromWei(winner[2], 'ether').toString() | number:2 }}</span>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>

          <div class="panel panel-danger not-connected-error" ng-if="!vm.isConnected()">
            <div class="panel-heading"><i class="fa fa-exclamation-circle"></i> ERROR: NOT CONNECTED TO ETHEREUM</div>
            <div class="panel-body">
              <p>
                There was a problem connecting to the Ethereum network. Your Ethereum client needs to accept cross-origin requests from this domain by using the following command:
              </p>
              <br>
              <code class="well-sm">
                geth --rpc --rpccorsdomain "http://etherwheel.io"
              </code>

              <p><br>
                To put any ether into the wheel, you'll also need to access this page through the <a href="https://github.com/ethereum/mist/releases/tag/0.3.6">early developer release</a> of Mist, the official Ethereum browser.
              </p>

              <div style="margin-top: 40px;">
                When you're ready, just refresh the page to begin.
              </div>
            </div>
          </div>
        </div>
        <span class="subtext pull-right" style="margin-right: 30px">*1% of the total winnings are credited to the developer.</span>
      </div>
    </div>

    <div class="info-boxes">
      <div class="container">
        <div class="panel panel-default info-box">
          <header><i class="fa fa-question-circle"></i>How do I use this application?</header>
          <p>
            Ether Wheel is a distributed application running on the <a href="http://www.ethereum.org">Ethereum network</a>. Each wheel has a designated capacity. Users can put as much ether as they want into the wheel. When the wheel is filled up, a winner is randomly selected, weighted by the amount of ether each participant contributed. All of the ether in the wheel is then sent to that account. In other words, the amount of ether that you put in is directly correlated with your chances of winning the entire pot.
          </p>
        </div>

        <div class="panel panel-default info-box">
          <header><i class="fa fa-lock"></i>How can I trust that this site works the way it claims?</header>
          <p>
            TODO
          </p>
        </div>

        <div class="panel panel-default info-box">
          <header><i class="fa fa-undo"></i>Can my ether be refunded?</header>
          <p>
            Yes! Before the wheel fills up and a winner is chosen, you can raise or lower your contribution at any time. However, once the wheel has been filled, the ether will be sent to the winner, and this cannot be undone.
          </p>
        </div>

        <div class="panel panel-default info-box">
          <header><i class="fa fa-user-secret"></i>Is it possible to cheat?</header>
          </p>The short answer: no.</p>
          <p>
            The long answer: those of you who are cryptographically-savvy may notice that Ether Wheel uses a block hash as the seed to semi-randomly determine the winner. Mathematically-speaking, there does exist a slim chance for a miner using this dapp to abandon a block that does not declare them as the winner. However, since the reward for mining a block is 5 ether, and all ether wheels have a capacity of 5 ether or less, there is absolutely no incentive for a miner to attempt performing this cheat, since it would result in a net loss of ether for them.
          </p>
        </div>

        <div class="panel panel-default info-box">
          <header><i class="fa fa-bitcoin"></i>Do you benefit from this?</header>
          <p>
            The Ether Wheel smart-contract does send me (the developer) 1% of the pool at the time that a winner is declared, in order to compensate me for hosting/domain name fees and my development time. <i class="fa fa-smile-o"></i> Other than that, Ether Wheel only benefits its users. Keep in mind that ether is <em>not</em> a currency and should not be treated as such. The Ethereum Project defines ether as "an internal token that is used to pay for computation time."
          </p>
        </div>

        <div class="panel panel-default info-box">
          <header><i class="fa fa-life-ring"></i>How can I support this site?</header>
          <p>
            If you're a developer, feel free to make suggestions or pull requests on GitHub to improve this dapp. If you have feedback or questions, you can reach me on reddit at <a href="http://www.reddit.com/u/doppio">/u/doppio</a> If you just want to show your approval and support the Ethereum community, why not a few finney to my Ethereum account? <i class="fa fa-smile-o"></i></i><br><code>0xEeD1614CDEfBBdAd2cC8Af7AF2fd4beB93F1cCAc</code>
          </p>
        </div>
      </div>
    </div>
    <footer>
      Powered by <a href="http://www.ethereum.org">Ethereum</a>.
    </footer>

    <script src="/vendor.min.js"></script>
    <script src="/app.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
  </body>
</html>
