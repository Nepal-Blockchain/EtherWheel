!function(){"use strict";angular.module("ether-spinner",["ngRoute","rzModule"]).config(["$routeProvider",function(e){e.otherwise({redirectTo:"/"})}])}(),function(){"use strict";function e(e,t,n){function a(){if(o(),n.isConnected()){var e=[{constant:!0,inputs:[{name:"",type:"address"}],name:"stakes",outputs:[{name:"",type:"uint256"}],type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"stakeholders",outputs:[{name:"",type:"address"}],type:"function"},{constant:!0,inputs:[],name:"goal",outputs:[{name:"",type:"uint256"}],type:"function"},{constant:!1,inputs:[],name:"refundStake",outputs:[],type:"function"},{constant:!1,inputs:[],name:"destroy",outputs:[],type:"function"},{constant:!0,inputs:[],name:"increment",outputs:[{name:"",type:"uint256"}],type:"function"},{constant:!0,inputs:[],name:"numStakeholders",outputs:[{name:"",type:"uint256"}],type:"function"},{constant:!1,inputs:[{name:"rejectPartialBets",type:"bool"}],name:"buyStake",outputs:[],type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"recentWins",outputs:[{name:"winner",type:"address"},{name:"timestamp",type:"uint256"},{name:"stake",type:"uint256"}],type:"function"},{constant:!0,inputs:[],name:"host",outputs:[{name:"",type:"address"}],type:"function"},{inputs:[{name:"_goalInFinney",type:"uint256"},{name:"_incrementInFinney",type:"uint256"},{name:"_recentWinsCount",type:"uint8"}],type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,name:"winner",type:"address"},{indexed:!1,name:"timestamp",type:"uint256"},{indexed:!1,name:"stake",type:"uint256"}],name:"Won",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"stakeholder",type:"address"}],name:"ChangedStake",type:"event"}],t=n.web3.eth.contract(e);h=t.at(g),p.goal=n.web3.fromWei(h.goal(),"ether").toString(),p.sliderStep=n.web3.fromWei(h.increment(),"ether").toString(),p.onSliderChanged=l,v.value=p.goal,p.accounts=n.web3.eth.accounts,p.selectedAccount=n.web3.eth.defaultAccount,p.selectedAccount||(p.selectedAccount=n.web3.eth.coinbase),i(),u(),s(),p.newBalance=p.balance-p.desiredStakes,r();var a=h.ChangedStake();a.watch(c);var m=h.Won();m.watch(d)}}function o(){var e=[v],t={animationEasing:"easeInOut",segmentStrokeWidth:3,animationSteps:20,segmentStrokeColor:"#EBF0F1",percentageInnerCutout:75,responsive:!0,tooltipTemplate:function(e){var t=e.label===p.selectedAccount?"You":e.label,n=t+": "+e.value+" Îž";if(p.goal){var a=e.value/p.goal*100;n+=" ("+Math.round(100*a)/100+"%)"}return n}},n=document.getElementById("wheel").getContext("2d");m=new Chart(n).Doughnut(e,t)}function s(){if(n.isConnected()){var e=n.web3.eth.getBalance(g),t=n.web3.fromWei(e,"ether"),a=p.desiredStakes-p.currentStakes;p.balance=parseFloat(t.toString()),p.newBalance=p.balance+a,m.segments[m.segments.length-1].value=p.goal-p.newBalance,m.update()}}function u(){n.isConnected()&&(p.currentStakes=parseFloat(n.web3.fromWei(h.stakes(p.selectedAccount),"ether").toString()),p.desiredStakes=p.currentStakes)}function i(){if(n.isConnected()){m.removeData(),f={};for(var e=h.numStakeholders(),t=0;e>t;++t){var a=h.stakeholders(t).toString();f[a]={label:a,value:n.web3.fromWei(h.stakes(a),"ether"),color:a===p.selectedAccount?"#5cb85c":"#3D3E3F",index:t},m.addData(f[a])}m.addData(v),m.update()}}function r(){!n.isConnected()}function c(e,a){if(!e){var o=a.args.stakeholder.toString(),i=n.web3.fromWei(h.stakes(o),"ether");if(o in f)m.segments[f[o].index].value=i;else{var r=Object.keys(f).length;f[o]={label:o,value:i,color:o===p.selectedAccount?"#5cb85c":"#3D3E3F",index:r},m.addData(f[o],r),console.log(r)}m.update()}s(),u(),t.$apply()}function d(e,n){s(),u(),r(),t.$apply()}function l(e,t){m.segments[f[p.selectedAccount.toString()].index].value=t,s()}var p=this;p.isConnected=n.isConnected;var m,f,y="#dae4e7",g="0xaCD9e1e68622285Cc3d339D04b76BA7acEE6FC1C",h=null,v={value:5,color:y,label:"Empty"};a()}e.$inject=["$route","$scope","ethereum"],angular.module("ether-spinner").controller("SpinnerCtrl",e)}(),function(){"use strict";function e(){function e(){n.web3.setProvider(new n.web3.providers.HttpProvider("http://localhost:8545"))}function t(){return n.web3.currentProvider.isConnected()}var n={web3:new Web3,isConnected:t};return e(),n}angular.module("ether-spinner").service("ethereum",e)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsInNwaW5uZXIuY29udHJvbGxlci5qcyIsImFwcC5taW4uanMiLCJldGhlcmV1bS5zZXJ2aWNlLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkcm91dGVQcm92aWRlciIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCJTcGlubmVyQ3RybCIsIiRyb3V0ZSIsIiRzY29wZSIsImV0aGVyZXVtIiwiYWN0aXZhdGUiLCJjcmVhdGVDaGFydCIsImlzQ29ubmVjdGVkIiwiYWJpIiwiY29uc3RhbnQiLCJpbnB1dHMiLCJuYW1lIiwidHlwZSIsIm91dHB1dHMiLCJhbm9ueW1vdXMiLCJpbmRleGVkIiwiY29udHJhY3RCbHVlcHJpbnQiLCJ3ZWIzIiwiZXRoIiwiY29udHJhY3QiLCJhdCIsImNvbnRyYWN0QWRkcmVzcyIsInZtIiwiZ29hbCIsImZyb21XZWkiLCJ0b1N0cmluZyIsInNsaWRlclN0ZXAiLCJpbmNyZW1lbnQiLCJvblNsaWRlckNoYW5nZWQiLCJlbXB0eURhdGFTbG90IiwidmFsdWUiLCJhY2NvdW50cyIsInNlbGVjdGVkQWNjb3VudCIsImRlZmF1bHRBY2NvdW50IiwiY29pbmJhc2UiLCJpbml0aWFsaXplU3Rha2Vob2xkZXJzRGF0YSIsInVwZGF0ZVN0YWtlcyIsInVwZGF0ZUJhbGFuY2UiLCJuZXdCYWxhbmNlIiwiYmFsYW5jZSIsImRlc2lyZWRTdGFrZXMiLCJ1cGRhdGVSZWNlbnRSZXN1bHRzIiwib25TdGFrZUNoYW5nZWRFdmVudCIsIkNoYW5nZWRTdGFrZSIsIndhdGNoIiwib25TdGFrZUNoYW5nZWQiLCJvbldvbkV2ZW50IiwiV29uIiwib25Xb24iLCJzdGFydGluZ0RhdGEiLCJjaGFydE9wdGlvbnMiLCJhbmltYXRpb25FYXNpbmciLCJzZWdtZW50U3Ryb2tlV2lkdGgiLCJhbmltYXRpb25TdGVwcyIsInNlZ21lbnRTdHJva2VDb2xvciIsInBlcmNlbnRhZ2VJbm5lckN1dG91dCIsInJlc3BvbnNpdmUiLCJ0b29sdGlwVGVtcGxhdGUiLCJ2YWx1ZU9iamVjdCIsImxhYmVsIiwidG9vbHRpcCIsInBlcmNlbnRhZ2UiLCJNYXRoIiwicm91bmQiLCJjdHgiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiZ2V0Q29udGV4dCIsImNoYXJ0IiwiQ2hhcnQiLCJEb3VnaG51dCIsIndlaSIsImdldEJhbGFuY2UiLCJldGhlciIsImRlbHRhU3Rha2VzIiwiY3VycmVudFN0YWtlcyIsInBhcnNlRmxvYXQiLCJzZWdtZW50cyIsImxlbmd0aCIsInVwZGF0ZSIsInN0YWtlcyIsInJlbW92ZURhdGEiLCJzdGFrZWhvbGRlcnNEYXRhIiwibnVtU3Rha2Vob2xkZXJzIiwiaSIsInN0YWtlaG9sZGVyQWRkcmVzcyIsInN0YWtlaG9sZGVycyIsImNvbG9yIiwiaW5kZXgiLCJhZGREYXRhIiwiZXJyb3IiLCJyZXN1bHQiLCJhcmdzIiwic3Rha2Vob2xkZXIiLCJPYmplY3QiLCJrZXlzIiwiY29uc29sZSIsImxvZyIsIiRhcHBseSIsInNsaWRlcklkIiwibW9kZWxWYWx1ZSIsInRoaXMiLCJlbXB0eUJhckNvbG91ciIsIiRpbmplY3QiLCJjb250cm9sbGVyIiwic2VydmljZSIsInNldFByb3ZpZGVyIiwicHJvdmlkZXJzIiwiSHR0cFByb3ZpZGVyIiwiY3VycmVudFByb3ZpZGVyIiwiV2ViMyJdLCJtYXBwaW5ncyI6IkNBQUEsV0FDRSxZQUVBQSxTQUFRQyxPQUFPLGlCQUNiLFVBQ0EsYUFFRkMsUUFBUSxpQkFBa0IsU0FBU0MsR0FDakNBLEVBQWVDLFdBQVdDLFdBQVksWUNSMUMsV0FDRSxZQUtBLFNBQVNDLEdBQVlDLEVBQVFDLEVBQVFDLEdBb0JuQyxRQUFTQyxLQUVQLEdBREFDLElBQ0lGLEVBQVNHLGNBQWIsQ0FFQSxHQUFJQyxLQUFRQyxVQUFXLEVBQUtDLFNBQVdDLEtBQU8sR0FBR0MsS0FBTyxZQUFZRCxLQUFPLFNBQVNFLFVBQVlGLEtBQU8sR0FBR0MsS0FBTyxZQUFZQSxLQUFPLGFBQWFILFVBQVcsRUFB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YSwwQkFHbkUsUUFBU3JHLEtBQ1AsTUFBT2tHLEdBQVF4RixLQUFLNEYsZ0JBQWdCdEcsY0FoQnRDLEdBQUlrRyxJQUNGeEYsS0FBTSxHQUFJNkYsTUFDVnZHLFlBQWFBLEVBS2YsT0FGQUYsS0FFT29HLEVBWFQ5RyxRQUFRQyxPQUFPLGlCQUFpQjZHLFFBQVEsV0FBWXJHIiwiZmlsZSI6ImFwcC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnZXRoZXItc3Bpbm5lcicsIFtcbiAgICAnbmdSb3V0ZScsXG4gICAgJ3J6TW9kdWxlJ1xuICBdKS5cbiAgY29uZmlnKFsnJHJvdXRlUHJvdmlkZXInLCBmdW5jdGlvbigkcm91dGVQcm92aWRlcikge1xuICAgICRyb3V0ZVByb3ZpZGVyLm90aGVyd2lzZSh7cmVkaXJlY3RUbzogJy8nfSk7XG4gIH1dKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnZXRoZXItc3Bpbm5lcicpLmNvbnRyb2xsZXIoJ1NwaW5uZXJDdHJsJywgU3Bpbm5lckN0cmwpO1xuXG4gIC8qQG5nSW5qZWN0Ki9cbiAgZnVuY3Rpb24gU3Bpbm5lckN0cmwoJHJvdXRlLCAkc2NvcGUsIGV0aGVyZXVtKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5pc0Nvbm5lY3RlZCA9IGV0aGVyZXVtLmlzQ29ubmVjdGVkO1xuXG4gICAgdmFyIGVtcHR5QmFyQ29sb3VyID0gJyNkYWU0ZTcnO1xuICAgIHZhciBjb250cmFjdEFkZHJlc3MgPSAnMHhhQ0Q5ZTFlNjg2MjIyODVDYzNkMzM5RDA0Yjc2QkE3YWNFRTZGQzFDJztcbiAgICB2YXIgY29udHJhY3QgPSBudWxsO1xuXG4gICAgdmFyIGNoYXJ0O1xuICAgIHZhciBzdGFrZWhvbGRlcnNEYXRhO1xuICAgIHZhciBlbXB0eURhdGFTbG90ID0ge1xuICAgICAgdmFsdWU6IDUuMCxcbiAgICAgIGNvbG9yOiBlbXB0eUJhckNvbG91cixcbiAgICAgIGxhYmVsOiBcIkVtcHR5XCJcbiAgICB9O1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgY3JlYXRlQ2hhcnQoKTtcbiAgICAgIGlmKCFldGhlcmV1bS5pc0Nvbm5lY3RlZCgpKSB7IHJldHVybjsgfVxuXG4gICAgICB2YXIgYWJpID0gW3tcImNvbnN0YW50XCI6dHJ1ZSxcImlucHV0c1wiOlt7XCJuYW1lXCI6XCJcIixcInR5cGVcIjpcImFkZHJlc3NcIn1dLFwibmFtZVwiOlwic3Rha2VzXCIsXCJvdXRwdXRzXCI6W3tcIm5hbWVcIjpcIlwiLFwidHlwZVwiOlwidWludDI1NlwifV0sXCJ0eXBlXCI6XCJmdW5jdGlvblwifSx7XCJjb25zdGFudFwiOnRydWUsXCJpbnB1dHNcIjpbe1wibmFtZVwiOlwiXCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9XSxcIm5hbWVcIjpcInN0YWtlaG9sZGVyc1wiLFwib3V0cHV0c1wiOlt7XCJuYW1lXCI6XCJcIixcInR5cGVcIjpcImFkZHJlc3NcIn1dLFwidHlwZVwiOlwiZnVuY3Rpb25cIn0se1wiY29uc3RhbnRcIjp0cnVlLFwiaW5wdXRzXCI6W10sXCJuYW1lXCI6XCJnb2FsXCIsXCJvdXRwdXRzXCI6W3tcIm5hbWVcIjpcIlwiLFwidHlwZVwiOlwidWludDI1NlwifV0sXCJ0eXBlXCI6XCJmdW5jdGlvblwifSx7XCJjb25zdGFudFwiOmZhbHNlLFwiaW5wdXRzXCI6W10sXCJuYW1lXCI6XCJyZWZ1bmRTdGFrZVwiLFwib3V0cHV0c1wiOltdLFwidHlwZVwiOlwiZnVuY3Rpb25cIn0se1wiY29uc3RhbnRcIjpmYWxzZSxcImlucHV0c1wiOltdLFwibmFtZVwiOlwiZGVzdHJveVwiLFwib3V0cHV0c1wiOltdLFwidHlwZVwiOlwiZnVuY3Rpb25cIn0se1wiY29uc3RhbnRcIjp0cnVlLFwiaW5wdXRzXCI6W10sXCJuYW1lXCI6XCJpbmNyZW1lbnRcIixcIm91dHB1dHNcIjpbe1wibmFtZVwiOlwiXCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9XSxcInR5cGVcIjpcImZ1bmN0aW9uXCJ9LHtcImNvbnN0YW50XCI6dHJ1ZSxcImlucHV0c1wiOltdLFwibmFtZVwiOlwibnVtU3Rha2Vob2xkZXJzXCIsXCJvdXRwdXRzXCI6W3tcIm5hbWVcIjpcIlwiLFwidHlwZVwiOlwidWludDI1NlwifV0sXCJ0eXBlXCI6XCJmdW5jdGlvblwifSx7XCJjb25zdGFudFwiOmZhbHNlLFwiaW5wdXRzXCI6W3tcIm5hbWVcIjpcInJlamVjdFBhcnRpYWxCZXRzXCIsXCJ0eXBlXCI6XCJib29sXCJ9XSxcIm5hbWVcIjpcImJ1eVN0YWtlXCIsXCJvdXRwdXRzXCI6W10sXCJ0eXBlXCI6XCJmdW5jdGlvblwifSx7XCJjb25zdGFudFwiOnRydWUsXCJpbnB1dHNcIjpbe1wibmFtZVwiOlwiXCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9XSxcIm5hbWVcIjpcInJlY2VudFdpbnNcIixcIm91dHB1dHNcIjpbe1wibmFtZVwiOlwid2lubmVyXCIsXCJ0eXBlXCI6XCJhZGRyZXNzXCJ9LHtcIm5hbWVcIjpcInRpbWVzdGFtcFwiLFwidHlwZVwiOlwidWludDI1NlwifSx7XCJuYW1lXCI6XCJzdGFrZVwiLFwidHlwZVwiOlwidWludDI1NlwifV0sXCJ0eXBlXCI6XCJmdW5jdGlvblwifSx7XCJjb25zdGFudFwiOnRydWUsXCJpbnB1dHNcIjpbXSxcIm5hbWVcIjpcImhvc3RcIixcIm91dHB1dHNcIjpbe1wibmFtZVwiOlwiXCIsXCJ0eXBlXCI6XCJhZGRyZXNzXCJ9XSxcInR5cGVcIjpcImZ1bmN0aW9uXCJ9LHtcImlucHV0c1wiOlt7XCJuYW1lXCI6XCJfZ29hbEluRmlubmV5XCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9LHtcIm5hbWVcIjpcIl9pbmNyZW1lbnRJbkZpbm5leVwiLFwidHlwZVwiOlwidWludDI1NlwifSx7XCJuYW1lXCI6XCJfcmVjZW50V2luc0NvdW50XCIsXCJ0eXBlXCI6XCJ1aW50OFwifV0sXCJ0eXBlXCI6XCJjb25zdHJ1Y3RvclwifSx7XCJhbm9ueW1vdXNcIjpmYWxzZSxcImlucHV0c1wiOlt7XCJpbmRleGVkXCI6ZmFsc2UsXCJuYW1lXCI6XCJ3aW5uZXJcIixcInR5cGVcIjpcImFkZHJlc3NcIn0se1wiaW5kZXhlZFwiOmZhbHNlLFwibmFtZVwiOlwidGltZXN0YW1wXCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9LHtcImluZGV4ZWRcIjpmYWxzZSxcIm5hbWVcIjpcInN0YWtlXCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9XSxcIm5hbWVcIjpcIldvblwiLFwidHlwZVwiOlwiZXZlbnRcIn0se1wiYW5vbnltb3VzXCI6ZmFsc2UsXCJpbnB1dHNcIjpbe1wiaW5kZXhlZFwiOmZhbHNlLFwibmFtZVwiOlwic3Rha2Vob2xkZXJcIixcInR5cGVcIjpcImFkZHJlc3NcIn1dLFwibmFtZVwiOlwiQ2hhbmdlZFN0YWtlXCIsXCJ0eXBlXCI6XCJldmVudFwifV07XG4gICAgICB2YXIgY29udHJhY3RCbHVlcHJpbnQgPSBldGhlcmV1bS53ZWIzLmV0aC5jb250cmFjdChhYmkpO1xuICAgICAgY29udHJhY3QgPSBjb250cmFjdEJsdWVwcmludC5hdChjb250cmFjdEFkZHJlc3MpO1xuXG4gICAgICB2bS5nb2FsID0gZXRoZXJldW0ud2ViMy5mcm9tV2VpKGNvbnRyYWN0LmdvYWwoKSwgJ2V0aGVyJykudG9TdHJpbmcoKTtcbiAgICAgIHZtLnNsaWRlclN0ZXAgPSBldGhlcmV1bS53ZWIzLmZyb21XZWkoY29udHJhY3QuaW5jcmVtZW50KCksICdldGhlcicpLnRvU3RyaW5nKCk7XG4gICAgICB2bS5vblNsaWRlckNoYW5nZWQgPSBvblNsaWRlckNoYW5nZWQ7XG4gICAgICBlbXB0eURhdGFTbG90LnZhbHVlID0gdm0uZ29hbDtcblxuICAgICAgdm0uYWNjb3VudHMgPSBldGhlcmV1bS53ZWIzLmV0aC5hY2NvdW50cztcbiAgICAgIHZtLnNlbGVjdGVkQWNjb3VudCA9IGV0aGVyZXVtLndlYjMuZXRoLmRlZmF1bHRBY2NvdW50O1xuICAgICAgaWYoIXZtLnNlbGVjdGVkQWNjb3VudCkge1xuICAgICAgICB2bS5zZWxlY3RlZEFjY291bnQgPSBldGhlcmV1bS53ZWIzLmV0aC5jb2luYmFzZTtcbiAgICAgIH1cblxuICAgICAgaW5pdGlhbGl6ZVN0YWtlaG9sZGVyc0RhdGEoKTtcbiAgICAgIHVwZGF0ZVN0YWtlcygpO1xuICAgICAgdXBkYXRlQmFsYW5jZSgpO1xuICAgICAgdm0ubmV3QmFsYW5jZSA9IHZtLmJhbGFuY2UgLSB2bS5kZXNpcmVkU3Rha2VzO1xuICAgICAgdXBkYXRlUmVjZW50UmVzdWx0cygpO1xuXG4gICAgICB2YXIgb25TdGFrZUNoYW5nZWRFdmVudCA9IGNvbnRyYWN0LkNoYW5nZWRTdGFrZSgpO1xuICAgICAgb25TdGFrZUNoYW5nZWRFdmVudC53YXRjaChvblN0YWtlQ2hhbmdlZCk7XG5cbiAgICAgIHZhciBvbldvbkV2ZW50ID0gY29udHJhY3QuV29uKCk7XG4gICAgICBvbldvbkV2ZW50LndhdGNoKG9uV29uKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVDaGFydCgpIHtcbiAgICAgIHZhciBzdGFydGluZ0RhdGEgPSBbZW1wdHlEYXRhU2xvdF07XG5cbiAgICAgIHZhciBjaGFydE9wdGlvbnMgPSB7XG4gICAgICAgIGFuaW1hdGlvbkVhc2luZzogJ2Vhc2VJbk91dCcsXG4gICAgICAgIHNlZ21lbnRTdHJva2VXaWR0aDogMyxcbiAgICAgICAgYW5pbWF0aW9uU3RlcHM6IDIwLFxuICAgICAgICBzZWdtZW50U3Ryb2tlQ29sb3I6ICcjRUJGMEYxJyxcbiAgICAgICAgcGVyY2VudGFnZUlubmVyQ3V0b3V0OiA3NSxcbiAgICAgICAgcmVzcG9uc2l2ZTogdHJ1ZSxcbiAgICAgICAgdG9vbHRpcFRlbXBsYXRlOiBmdW5jdGlvbih2YWx1ZU9iamVjdCkge1xuICAgICAgICAgIHZhciBuYW1lID0gKHZhbHVlT2JqZWN0LmxhYmVsID09PSB2bS5zZWxlY3RlZEFjY291bnQpID8gJ1lvdScgOiB2YWx1ZU9iamVjdC5sYWJlbDtcbiAgICAgICAgICB2YXIgdG9vbHRpcCA9IG5hbWUgKyAnOiAnICsgdmFsdWVPYmplY3QudmFsdWUgKyAnIM6eJztcbiAgICAgICAgICBpZighIXZtLmdvYWwpIHtcbiAgICAgICAgICAgIHZhciBwZXJjZW50YWdlID0gKHZhbHVlT2JqZWN0LnZhbHVlIC8gdm0uZ29hbCAqIDEwMCk7XG4gICAgICAgICAgICB0b29sdGlwICs9ICcgKCcgKyBNYXRoLnJvdW5kKHBlcmNlbnRhZ2UgKiAxMDApIC8gMTAwICsgJyUpJ1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gdG9vbHRpcDtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgdmFyIGN0eCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwid2hlZWxcIikuZ2V0Q29udGV4dChcIjJkXCIpO1xuICAgICAgY2hhcnQgPSBuZXcgQ2hhcnQoY3R4KS5Eb3VnaG51dChzdGFydGluZ0RhdGEsIGNoYXJ0T3B0aW9ucyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdXBkYXRlQmFsYW5jZSgpIHtcbiAgICAgIGlmKCFldGhlcmV1bS5pc0Nvbm5lY3RlZCgpKSB7IHJldHVybjsgfVxuXG4gICAgICB2YXIgd2VpID0gZXRoZXJldW0ud2ViMy5ldGguZ2V0QmFsYW5jZShjb250cmFjdEFkZHJlc3MpO1xuICAgICAgdmFyIGV0aGVyID0gZXRoZXJldW0ud2ViMy5mcm9tV2VpKHdlaSwgJ2V0aGVyJyk7XG4gICAgICB2YXIgZGVsdGFTdGFrZXMgPSAodm0uZGVzaXJlZFN0YWtlcyAtIHZtLmN1cnJlbnRTdGFrZXMpO1xuICAgICAgdm0uYmFsYW5jZSA9IHBhcnNlRmxvYXQoZXRoZXIudG9TdHJpbmcoKSk7XG4gICAgICB2bS5uZXdCYWxhbmNlID0gdm0uYmFsYW5jZSArIGRlbHRhU3Rha2VzO1xuICAgICAgY2hhcnQuc2VnbWVudHNbY2hhcnQuc2VnbWVudHMubGVuZ3RoIC0gMV0udmFsdWUgPSAodm0uZ29hbCAtIHZtLm5ld0JhbGFuY2UpO1xuICAgICAgY2hhcnQudXBkYXRlKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdXBkYXRlU3Rha2VzKCkge1xuICAgICAgaWYoIWV0aGVyZXVtLmlzQ29ubmVjdGVkKCkpIHsgcmV0dXJuOyB9XG4gICAgICB2bS5jdXJyZW50U3Rha2VzID0gcGFyc2VGbG9hdChldGhlcmV1bS53ZWIzLmZyb21XZWkoY29udHJhY3Quc3Rha2VzKHZtLnNlbGVjdGVkQWNjb3VudCksICdldGhlcicpLnRvU3RyaW5nKCkpO1xuICAgICAgdm0uZGVzaXJlZFN0YWtlcyA9IHZtLmN1cnJlbnRTdGFrZXM7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW5pdGlhbGl6ZVN0YWtlaG9sZGVyc0RhdGEoKSB7XG4gICAgICBpZighZXRoZXJldW0uaXNDb25uZWN0ZWQoKSkgeyByZXR1cm47IH1cblxuICAgICAgY2hhcnQucmVtb3ZlRGF0YSgpO1xuICAgICAgc3Rha2Vob2xkZXJzRGF0YSA9IHt9O1xuICAgICAgdmFyIG51bVN0YWtlaG9sZGVycyA9IGNvbnRyYWN0Lm51bVN0YWtlaG9sZGVycygpO1xuICAgICAgZm9yKHZhciBpID0gMDsgaSA8IG51bVN0YWtlaG9sZGVyczsgKytpKSB7XG4gICAgICAgIHZhciBzdGFrZWhvbGRlckFkZHJlc3MgPSBjb250cmFjdC5zdGFrZWhvbGRlcnMoaSkudG9TdHJpbmcoKTtcbiAgICAgICAgc3Rha2Vob2xkZXJzRGF0YVtzdGFrZWhvbGRlckFkZHJlc3NdID0ge1xuICAgICAgICAgIGxhYmVsOiBzdGFrZWhvbGRlckFkZHJlc3MsXG4gICAgICAgICAgdmFsdWU6IGV0aGVyZXVtLndlYjMuZnJvbVdlaShjb250cmFjdC5zdGFrZXMoc3Rha2Vob2xkZXJBZGRyZXNzKSwgJ2V0aGVyJyksXG4gICAgICAgICAgY29sb3I6IChzdGFrZWhvbGRlckFkZHJlc3MgPT09IHZtLnNlbGVjdGVkQWNjb3VudCkgPyAnIzVjYjg1YycgOiAnIzNEM0UzRicsXG4gICAgICAgICAgaW5kZXg6IGlcbiAgICAgICAgfTtcblxuICAgICAgICBjaGFydC5hZGREYXRhKHN0YWtlaG9sZGVyc0RhdGFbc3Rha2Vob2xkZXJBZGRyZXNzXSk7XG4gICAgICB9XG5cbiAgICAgIGNoYXJ0LmFkZERhdGEoZW1wdHlEYXRhU2xvdCk7XG4gICAgICBjaGFydC51cGRhdGUoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB1cGRhdGVSZWNlbnRSZXN1bHRzKCkge1xuICAgICAgaWYoIWV0aGVyZXVtLmlzQ29ubmVjdGVkKCkpIHsgcmV0dXJuOyB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25TdGFrZUNoYW5nZWQoZXJyb3IsIHJlc3VsdCkge1xuICAgICAgLy8gVE9ETzogQ2hlY2sgaWYgZGVzaXJlZCBjb250cmlidXRpb24gbmVlZHMgdG8gYmUgcmVkdWNlZFxuXG4gICAgICBpZighZXJyb3IpIHtcbiAgICAgICAgdmFyIHN0YWtlaG9sZGVyQWRkcmVzcyA9IHJlc3VsdC5hcmdzLnN0YWtlaG9sZGVyLnRvU3RyaW5nKCk7XG4gICAgICAgIHZhciB2YWx1ZSA9IGV0aGVyZXVtLndlYjMuZnJvbVdlaShjb250cmFjdC5zdGFrZXMoc3Rha2Vob2xkZXJBZGRyZXNzKSwgJ2V0aGVyJyk7XG4gICAgICAgIGlmKHN0YWtlaG9sZGVyQWRkcmVzcyBpbiBzdGFrZWhvbGRlcnNEYXRhKSB7XG4gICAgICAgICAgY2hhcnQuc2VnbWVudHNbc3Rha2Vob2xkZXJzRGF0YVtzdGFrZWhvbGRlckFkZHJlc3NdLmluZGV4XS52YWx1ZSA9IHZhbHVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBpbmRleCA9IE9iamVjdC5rZXlzKHN0YWtlaG9sZGVyc0RhdGEpLmxlbmd0aDtcbiAgICAgICAgICBzdGFrZWhvbGRlcnNEYXRhW3N0YWtlaG9sZGVyQWRkcmVzc10gPSB7XG4gICAgICAgICAgICBsYWJlbDogc3Rha2Vob2xkZXJBZGRyZXNzLFxuICAgICAgICAgICAgdmFsdWU6IHZhbHVlLFxuICAgICAgICAgICAgY29sb3I6IChzdGFrZWhvbGRlckFkZHJlc3MgPT09IHZtLnNlbGVjdGVkQWNjb3VudCkgPyAnIzVjYjg1YycgOiAnIzNEM0UzRicsXG4gICAgICAgICAgICBpbmRleDogaW5kZXhcbiAgICAgICAgICB9O1xuICAgICAgICAgIGNoYXJ0LmFkZERhdGEoc3Rha2Vob2xkZXJzRGF0YVtzdGFrZWhvbGRlckFkZHJlc3NdLCBpbmRleCk7XG4gICAgICAgICAgY29uc29sZS5sb2coaW5kZXgpO1xuICAgICAgICB9XG5cbiAgICAgICAgY2hhcnQudXBkYXRlKCk7XG4gICAgICB9XG5cbiAgICAgIHVwZGF0ZUJhbGFuY2UoKTtcbiAgICAgIHVwZGF0ZVN0YWtlcygpO1xuICAgICAgJHNjb3BlLiRhcHBseSgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9uV29uKGVycm9yLCByZXN1bHQpIHtcbiAgICAgIHVwZGF0ZUJhbGFuY2UoKTtcbiAgICAgIHVwZGF0ZVN0YWtlcygpO1xuICAgICAgdXBkYXRlUmVjZW50UmVzdWx0cygpO1xuICAgICAgJHNjb3BlLiRhcHBseSgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9uU2xpZGVyQ2hhbmdlZChzbGlkZXJJZCwgbW9kZWxWYWx1ZSkge1xuICAgICAgY2hhcnQuc2VnbWVudHNbc3Rha2Vob2xkZXJzRGF0YVt2bS5zZWxlY3RlZEFjY291bnQudG9TdHJpbmcoKV0uaW5kZXhdLnZhbHVlID0gbW9kZWxWYWx1ZTtcbiAgICAgIHVwZGF0ZUJhbGFuY2UoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZWxvYWRQYWdlKCkge1xuICAgICAgJHJvdXRlLnJlbG9hZCgpO1xuICAgIH1cbiAgfVxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCdldGhlci1zcGlubmVyJywgW1xuICAgICduZ1JvdXRlJyxcbiAgICAncnpNb2R1bGUnXG4gIF0pLlxuICBjb25maWcoWyckcm91dGVQcm92aWRlcicsIGZ1bmN0aW9uKCRyb3V0ZVByb3ZpZGVyKSB7XG4gICAgJHJvdXRlUHJvdmlkZXIub3RoZXJ3aXNlKHtyZWRpcmVjdFRvOiAnLyd9KTtcbiAgfV0pO1xufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgU3Bpbm5lckN0cmwuJGluamVjdCA9IFtcIiRyb3V0ZVwiLCBcIiRzY29wZVwiLCBcImV0aGVyZXVtXCJdO1xuICBhbmd1bGFyLm1vZHVsZSgnZXRoZXItc3Bpbm5lcicpLmNvbnRyb2xsZXIoJ1NwaW5uZXJDdHJsJywgU3Bpbm5lckN0cmwpO1xuXG4gIC8qQG5nSW5qZWN0Ki9cbiAgZnVuY3Rpb24gU3Bpbm5lckN0cmwoJHJvdXRlLCAkc2NvcGUsIGV0aGVyZXVtKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5pc0Nvbm5lY3RlZCA9IGV0aGVyZXVtLmlzQ29ubmVjdGVkO1xuXG4gICAgdmFyIGVtcHR5QmFyQ29sb3VyID0gJyNkYWU0ZTcnO1xuICAgIHZhciBjb250cmFjdEFkZHJlc3MgPSAnMHhhQ0Q5ZTFlNjg2MjIyODVDYzNkMzM5RDA0Yjc2QkE3YWNFRTZGQzFDJztcbiAgICB2YXIgY29udHJhY3QgPSBudWxsO1xuXG4gICAgdmFyIGNoYXJ0O1xuICAgIHZhciBzdGFrZWhvbGRlcnNEYXRhO1xuICAgIHZhciBlbXB0eURhdGFTbG90ID0ge1xuICAgICAgdmFsdWU6IDUuMCxcbiAgICAgIGNvbG9yOiBlbXB0eUJhckNvbG91cixcbiAgICAgIGxhYmVsOiBcIkVtcHR5XCJcbiAgICB9O1xuXG4gICAgYWN0aXZhdGUoKTtcblxuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgY3JlYXRlQ2hhcnQoKTtcbiAgICAgIGlmKCFldGhlcmV1bS5pc0Nvbm5lY3RlZCgpKSB7IHJldHVybjsgfVxuXG4gICAgICB2YXIgYWJpID0gW3tcImNvbnN0YW50XCI6dHJ1ZSxcImlucHV0c1wiOlt7XCJuYW1lXCI6XCJcIixcInR5cGVcIjpcImFkZHJlc3NcIn1dLFwibmFtZVwiOlwic3Rha2VzXCIsXCJvdXRwdXRzXCI6W3tcIm5hbWVcIjpcIlwiLFwidHlwZVwiOlwidWludDI1NlwifV0sXCJ0eXBlXCI6XCJmdW5jdGlvblwifSx7XCJjb25zdGFudFwiOnRydWUsXCJpbnB1dHNcIjpbe1wibmFtZVwiOlwiXCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9XSxcIm5hbWVcIjpcInN0YWtlaG9sZGVyc1wiLFwib3V0cHV0c1wiOlt7XCJuYW1lXCI6XCJcIixcInR5cGVcIjpcImFkZHJlc3NcIn1dLFwidHlwZVwiOlwiZnVuY3Rpb25cIn0se1wiY29uc3RhbnRcIjp0cnVlLFwiaW5wdXRzXCI6W10sXCJuYW1lXCI6XCJnb2FsXCIsXCJvdXRwdXRzXCI6W3tcIm5hbWVcIjpcIlwiLFwidHlwZVwiOlwidWludDI1NlwifV0sXCJ0eXBlXCI6XCJmdW5jdGlvblwifSx7XCJjb25zdGFudFwiOmZhbHNlLFwiaW5wdXRzXCI6W10sXCJuYW1lXCI6XCJyZWZ1bmRTdGFrZVwiLFwib3V0cHV0c1wiOltdLFwidHlwZVwiOlwiZnVuY3Rpb25cIn0se1wiY29uc3RhbnRcIjpmYWxzZSxcImlucHV0c1wiOltdLFwibmFtZVwiOlwiZGVzdHJveVwiLFwib3V0cHV0c1wiOltdLFwidHlwZVwiOlwiZnVuY3Rpb25cIn0se1wiY29uc3RhbnRcIjp0cnVlLFwiaW5wdXRzXCI6W10sXCJuYW1lXCI6XCJpbmNyZW1lbnRcIixcIm91dHB1dHNcIjpbe1wibmFtZVwiOlwiXCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9XSxcInR5cGVcIjpcImZ1bmN0aW9uXCJ9LHtcImNvbnN0YW50XCI6dHJ1ZSxcImlucHV0c1wiOltdLFwibmFtZVwiOlwibnVtU3Rha2Vob2xkZXJzXCIsXCJvdXRwdXRzXCI6W3tcIm5hbWVcIjpcIlwiLFwidHlwZVwiOlwidWludDI1NlwifV0sXCJ0eXBlXCI6XCJmdW5jdGlvblwifSx7XCJjb25zdGFudFwiOmZhbHNlLFwiaW5wdXRzXCI6W3tcIm5hbWVcIjpcInJlamVjdFBhcnRpYWxCZXRzXCIsXCJ0eXBlXCI6XCJib29sXCJ9XSxcIm5hbWVcIjpcImJ1eVN0YWtlXCIsXCJvdXRwdXRzXCI6W10sXCJ0eXBlXCI6XCJmdW5jdGlvblwifSx7XCJjb25zdGFudFwiOnRydWUsXCJpbnB1dHNcIjpbe1wibmFtZVwiOlwiXCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9XSxcIm5hbWVcIjpcInJlY2VudFdpbnNcIixcIm91dHB1dHNcIjpbe1wibmFtZVwiOlwid2lubmVyXCIsXCJ0eXBlXCI6XCJhZGRyZXNzXCJ9LHtcIm5hbWVcIjpcInRpbWVzdGFtcFwiLFwidHlwZVwiOlwidWludDI1NlwifSx7XCJuYW1lXCI6XCJzdGFrZVwiLFwidHlwZVwiOlwidWludDI1NlwifV0sXCJ0eXBlXCI6XCJmdW5jdGlvblwifSx7XCJjb25zdGFudFwiOnRydWUsXCJpbnB1dHNcIjpbXSxcIm5hbWVcIjpcImhvc3RcIixcIm91dHB1dHNcIjpbe1wibmFtZVwiOlwiXCIsXCJ0eXBlXCI6XCJhZGRyZXNzXCJ9XSxcInR5cGVcIjpcImZ1bmN0aW9uXCJ9LHtcImlucHV0c1wiOlt7XCJuYW1lXCI6XCJfZ29hbEluRmlubmV5XCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9LHtcIm5hbWVcIjpcIl9pbmNyZW1lbnRJbkZpbm5leVwiLFwidHlwZVwiOlwidWludDI1NlwifSx7XCJuYW1lXCI6XCJfcmVjZW50V2luc0NvdW50XCIsXCJ0eXBlXCI6XCJ1aW50OFwifV0sXCJ0eXBlXCI6XCJjb25zdHJ1Y3RvclwifSx7XCJhbm9ueW1vdXNcIjpmYWxzZSxcImlucHV0c1wiOlt7XCJpbmRleGVkXCI6ZmFsc2UsXCJuYW1lXCI6XCJ3aW5uZXJcIixcInR5cGVcIjpcImFkZHJlc3NcIn0se1wiaW5kZXhlZFwiOmZhbHNlLFwibmFtZVwiOlwidGltZXN0YW1wXCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9LHtcImluZGV4ZWRcIjpmYWxzZSxcIm5hbWVcIjpcInN0YWtlXCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9XSxcIm5hbWVcIjpcIldvblwiLFwidHlwZVwiOlwiZXZlbnRcIn0se1wiYW5vbnltb3VzXCI6ZmFsc2UsXCJpbnB1dHNcIjpbe1wiaW5kZXhlZFwiOmZhbHNlLFwibmFtZVwiOlwic3Rha2Vob2xkZXJcIixcInR5cGVcIjpcImFkZHJlc3NcIn1dLFwibmFtZVwiOlwiQ2hhbmdlZFN0YWtlXCIsXCJ0eXBlXCI6XCJldmVudFwifV07XG4gICAgICB2YXIgY29udHJhY3RCbHVlcHJpbnQgPSBldGhlcmV1bS53ZWIzLmV0aC5jb250cmFjdChhYmkpO1xuICAgICAgY29udHJhY3QgPSBjb250cmFjdEJsdWVwcmludC5hdChjb250cmFjdEFkZHJlc3MpO1xuXG4gICAgICB2bS5nb2FsID0gZXRoZXJldW0ud2ViMy5mcm9tV2VpKGNvbnRyYWN0LmdvYWwoKSwgJ2V0aGVyJykudG9TdHJpbmcoKTtcbiAgICAgIHZtLnNsaWRlclN0ZXAgPSBldGhlcmV1bS53ZWIzLmZyb21XZWkoY29udHJhY3QuaW5jcmVtZW50KCksICdldGhlcicpLnRvU3RyaW5nKCk7XG4gICAgICB2bS5vblNsaWRlckNoYW5nZWQgPSBvblNsaWRlckNoYW5nZWQ7XG4gICAgICBlbXB0eURhdGFTbG90LnZhbHVlID0gdm0uZ29hbDtcblxuICAgICAgdm0uYWNjb3VudHMgPSBldGhlcmV1bS53ZWIzLmV0aC5hY2NvdW50cztcbiAgICAgIHZtLnNlbGVjdGVkQWNjb3VudCA9IGV0aGVyZXVtLndlYjMuZXRoLmRlZmF1bHRBY2NvdW50O1xuICAgICAgaWYoIXZtLnNlbGVjdGVkQWNjb3VudCkge1xuICAgICAgICB2bS5zZWxlY3RlZEFjY291bnQgPSBldGhlcmV1bS53ZWIzLmV0aC5jb2luYmFzZTtcbiAgICAgIH1cblxuICAgICAgaW5pdGlhbGl6ZVN0YWtlaG9sZGVyc0RhdGEoKTtcbiAgICAgIHVwZGF0ZVN0YWtlcygpO1xuICAgICAgdXBkYXRlQmFsYW5jZSgpO1xuICAgICAgdm0ubmV3QmFsYW5jZSA9IHZtLmJhbGFuY2UgLSB2bS5kZXNpcmVkU3Rha2VzO1xuICAgICAgdXBkYXRlUmVjZW50UmVzdWx0cygpO1xuXG4gICAgICB2YXIgb25TdGFrZUNoYW5nZWRFdmVudCA9IGNvbnRyYWN0LkNoYW5nZWRTdGFrZSgpO1xuICAgICAgb25TdGFrZUNoYW5nZWRFdmVudC53YXRjaChvblN0YWtlQ2hhbmdlZCk7XG5cbiAgICAgIHZhciBvbldvbkV2ZW50ID0gY29udHJhY3QuV29uKCk7XG4gICAgICBvbldvbkV2ZW50LndhdGNoKG9uV29uKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVDaGFydCgpIHtcbiAgICAgIHZhciBzdGFydGluZ0RhdGEgPSBbZW1wdHlEYXRhU2xvdF07XG5cbiAgICAgIHZhciBjaGFydE9wdGlvbnMgPSB7XG4gICAgICAgIGFuaW1hdGlvbkVhc2luZzogJ2Vhc2VJbk91dCcsXG4gICAgICAgIHNlZ21lbnRTdHJva2VXaWR0aDogMyxcbiAgICAgICAgYW5pbWF0aW9uU3RlcHM6IDIwLFxuICAgICAgICBzZWdtZW50U3Ryb2tlQ29sb3I6ICcjRUJGMEYxJyxcbiAgICAgICAgcGVyY2VudGFnZUlubmVyQ3V0b3V0OiA3NSxcbiAgICAgICAgcmVzcG9uc2l2ZTogdHJ1ZSxcbiAgICAgICAgdG9vbHRpcFRlbXBsYXRlOiBmdW5jdGlvbih2YWx1ZU9iamVjdCkge1xuICAgICAgICAgIHZhciBuYW1lID0gKHZhbHVlT2JqZWN0LmxhYmVsID09PSB2bS5zZWxlY3RlZEFjY291bnQpID8gJ1lvdScgOiB2YWx1ZU9iamVjdC5sYWJlbDtcbiAgICAgICAgICB2YXIgdG9vbHRpcCA9IG5hbWUgKyAnOiAnICsgdmFsdWVPYmplY3QudmFsdWUgKyAnIM6eJztcbiAgICAgICAgICBpZighIXZtLmdvYWwpIHtcbiAgICAgICAgICAgIHZhciBwZXJjZW50YWdlID0gKHZhbHVlT2JqZWN0LnZhbHVlIC8gdm0uZ29hbCAqIDEwMCk7XG4gICAgICAgICAgICB0b29sdGlwICs9ICcgKCcgKyBNYXRoLnJvdW5kKHBlcmNlbnRhZ2UgKiAxMDApIC8gMTAwICsgJyUpJ1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gdG9vbHRpcDtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgdmFyIGN0eCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwid2hlZWxcIikuZ2V0Q29udGV4dChcIjJkXCIpO1xuICAgICAgY2hhcnQgPSBuZXcgQ2hhcnQoY3R4KS5Eb3VnaG51dChzdGFydGluZ0RhdGEsIGNoYXJ0T3B0aW9ucyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdXBkYXRlQmFsYW5jZSgpIHtcbiAgICAgIGlmKCFldGhlcmV1bS5pc0Nvbm5lY3RlZCgpKSB7IHJldHVybjsgfVxuXG4gICAgICB2YXIgd2VpID0gZXRoZXJldW0ud2ViMy5ldGguZ2V0QmFsYW5jZShjb250cmFjdEFkZHJlc3MpO1xuICAgICAgdmFyIGV0aGVyID0gZXRoZXJldW0ud2ViMy5mcm9tV2VpKHdlaSwgJ2V0aGVyJyk7XG4gICAgICB2YXIgZGVsdGFTdGFrZXMgPSAodm0uZGVzaXJlZFN0YWtlcyAtIHZtLmN1cnJlbnRTdGFrZXMpO1xuICAgICAgdm0uYmFsYW5jZSA9IHBhcnNlRmxvYXQoZXRoZXIudG9TdHJpbmcoKSk7XG4gICAgICB2bS5uZXdCYWxhbmNlID0gdm0uYmFsYW5jZSArIGRlbHRhU3Rha2VzO1xuICAgICAgY2hhcnQuc2VnbWVudHNbY2hhcnQuc2VnbWVudHMubGVuZ3RoIC0gMV0udmFsdWUgPSAodm0uZ29hbCAtIHZtLm5ld0JhbGFuY2UpO1xuICAgICAgY2hhcnQudXBkYXRlKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdXBkYXRlU3Rha2VzKCkge1xuICAgICAgaWYoIWV0aGVyZXVtLmlzQ29ubmVjdGVkKCkpIHsgcmV0dXJuOyB9XG4gICAgICB2bS5jdXJyZW50U3Rha2VzID0gcGFyc2VGbG9hdChldGhlcmV1bS53ZWIzLmZyb21XZWkoY29udHJhY3Quc3Rha2VzKHZtLnNlbGVjdGVkQWNjb3VudCksICdldGhlcicpLnRvU3RyaW5nKCkpO1xuICAgICAgdm0uZGVzaXJlZFN0YWtlcyA9IHZtLmN1cnJlbnRTdGFrZXM7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW5pdGlhbGl6ZVN0YWtlaG9sZGVyc0RhdGEoKSB7XG4gICAgICBpZighZXRoZXJldW0uaXNDb25uZWN0ZWQoKSkgeyByZXR1cm47IH1cblxuICAgICAgY2hhcnQucmVtb3ZlRGF0YSgpO1xuICAgICAgc3Rha2Vob2xkZXJzRGF0YSA9IHt9O1xuICAgICAgdmFyIG51bVN0YWtlaG9sZGVycyA9IGNvbnRyYWN0Lm51bVN0YWtlaG9sZGVycygpO1xuICAgICAgZm9yKHZhciBpID0gMDsgaSA8IG51bVN0YWtlaG9sZGVyczsgKytpKSB7XG4gICAgICAgIHZhciBzdGFrZWhvbGRlckFkZHJlc3MgPSBjb250cmFjdC5zdGFrZWhvbGRlcnMoaSkudG9TdHJpbmcoKTtcbiAgICAgICAgc3Rha2Vob2xkZXJzRGF0YVtzdGFrZWhvbGRlckFkZHJlc3NdID0ge1xuICAgICAgICAgIGxhYmVsOiBzdGFrZWhvbGRlckFkZHJlc3MsXG4gICAgICAgICAgdmFsdWU6IGV0aGVyZXVtLndlYjMuZnJvbVdlaShjb250cmFjdC5zdGFrZXMoc3Rha2Vob2xkZXJBZGRyZXNzKSwgJ2V0aGVyJyksXG4gICAgICAgICAgY29sb3I6IChzdGFrZWhvbGRlckFkZHJlc3MgPT09IHZtLnNlbGVjdGVkQWNjb3VudCkgPyAnIzVjYjg1YycgOiAnIzNEM0UzRicsXG4gICAgICAgICAgaW5kZXg6IGlcbiAgICAgICAgfTtcblxuICAgICAgICBjaGFydC5hZGREYXRhKHN0YWtlaG9sZGVyc0RhdGFbc3Rha2Vob2xkZXJBZGRyZXNzXSk7XG4gICAgICB9XG5cbiAgICAgIGNoYXJ0LmFkZERhdGEoZW1wdHlEYXRhU2xvdCk7XG4gICAgICBjaGFydC51cGRhdGUoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB1cGRhdGVSZWNlbnRSZXN1bHRzKCkge1xuICAgICAgaWYoIWV0aGVyZXVtLmlzQ29ubmVjdGVkKCkpIHsgcmV0dXJuOyB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25TdGFrZUNoYW5nZWQoZXJyb3IsIHJlc3VsdCkge1xuICAgICAgLy8gVE9ETzogQ2hlY2sgaWYgZGVzaXJlZCBjb250cmlidXRpb24gbmVlZHMgdG8gYmUgcmVkdWNlZFxuXG4gICAgICBpZighZXJyb3IpIHtcbiAgICAgICAgdmFyIHN0YWtlaG9sZGVyQWRkcmVzcyA9IHJlc3VsdC5hcmdzLnN0YWtlaG9sZGVyLnRvU3RyaW5nKCk7XG4gICAgICAgIHZhciB2YWx1ZSA9IGV0aGVyZXVtLndlYjMuZnJvbVdlaShjb250cmFjdC5zdGFrZXMoc3Rha2Vob2xkZXJBZGRyZXNzKSwgJ2V0aGVyJyk7XG4gICAgICAgIGlmKHN0YWtlaG9sZGVyQWRkcmVzcyBpbiBzdGFrZWhvbGRlcnNEYXRhKSB7XG4gICAgICAgICAgY2hhcnQuc2VnbWVudHNbc3Rha2Vob2xkZXJzRGF0YVtzdGFrZWhvbGRlckFkZHJlc3NdLmluZGV4XS52YWx1ZSA9IHZhbHVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBpbmRleCA9IE9iamVjdC5rZXlzKHN0YWtlaG9sZGVyc0RhdGEpLmxlbmd0aDtcbiAgICAgICAgICBzdGFrZWhvbGRlcnNEYXRhW3N0YWtlaG9sZGVyQWRkcmVzc10gPSB7XG4gICAgICAgICAgICBsYWJlbDogc3Rha2Vob2xkZXJBZGRyZXNzLFxuICAgICAgICAgICAgdmFsdWU6IHZhbHVlLFxuICAgICAgICAgICAgY29sb3I6IChzdGFrZWhvbGRlckFkZHJlc3MgPT09IHZtLnNlbGVjdGVkQWNjb3VudCkgPyAnIzVjYjg1YycgOiAnIzNEM0UzRicsXG4gICAgICAgICAgICBpbmRleDogaW5kZXhcbiAgICAgICAgICB9O1xuICAgICAgICAgIGNoYXJ0LmFkZERhdGEoc3Rha2Vob2xkZXJzRGF0YVtzdGFrZWhvbGRlckFkZHJlc3NdLCBpbmRleCk7XG4gICAgICAgICAgY29uc29sZS5sb2coaW5kZXgpO1xuICAgICAgICB9XG5cbiAgICAgICAgY2hhcnQudXBkYXRlKCk7XG4gICAgICB9XG5cbiAgICAgIHVwZGF0ZUJhbGFuY2UoKTtcbiAgICAgIHVwZGF0ZVN0YWtlcygpO1xuICAgICAgJHNjb3BlLiRhcHBseSgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9uV29uKGVycm9yLCByZXN1bHQpIHtcbiAgICAgIHVwZGF0ZUJhbGFuY2UoKTtcbiAgICAgIHVwZGF0ZVN0YWtlcygpO1xuICAgICAgdXBkYXRlUmVjZW50UmVzdWx0cygpO1xuICAgICAgJHNjb3BlLiRhcHBseSgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9uU2xpZGVyQ2hhbmdlZChzbGlkZXJJZCwgbW9kZWxWYWx1ZSkge1xuICAgICAgY2hhcnQuc2VnbWVudHNbc3Rha2Vob2xkZXJzRGF0YVt2bS5zZWxlY3RlZEFjY291bnQudG9TdHJpbmcoKV0uaW5kZXhdLnZhbHVlID0gbW9kZWxWYWx1ZTtcbiAgICAgIHVwZGF0ZUJhbGFuY2UoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZWxvYWRQYWdlKCkge1xuICAgICAgJHJvdXRlLnJlbG9hZCgpO1xuICAgIH1cbiAgfVxufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdldGhlci1zcGlubmVyJykuc2VydmljZSgnZXRoZXJldW0nLCBldGhlcmV1bSk7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBldGhlcmV1bSgpIHtcbiAgICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgICB3ZWIzOiBuZXcgV2ViMygpLFxuICAgICAgICBpc0Nvbm5lY3RlZDogaXNDb25uZWN0ZWRcbiAgICAgIH07XG5cbiAgICAgIGFjdGl2YXRlKCk7XG5cbiAgICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgICBzZXJ2aWNlLndlYjMuc2V0UHJvdmlkZXIobmV3IHNlcnZpY2Uud2ViMy5wcm92aWRlcnMuSHR0cFByb3ZpZGVyKFwiaHR0cDovL2xvY2FsaG9zdDo4NTQ1XCIpKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gaXNDb25uZWN0ZWQoKSB7XG4gICAgICAgIHJldHVybiBzZXJ2aWNlLndlYjMuY3VycmVudFByb3ZpZGVyLmlzQ29ubmVjdGVkKCk7XG4gICAgICB9XG4gICAgfVxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnZXRoZXItc3Bpbm5lcicpLnNlcnZpY2UoJ2V0aGVyZXVtJywgZXRoZXJldW0pO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gZXRoZXJldW0oKSB7XG4gICAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgICAgd2ViMzogbmV3IFdlYjMoKSxcbiAgICAgICAgaXNDb25uZWN0ZWQ6IGlzQ29ubmVjdGVkXG4gICAgICB9O1xuXG4gICAgICBhY3RpdmF0ZSgpO1xuXG4gICAgICByZXR1cm4gc2VydmljZTtcblxuICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgICAgc2VydmljZS53ZWIzLnNldFByb3ZpZGVyKG5ldyBzZXJ2aWNlLndlYjMucHJvdmlkZXJzLkh0dHBQcm92aWRlcihcImh0dHA6Ly9sb2NhbGhvc3Q6ODU0NVwiKSk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGlzQ29ubmVjdGVkKCkge1xuICAgICAgICByZXR1cm4gc2VydmljZS53ZWIzLmN1cnJlbnRQcm92aWRlci5pc0Nvbm5lY3RlZCgpO1xuICAgICAgfVxuICAgIH1cbn0pKCk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
