!function(){"use strict";angular.module("ether-spinner",["ngRoute","rzModule","oitozero.ngSweetAlert"]).config(["$routeProvider",function(t){t.otherwise({redirectTo:"/"})}])}(),function(){"use strict";function t(t,e,n,o){function i(){if(u(),o.isConnected()){var t=[{constant:!0,inputs:[{name:"",type:"uint256"}],name:"contributors",outputs:[{name:"",type:"address"}],type:"function"},{constant:!0,inputs:[],name:"goal",outputs:[{name:"",type:"uint256"}],type:"function"},{constant:!0,inputs:[{name:"",type:"address"}],name:"contributions",outputs:[{name:"",type:"uint256"}],type:"function"},{constant:!1,inputs:[{name:"newHost",type:"address"}],name:"changeHost",outputs:[],type:"function"},{constant:!1,inputs:[],name:"destroy",outputs:[],type:"function"},{constant:!1,inputs:[{name:"amount",type:"uint256"}],name:"setContribution",outputs:[],type:"function"},{constant:!0,inputs:[],name:"numWinners",outputs:[{name:"",type:"uint256"}],type:"function"},{constant:!0,inputs:[],name:"numContributors",outputs:[{name:"",type:"uint256"}],type:"function"},{constant:!1,inputs:[],name:"addToContribution",outputs:[],type:"function"},{constant:!0,inputs:[],name:"increment",outputs:[{name:"",type:"uint256"}],type:"function"},{constant:!1,inputs:[{name:"amount",type:"uint256"}],name:"removeFromContribution",outputs:[],type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"recentWins",outputs:[{name:"winner",type:"address"},{name:"timestamp",type:"uint256"},{name:"contribution",type:"uint256"}],type:"function"},{constant:!0,inputs:[],name:"host",outputs:[{name:"",type:"address"}],type:"function"},{inputs:[{name:"_goalInFinney",type:"uint256"},{name:"_incrementInFinney",type:"uint256"},{name:"_recentWinsCount",type:"uint8"}],type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,name:"winner",type:"address"},{indexed:!1,name:"timestamp",type:"uint256"},{indexed:!1,name:"contribution",type:"uint256"}],name:"Won",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"contributor",type:"address"}],name:"ChangedContribution",type:"event"}],e=o.web3.eth.contract(t);S=e.at(w),y.goal=o.web3.fromWei(S.goal(),"ether").toString(),y.sliderStep=o.web3.fromWei(S.increment(),"ether").toString(),y.onSliderChanged=f,A.value=y.goal,y.accounts=o.web3.eth.accounts,y.selectedAccount=o.web3.eth.defaultAccount,y.selectedAccount||(y.selectedAccount=o.web3.eth.coinbase),d(),s(),y.desiredContribution=y.currentContribution,a(),c(),l();var n=S.ChangedContribution();n.watch(m);var i=S.Won();i.watch(b)}}function r(){function t(t,e){if(t){var o=t;o.toString().indexOf("unlock signer account")>=0&&(o+='<br><br>Make sure you\'re accessing this page through the <a href="https://github.com/ethereum/mist/releases/tag/0.3.6">early developer release</a> of Mist, the official Ethereum browser.'),n.swal({title:"Error Setting Contribution",text:o,type:"error",html:!0})}else n.swal({title:"Success!",text:"Your request has been successfully sent to the Ethereum network for processing. You'll see your account balance updated soon.<br><br><strong>This may take a minute or two</strong>.",type:"success",html:!0}),y.desiredContribution=y.currentContribution,h.segments[C[y.selectedAccount].index].value=y.currentContribution,c()}var e=y.desiredContribution-y.currentContribution,i=o.web3.toWei(e,"ether");console.log(i),e>0?S.addToContribution(null,{value:i,from:y.selectedAccount,to:w},t):0>e&&S.removeFromContribution(-i,{from:y.selectedAccount,to:w},t)}function u(){var t=[A],e={animationEasing:"easeInOut",segmentStrokeWidth:3,animationSteps:20,segmentStrokeColor:"#EBF0F1",percentageInnerCutout:75,responsive:!0,tooltipTemplate:function(t){var e=t.label===y.selectedAccount?"You":t.label,n=e+": "+t.value.toFixed(2)+" Îž";if(y.goal){var o=t.value/y.goal*100;n+=" ("+Math.round(100*o)/100+"%)"}return n}},n=document.getElementById("wheel").getContext("2d");h=new Chart(n).Doughnut(t,e)}function a(){if(o.isConnected()){var t=o.web3.eth.getBalance(w),e=o.web3.fromWei(t,"ether");y.balance=parseFloat(e.toString())}}function c(){var t=y.desiredContribution-y.currentContribution;y.newBalance=y.balance+t,h.segments[h.segments.length-1].value=y.goal-y.newBalance,h.update()}function s(){o.isConnected()&&(a(),y.currentContribution=parseFloat(o.web3.fromWei(S.contributions(y.selectedAccount),"ether").toString()),y.desiredContribution=Math.min(y.desiredContribution,y.goal-y.balance+y.currentContribution),c())}function d(){if(o.isConnected()){h.removeData(),C={};for(var t=S.numContributors(),e=0;t>e;++e){var n=S.contributors(e).toString();C[n]={label:n,value:o.web3.fromWei(S.contributions(n),"ether"),color:n===y.selectedAccount?"#5cb85c":"#3D3E3F",index:e},h.addData(C[n])}var i=y.selectedAccount.toString();if(!(i in C)){var r=Object.keys(C).length;C[i]={label:i,value:0,color:"#5cb85c",index:r},h.addData(C[i],r)}h.addData(A),h.update()}}function l(){!o.isConnected()}function p(){h.destroy(),u(),d(),s(),y.desiredContribution=y.currentContribution,a(),c(),l()}function m(t,n){if(t)console.log(t);else{var i=n.args.contributor.toString(),r=o.web3.fromWei(S.contributions(i),"ether");if(n.args.contributor==y.selectedAccount&&(s(),y.desiredContribution=y.currentContribution),i in C)h.segments[C[i].index].value=r;else{var u=Object.keys(C).length;C[i]={label:i,value:r,color:i===y.selectedAccount?"#5cb85c":"#3D3E3F",index:u},h.addData(C[i],u)}h.update()}a(),s(),c(),e.$apply()}function b(t,n){a(),s(),l(),e.$apply()}function f(t,e){var n=y.selectedAccount.toString();h.segments[C[n].index].value=e,c()}function g(t){return o.isConnected()?o.web3.fromWei(o.web3.eth.getBalance(t),"ether"):void 0}var y=this;y.isConnected=o.isConnected,y.setContribution=r,y.onAccountChanged=p,y.getBalance=g;var h,C,v="#dce6e9",w="0x79edE3A98b042863384dE25788504532362d52D6",S=null,A={value:5,color:v,label:"Empty"};i()}t.$inject=["$route","$scope","SweetAlert","ethereum"],angular.module("ether-spinner").controller("SpinnerCtrl",t)}(),function(){"use strict";function t(){function t(){n.web3.setProvider(new n.web3.providers.HttpProvider("http://localhost:8545"))}function e(){return n.web3.currentProvider.isConnected()}var n={web3:new Web3,isConnected:e};return t(),n}angular.module("ether-spinner").service("ethereum",t)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsInNwaW5uZXIuY29udHJvbGxlci5qcyIsImFwcC5taW4uanMiLCJldGhlcmV1bS5zZXJ2aWNlLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkcm91dGVQcm92aWRlciIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCJTcGlubmVyQ3RybCIsIiRyb3V0ZSIsIiRzY29wZSIsIlN3ZWV0QWxlcnQiLCJldGhlcmV1bSIsImFjdGl2YXRlIiwiY3JlYXRlQ2hhcnQiLCJpc0Nvbm5lY3RlZCIsImFiaSIsImNvbnN0YW50IiwiaW5wdXRzIiwibmFtZSIsInR5cGUiLCJvdXRwdXRzIiwiYW5vbnltb3VzIiwiaW5kZXhlZCIsImNvbnRyYWN0Qmx1ZXByaW50Iiwid2ViMyIsImV0aCIsImNvbnRyYWN0IiwiYXQiLCJjb250cmFjdEFkZHJlc3MiLCJ2bSIsImdvYWwiLCJmcm9tV2VpIiwidG9TdHJpbmciLCJzbGlkZXJTdGVwIiwiaW5jcmVtZW50Iiwib25TbGlkZXJDaGFuZ2VkIiwiZW1wdHlEYXRhU2xvdCIsInZhbHVlIiwiYWNjb3VudHMiLCJzZWxlY3RlZEFjY291bnQiLCJkZWZhdWx0QWNjb3VudCIsImNvaW5iYXNlIiwiaW5pdGlhbGl6ZUNvbnRyaWJ1dG9yc0RhdGEiLCJ1cGRhdGVDb250cmlidXRpb25zIiwiZGVzaXJlZENvbnRyaWJ1dGlvbiIsImN1cnJlbnRDb250cmlidXRpb24iLCJ1cGRhdGVCYWxhbmNlIiwidXBkYXRlTmV3QmFsYW5jZSIsInVwZGF0ZVJlY2VudFJlc3VsdHMiLCJvbkNvbnRyaWJ1dGlvbkNoYW5nZWRFdmVudCIsIkNoYW5nZWRDb250cmlidXRpb24iLCJ3YXRjaCIsIm9uQ29udHJpYnV0aW9uQ2hhbmdlZCIsIm9uV29uRXZlbnQiLCJXb24iLCJvbldvbiIsInNldENvbnRyaWJ1dGlvbiIsIm9uQ29udHJpYnV0aW9uU2V0IiwiZXJyb3IiLCJyZXN1bHQiLCJlcnJvck1lc3NhZ2UiLCJpbmRleE9mIiwic3dhbCIsInRpdGxlIiwidGV4dCIsImh0bWwiLCJjaGFydCIsInNlZ21lbnRzIiwiY29udHJpYnV0b3JzRGF0YSIsImluZGV4IiwiZGVsdGFDb250cmlidXRpb24iLCJjaGFuZ2VJbldlaSIsInRvV2VpIiwiY29uc29sZSIsImxvZyIsImFkZFRvQ29udHJpYnV0aW9uIiwiZnJvbSIsInRvIiwicmVtb3ZlRnJvbUNvbnRyaWJ1dGlvbiIsInN0YXJ0aW5nRGF0YSIsImNoYXJ0T3B0aW9ucyIsImFuaW1hdGlvbkVhc2luZyIsInNlZ21lbnRTdHJva2VXaWR0aCIsImFuaW1hdGlvblN0ZXBzIiwic2VnbWVudFN0cm9rZUNvbG9yIiwicGVyY2VudGFnZUlubmVyQ3V0b3V0IiwicmVzcG9uc2l2ZSIsInRvb2x0aXBUZW1wbGF0ZSIsInZhbHVlT2JqZWN0IiwibGFiZWwiLCJ0b29sdGlwIiwidG9GaXhlZCIsInBlcmNlbnRhZ2UiLCJNYXRoIiwicm91bmQiLCJjdHgiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiZ2V0Q29udGV4dCIsIkNoYXJ0IiwiRG91Z2hudXQiLCJ3ZWkiLCJnZXRCYWxhbmNlIiwiZXRoZXIiLCJiYWxhbmNlIiwicGFyc2VGbG9hdCIsIm5ld0JhbGFuY2UiLCJsZW5ndGgiLCJ1cGRhdGUiLCJjb250cmlidXRpb25zIiwibWluIiwicmVtb3ZlRGF0YSIsIm51bUNvbnRyaWJ1dG9ycyIsImkiLCJjb250cmlidXRvckFkZHJlc3MiLCJjb250cmlidXRvcnMiLCJjb2xvciIsImFkZERhdGEiLCJjdXJyZW50QWNjb3VudCIsIk9iamVjdCIsImtleXMiLCJvbkFjY291bnRDaGFuZ2VkIiwiZGVzdHJveSIsImFyZ3MiLCJjb250cmlidXRvciIsIiRhcHBseSIsInNsaWRlcklkIiwibW9kZWxWYWx1ZSIsImFjY291bnQiLCJ0aGlzIiwiZW1wdHlCYXJDb2xvdXIiLCIkaW5qZWN0IiwiY29udHJvbGxlciIsInNlcnZpY2UiLCJzZXRQcm92aWRlciIsInByb3ZpZGVycyIsIkh0dHBQ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LEVBQVE3RyxLQUFLOEcsWUFBWSxHQUFJRCxHQUFRN0csS0FBSytHLFVBQVVDLGFBQWEsMEJBR25FLFFBQVMxSCxLQUNQLE1BQU91SCxHQUFRN0csS0FBS2lILGdCQUFnQjNILGNBaEJ0QyxHQUFJdUgsSUFDRjdHLEtBQU0sR0FBSWtILE1BQ1Y1SCxZQUFhQSxFQUtmLE9BRkFGLEtBRU95SCxFQVhUcEksUUFBUUMsT0FBTyxpQkFBaUJtSSxRQUFRLFdBQVkxSCIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ2V0aGVyLXNwaW5uZXInLCBbXG4gICAgJ25nUm91dGUnLFxuICAgICdyek1vZHVsZScsXG4gICAgJ29pdG96ZXJvLm5nU3dlZXRBbGVydCdcbiAgXSkuXG4gIGNvbmZpZyhbJyRyb3V0ZVByb3ZpZGVyJywgZnVuY3Rpb24oJHJvdXRlUHJvdmlkZXIpIHtcbiAgICAkcm91dGVQcm92aWRlci5vdGhlcndpc2Uoe3JlZGlyZWN0VG86ICcvJ30pO1xuICB9XSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ2V0aGVyLXNwaW5uZXInKS5jb250cm9sbGVyKCdTcGlubmVyQ3RybCcsIFNwaW5uZXJDdHJsKTtcblxuICAvKkBuZ0luamVjdCovXG4gIGZ1bmN0aW9uIFNwaW5uZXJDdHJsKCRyb3V0ZSwgJHNjb3BlLCBTd2VldEFsZXJ0LCBldGhlcmV1bSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uaXNDb25uZWN0ZWQgPSBldGhlcmV1bS5pc0Nvbm5lY3RlZDtcbiAgICB2bS5zZXRDb250cmlidXRpb24gPSBzZXRDb250cmlidXRpb247XG4gICAgdm0ub25BY2NvdW50Q2hhbmdlZCA9IG9uQWNjb3VudENoYW5nZWQ7XG4gICAgdm0uZ2V0QmFsYW5jZSA9IGdldEJhbGFuY2U7XG5cbiAgICB2YXIgZW1wdHlCYXJDb2xvdXIgPSAnI2RjZTZlOSc7XG4gICAgdmFyIGNvbnRyYWN0QWRkcmVzcyA9ICcweDc5ZWRFM0E5OGIwNDI4NjMzODRkRTI1Nzg4NTA0NTMyMzYyZDUyRDYnO1xuICAgIHZhciBjb250cmFjdCA9IG51bGw7XG5cbiAgICB2YXIgY2hhcnQ7XG4gICAgdmFyIGNvbnRyaWJ1dG9yc0RhdGE7XG4gICAgdmFyIGVtcHR5RGF0YVNsb3QgPSB7XG4gICAgICB2YWx1ZTogNS4wLFxuICAgICAgY29sb3I6IGVtcHR5QmFyQ29sb3VyLFxuICAgICAgbGFiZWw6IFwiRW1wdHlcIlxuICAgIH07XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICBjcmVhdGVDaGFydCgpO1xuICAgICAgaWYoIWV0aGVyZXVtLmlzQ29ubmVjdGVkKCkpIHsgcmV0dXJuOyB9XG5cbiAgICAgIHZhciBhYmkgPSBbe1wiY29uc3RhbnRcIjp0cnVlLFwiaW5wdXRzXCI6W3tcIm5hbWVcIjpcIlwiLFwidHlwZVwiOlwidWludDI1NlwifV0sXCJuYW1lXCI6XCJjb250cmlidXRvcnNcIixcIm91dHB1dHNcIjpbe1wibmFtZVwiOlwiXCIsXCJ0eXBlXCI6XCJhZGRyZXNzXCJ9XSxcInR5cGVcIjpcImZ1bmN0aW9uXCJ9LHtcImNvbnN0YW50XCI6dHJ1ZSxcImlucHV0c1wiOltdLFwibmFtZVwiOlwiZ29hbFwiLFwib3V0cHV0c1wiOlt7XCJuYW1lXCI6XCJcIixcInR5cGVcIjpcInVpbnQyNTZcIn1dLFwidHlwZVwiOlwiZnVuY3Rpb25cIn0se1wiY29uc3RhbnRcIjp0cnVlLFwiaW5wdXRzXCI6W3tcIm5hbWVcIjpcIlwiLFwidHlwZVwiOlwiYWRkcmVzc1wifV0sXCJuYW1lXCI6XCJjb250cmlidXRpb25zXCIsXCJvdXRwdXRzXCI6W3tcIm5hbWVcIjpcIlwiLFwidHlwZVwiOlwidWludDI1NlwifV0sXCJ0eXBlXCI6XCJmdW5jdGlvblwifSx7XCJjb25zdGFudFwiOmZhbHNlLFwiaW5wdXRzXCI6W3tcIm5hbWVcIjpcIm5ld0hvc3RcIixcInR5cGVcIjpcImFkZHJlc3NcIn1dLFwibmFtZVwiOlwiY2hhbmdlSG9zdFwiLFwib3V0cHV0c1wiOltdLFwidHlwZVwiOlwiZnVuY3Rpb25cIn0se1wiY29uc3RhbnRcIjpmYWxzZSxcImlucHV0c1wiOltdLFwibmFtZVwiOlwiZGVzdHJveVwiLFwib3V0cHV0c1wiOltdLFwidHlwZVwiOlwiZnVuY3Rpb25cIn0se1wiY29uc3RhbnRcIjpmYWxzZSxcImlucHV0c1wiOlt7XCJuYW1lXCI6XCJhbW91bnRcIixcInR5cGVcIjpcInVpbnQyNTZcIn1dLFwibmFtZVwiOlwic2V0Q29udHJpYnV0aW9uXCIsXCJvdXRwdXRzXCI6W10sXCJ0eXBlXCI6XCJmdW5jdGlvblwifSx7XCJjb25zdGFudFwiOnRydWUsXCJpbnB1dHNcIjpbXSxcIm5hbWVcIjpcIm51bVdpbm5lcnNcIixcIm91dHB1dHNcIjpbe1wibmFtZVwiOlwiXCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9XSxcInR5cGVcIjpcImZ1bmN0aW9uXCJ9LHtcImNvbnN0YW50XCI6dHJ1ZSxcImlucHV0c1wiOltdLFwibmFtZVwiOlwibnVtQ29udHJpYnV0b3JzXCIsXCJvdXRwdXRzXCI6W3tcIm5hbWVcIjpcIlwiLFwidHlwZVwiOlwidWludDI1NlwifV0sXCJ0eXBlXCI6XCJmdW5jdGlvblwifSx7XCJjb25zdGFudFwiOmZhbHNlLFwiaW5wdXRzXCI6W10sXCJuYW1lXCI6XCJhZGRUb0NvbnRyaWJ1dGlvblwiLFwib3V0cHV0c1wiOltdLFwidHlwZVwiOlwiZnVuY3Rpb25cIn0se1wiY29uc3RhbnRcIjp0cnVlLFwiaW5wdXRzXCI6W10sXCJuYW1lXCI6XCJpbmNyZW1lbnRcIixcIm91dHB1dHNcIjpbe1wibmFtZVwiOlwiXCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9XSxcInR5cGVcIjpcImZ1bmN0aW9uXCJ9LHtcImNvbnN0YW50XCI6ZmFsc2UsXCJpbnB1dHNcIjpbe1wibmFtZVwiOlwiYW1vdW50XCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9XSxcIm5hbWVcIjpcInJlbW92ZUZyb21Db250cmlidXRpb25cIixcIm91dHB1dHNcIjpbXSxcInR5cGVcIjpcImZ1bmN0aW9uXCJ9LHtcImNvbnN0YW50XCI6dHJ1ZSxcImlucHV0c1wiOlt7XCJuYW1lXCI6XCJcIixcInR5cGVcIjpcInVpbnQyNTZcIn1dLFwibmFtZVwiOlwicmVjZW50V2luc1wiLFwib3V0cHV0c1wiOlt7XCJuYW1lXCI6XCJ3aW5uZXJcIixcInR5cGVcIjpcImFkZHJlc3NcIn0se1wibmFtZVwiOlwidGltZXN0YW1wXCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9LHtcIm5hbWVcIjpcImNvbnRyaWJ1dGlvblwiLFwidHlwZVwiOlwidWludDI1NlwifV0sXCJ0eXBlXCI6XCJmdW5jdGlvblwifSx7XCJjb25zdGFudFwiOnRydWUsXCJpbnB1dHNcIjpbXSxcIm5hbWVcIjpcImhvc3RcIixcIm91dHB1dHNcIjpbe1wibmFtZVwiOlwiXCIsXCJ0eXBlXCI6XCJhZGRyZXNzXCJ9XSxcInR5cGVcIjpcImZ1bmN0aW9uXCJ9LHtcImlucHV0c1wiOlt7XCJuYW1lXCI6XCJfZ29hbEluRmlubmV5XCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9LHtcIm5hbWVcIjpcIl9pbmNyZW1lbnRJbkZpbm5leVwiLFwidHlwZVwiOlwidWludDI1NlwifSx7XCJuYW1lXCI6XCJfcmVjZW50V2luc0NvdW50XCIsXCJ0eXBlXCI6XCJ1aW50OFwifV0sXCJ0eXBlXCI6XCJjb25zdHJ1Y3RvclwifSx7XCJhbm9ueW1vdXNcIjpmYWxzZSxcImlucHV0c1wiOlt7XCJpbmRleGVkXCI6ZmFsc2UsXCJuYW1lXCI6XCJ3aW5uZXJcIixcInR5cGVcIjpcImFkZHJlc3NcIn0se1wiaW5kZXhlZFwiOmZhbHNlLFwibmFtZVwiOlwidGltZXN0YW1wXCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9LHtcImluZGV4ZWRcIjpmYWxzZSxcIm5hbWVcIjpcImNvbnRyaWJ1dGlvblwiLFwidHlwZVwiOlwidWludDI1NlwifV0sXCJuYW1lXCI6XCJXb25cIixcInR5cGVcIjpcImV2ZW50XCJ9LHtcImFub255bW91c1wiOmZhbHNlLFwiaW5wdXRzXCI6W3tcImluZGV4ZWRcIjpmYWxzZSxcIm5hbWVcIjpcImNvbnRyaWJ1dG9yXCIsXCJ0eXBlXCI6XCJhZGRyZXNzXCJ9XSxcIm5hbWVcIjpcIkNoYW5nZWRDb250cmlidXRpb25cIixcInR5cGVcIjpcImV2ZW50XCJ9XTtcbiAgICAgIHZhciBjb250cmFjdEJsdWVwcmludCA9IGV0aGVyZXVtLndlYjMuZXRoLmNvbnRyYWN0KGFiaSk7XG4gICAgICBjb250cmFjdCA9IGNvbnRyYWN0Qmx1ZXByaW50LmF0KGNvbnRyYWN0QWRkcmVzcyk7XG5cbiAgICAgIHZtLmdvYWwgPSBldGhlcmV1bS53ZWIzLmZyb21XZWkoY29udHJhY3QuZ29hbCgpLCAnZXRoZXInKS50b1N0cmluZygpO1xuICAgICAgdm0uc2xpZGVyU3RlcCA9IGV0aGVyZXVtLndlYjMuZnJvbVdlaShjb250cmFjdC5pbmNyZW1lbnQoKSwgJ2V0aGVyJykudG9TdHJpbmcoKTtcbiAgICAgIHZtLm9uU2xpZGVyQ2hhbmdlZCA9IG9uU2xpZGVyQ2hhbmdlZDtcbiAgICAgIGVtcHR5RGF0YVNsb3QudmFsdWUgPSB2bS5nb2FsO1xuXG4gICAgICB2bS5hY2NvdW50cyA9IGV0aGVyZXVtLndlYjMuZXRoLmFjY291bnRzO1xuICAgICAgdm0uc2VsZWN0ZWRBY2NvdW50ID0gZXRoZXJldW0ud2ViMy5ldGguZGVmYXVsdEFjY291bnQ7XG4gICAgICBpZighdm0uc2VsZWN0ZWRBY2NvdW50KSB7XG4gICAgICAgIHZtLnNlbGVjdGVkQWNjb3VudCA9IGV0aGVyZXVtLndlYjMuZXRoLmNvaW5iYXNlO1xuICAgICAgfVxuXG4gICAgICBpbml0aWFsaXplQ29udHJpYnV0b3JzRGF0YSgpO1xuICAgICAgdXBkYXRlQ29udHJpYnV0aW9ucygpO1xuICAgICAgdm0uZGVzaXJlZENvbnRyaWJ1dGlvbiA9IHZtLmN1cnJlbnRDb250cmlidXRpb247XG5cbiAgICAgIHVwZGF0ZUJhbGFuY2UoKTtcbiAgICAgIHVwZGF0ZU5ld0JhbGFuY2UoKTtcbiAgICAgIHVwZGF0ZVJlY2VudFJlc3VsdHMoKTtcblxuICAgICAgdmFyIG9uQ29udHJpYnV0aW9uQ2hhbmdlZEV2ZW50ID0gY29udHJhY3QuQ2hhbmdlZENvbnRyaWJ1dGlvbigpO1xuICAgICAgb25Db250cmlidXRpb25DaGFuZ2VkRXZlbnQud2F0Y2gob25Db250cmlidXRpb25DaGFuZ2VkKTtcblxuICAgICAgdmFyIG9uV29uRXZlbnQgPSBjb250cmFjdC5Xb24oKTtcbiAgICAgIG9uV29uRXZlbnQud2F0Y2gob25Xb24pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldENvbnRyaWJ1dGlvbigpIHtcbiAgICAgIHZhciBkZWx0YUNvbnRyaWJ1dGlvbiA9IHZtLmRlc2lyZWRDb250cmlidXRpb24gLSB2bS5jdXJyZW50Q29udHJpYnV0aW9uO1xuICAgICAgdmFyIGNoYW5nZUluV2VpID0gZXRoZXJldW0ud2ViMy50b1dlaShkZWx0YUNvbnRyaWJ1dGlvbiwgJ2V0aGVyJyk7XG4gICAgICBjb25zb2xlLmxvZyhjaGFuZ2VJbldlaSk7XG4gICAgICBpZihkZWx0YUNvbnRyaWJ1dGlvbiA+IDApIHtcbiAgICAgICAgY29udHJhY3QuYWRkVG9Db250cmlidXRpb24obnVsbCwgeyB2YWx1ZTogY2hhbmdlSW5XZWksIGZyb206IHZtLnNlbGVjdGVkQWNjb3VudCwgdG86IGNvbnRyYWN0QWRkcmVzcyB9LCBvbkNvbnRyaWJ1dGlvblNldCk7XG4gICAgICB9IGVsc2UgaWYoZGVsdGFDb250cmlidXRpb24gPCAwKXtcbiAgICAgICAgY29udHJhY3QucmVtb3ZlRnJvbUNvbnRyaWJ1dGlvbigtY2hhbmdlSW5XZWksIHsgZnJvbTogdm0uc2VsZWN0ZWRBY2NvdW50LCB0bzogY29udHJhY3RBZGRyZXNzIH0sIG9uQ29udHJpYnV0aW9uU2V0KTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gb25Db250cmlidXRpb25TZXQoZXJyb3IsIHJlc3VsdCkge1xuICAgICAgICBpZihlcnJvcikge1xuICAgICAgICAgIHZhciBlcnJvck1lc3NhZ2UgPSBlcnJvcjtcbiAgICAgICAgICBpZihlcnJvck1lc3NhZ2UudG9TdHJpbmcoKS5pbmRleE9mKCd1bmxvY2sgc2lnbmVyIGFjY291bnQnKSA+PSAwKSB7XG4gICAgICAgICAgICAgIGVycm9yTWVzc2FnZSArPSBcIjxicj48YnI+TWFrZSBzdXJlIHlvdSdyZSBhY2Nlc3NpbmcgdGhpcyBwYWdlIHRocm91Z2ggdGhlIDxhIGhyZWY9XFxcImh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9taXN0L3JlbGVhc2VzL3RhZy8wLjMuNlxcXCI+ZWFybHkgZGV2ZWxvcGVyIHJlbGVhc2U8L2E+IG9mIE1pc3QsIHRoZSBvZmZpY2lhbCBFdGhlcmV1bSBicm93c2VyLlwiO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIFN3ZWV0QWxlcnQuc3dhbCh7XG4gICAgICAgICAgICB0aXRsZTogXCJFcnJvciBTZXR0aW5nIENvbnRyaWJ1dGlvblwiLFxuICAgICAgICAgICAgdGV4dDogZXJyb3JNZXNzYWdlLFxuICAgICAgICAgICAgdHlwZTogXCJlcnJvclwiLFxuICAgICAgICAgICAgaHRtbDogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIFN3ZWV0QWxlcnQuc3dhbCh7XG4gICAgICAgICAgICB0aXRsZTogXCJTdWNjZXNzIVwiLFxuICAgICAgICAgICAgdGV4dDogXCJZb3VyIHJlcXVlc3QgaGFzIGJlZW4gc3VjY2Vzc2Z1bGx5IHNlbnQgdG8gdGhlIEV0aGVyZXVtIG5ldHdvcmsgZm9yIHByb2Nlc3NpbmcuIFlvdSdsbCBzZWUgeW91ciBhY2NvdW50IGJhbGFuY2UgdXBkYXRlZCBzb29uLjxicj48YnI+PHN0cm9uZz5UaGlzIG1heSB0YWtlIGEgbWludXRlIG9yIHR3bzwvc3Ryb25nPi5cIixcbiAgICAgICAgICAgIHR5cGU6IFwic3VjY2Vzc1wiLFxuICAgICAgICAgICAgaHRtbDogdHJ1ZVxuICAgICAgICAgIH0pXG5cbiAgICAgICAgICB2bS5kZXNpcmVkQ29udHJpYnV0aW9uID0gdm0uY3VycmVudENvbnRyaWJ1dGlvbjtcbiAgICAgICAgICBjaGFydC5zZWdtZW50c1tjb250cmlidXRvcnNEYXRhW3ZtLnNlbGVjdGVkQWNjb3VudF0uaW5kZXhdLnZhbHVlID0gdm0uY3VycmVudENvbnRyaWJ1dGlvbjtcbiAgICAgICAgICB1cGRhdGVOZXdCYWxhbmNlKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVDaGFydCgpIHtcbiAgICAgIHZhciBzdGFydGluZ0RhdGEgPSBbZW1wdHlEYXRhU2xvdF07XG5cbiAgICAgIHZhciBjaGFydE9wdGlvbnMgPSB7XG4gICAgICAgIGFuaW1hdGlvbkVhc2luZzogJ2Vhc2VJbk91dCcsXG4gICAgICAgIHNlZ21lbnRTdHJva2VXaWR0aDogMyxcbiAgICAgICAgYW5pbWF0aW9uU3RlcHM6IDIwLFxuICAgICAgICBzZWdtZW50U3Ryb2tlQ29sb3I6ICcjRUJGMEYxJyxcbiAgICAgICAgcGVyY2VudGFnZUlubmVyQ3V0b3V0OiA3NSxcbiAgICAgICAgcmVzcG9uc2l2ZTogdHJ1ZSxcbiAgICAgICAgdG9vbHRpcFRlbXBsYXRlOiBmdW5jdGlvbih2YWx1ZU9iamVjdCkge1xuICAgICAgICAgIHZhciBuYW1lID0gKHZhbHVlT2JqZWN0LmxhYmVsID09PSB2bS5zZWxlY3RlZEFjY291bnQpID8gJ1lvdScgOiB2YWx1ZU9iamVjdC5sYWJlbDtcbiAgICAgICAgICB2YXIgdG9vbHRpcCA9IG5hbWUgKyAnOiAnICsgdmFsdWVPYmplY3QudmFsdWUudG9GaXhlZCgyKSArICcgzp4nO1xuICAgICAgICAgIGlmKCEhdm0uZ29hbCkge1xuICAgICAgICAgICAgdmFyIHBlcmNlbnRhZ2UgPSAodmFsdWVPYmplY3QudmFsdWUgLyB2bS5nb2FsICogMTAwKTtcbiAgICAgICAgICAgIHRvb2x0aXAgKz0gJyAoJyArIE1hdGgucm91bmQocGVyY2VudGFnZSAqIDEwMCkgLyAxMDAgKyAnJSknXG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB0b29sdGlwO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICB2YXIgY3R4ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ3aGVlbFwiKS5nZXRDb250ZXh0KFwiMmRcIik7XG4gICAgICBjaGFydCA9IG5ldyBDaGFydChjdHgpLkRvdWdobnV0KHN0YXJ0aW5nRGF0YSwgY2hhcnRPcHRpb25zKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB1cGRhdGVCYWxhbmNlKCkge1xuICAgICAgaWYoIWV0aGVyZXVtLmlzQ29ubmVjdGVkKCkpIHsgcmV0dXJuOyB9XG5cbiAgICAgIHZhciB3ZWkgPSBldGhlcmV1bS53ZWIzLmV0aC5nZXRCYWxhbmNlKGNvbnRyYWN0QWRkcmVzcyk7XG4gICAgICB2YXIgZXRoZXIgPSBldGhlcmV1bS53ZWIzLmZyb21XZWkod2VpLCAnZXRoZXInKTtcbiAgICAgIHZtLmJhbGFuY2UgPSBwYXJzZUZsb2F0KGV0aGVyLnRvU3RyaW5nKCkpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHVwZGF0ZU5ld0JhbGFuY2UoKSB7XG4gICAgICB2YXIgZGVsdGFDb250cmlidXRpb24gPSAodm0uZGVzaXJlZENvbnRyaWJ1dGlvbiAtIHZtLmN1cnJlbnRDb250cmlidXRpb24pO1xuICAgICAgdm0ubmV3QmFsYW5jZSA9IHZtLmJhbGFuY2UgKyBkZWx0YUNvbnRyaWJ1dGlvbjtcbiAgICAgIGNoYXJ0LnNlZ21lbnRzW2NoYXJ0LnNlZ21lbnRzLmxlbmd0aCAtIDFdLnZhbHVlID0gKHZtLmdvYWwgLSB2bS5uZXdCYWxhbmNlKTtcbiAgICAgIGNoYXJ0LnVwZGF0ZSgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHVwZGF0ZUNvbnRyaWJ1dGlvbnMoKSB7XG4gICAgICBpZighZXRoZXJldW0uaXNDb25uZWN0ZWQoKSkgeyByZXR1cm47IH1cblxuICAgICAgdXBkYXRlQmFsYW5jZSgpO1xuICAgICAgdm0uY3VycmVudENvbnRyaWJ1dGlvbiA9IHBhcnNlRmxvYXQoZXRoZXJldW0ud2ViMy5mcm9tV2VpKGNvbnRyYWN0LmNvbnRyaWJ1dGlvbnModm0uc2VsZWN0ZWRBY2NvdW50KSwgJ2V0aGVyJykudG9TdHJpbmcoKSk7XG4gICAgICB2bS5kZXNpcmVkQ29udHJpYnV0aW9uID0gTWF0aC5taW4odm0uZGVzaXJlZENvbnRyaWJ1dGlvbiwgdm0uZ29hbCAtIHZtLmJhbGFuY2UgKyB2bS5jdXJyZW50Q29udHJpYnV0aW9uKTtcbiAgICAgIHVwZGF0ZU5ld0JhbGFuY2UoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbml0aWFsaXplQ29udHJpYnV0b3JzRGF0YSgpIHtcbiAgICAgIGlmKCFldGhlcmV1bS5pc0Nvbm5lY3RlZCgpKSB7IHJldHVybjsgfVxuXG4gICAgICBjaGFydC5yZW1vdmVEYXRhKCk7XG4gICAgICBjb250cmlidXRvcnNEYXRhID0ge307XG4gICAgICB2YXIgbnVtQ29udHJpYnV0b3JzID0gY29udHJhY3QubnVtQ29udHJpYnV0b3JzKCk7XG4gICAgICBmb3IodmFyIGkgPSAwOyBpIDwgbnVtQ29udHJpYnV0b3JzOyArK2kpIHtcbiAgICAgICAgdmFyIGNvbnRyaWJ1dG9yQWRkcmVzcyA9IGNvbnRyYWN0LmNvbnRyaWJ1dG9ycyhpKS50b1N0cmluZygpO1xuICAgICAgICBjb250cmlidXRvcnNEYXRhW2NvbnRyaWJ1dG9yQWRkcmVzc10gPSB7XG4gICAgICAgICAgbGFiZWw6IGNvbnRyaWJ1dG9yQWRkcmVzcyxcbiAgICAgICAgICB2YWx1ZTogZXRoZXJldW0ud2ViMy5mcm9tV2VpKGNvbnRyYWN0LmNvbnRyaWJ1dGlvbnMoY29udHJpYnV0b3JBZGRyZXNzKSwgJ2V0aGVyJyksXG4gICAgICAgICAgY29sb3I6IChjb250cmlidXRvckFkZHJlc3MgPT09IHZtLnNlbGVjdGVkQWNjb3VudCkgPyAnIzVjYjg1YycgOiAnIzNEM0UzRicsXG4gICAgICAgICAgaW5kZXg6IGlcbiAgICAgICAgfTtcblxuICAgICAgICBjaGFydC5hZGREYXRhKGNvbnRyaWJ1dG9yc0RhdGFbY29udHJpYnV0b3JBZGRyZXNzXSk7XG4gICAgICB9XG5cbiAgICAgIHZhciBjdXJyZW50QWNjb3VudCA9IHZtLnNlbGVjdGVkQWNjb3VudC50b1N0cmluZygpO1xuICAgICAgaWYoIShjdXJyZW50QWNjb3VudCBpbiBjb250cmlidXRvcnNEYXRhKSkge1xuICAgICAgICB2YXIgaW5kZXggPSBPYmplY3Qua2V5cyhjb250cmlidXRvcnNEYXRhKS5sZW5ndGg7XG4gICAgICAgIGNvbnRyaWJ1dG9yc0RhdGFbY3VycmVudEFjY291bnRdID0ge1xuICAgICAgICAgIGxhYmVsOiBjdXJyZW50QWNjb3VudCxcbiAgICAgICAgICB2YWx1ZTogMCxcbiAgICAgICAgICBjb2xvcjogJyM1Y2I4NWMnLFxuICAgICAgICAgIGluZGV4OiBpbmRleFxuICAgICAgICB9O1xuICAgICAgICBjaGFydC5hZGREYXRhKGNvbnRyaWJ1dG9yc0RhdGFbY3VycmVudEFjY291bnRdLCBpbmRleCk7XG4gICAgICB9XG5cbiAgICAgIGNoYXJ0LmFkZERhdGEoZW1wdHlEYXRhU2xvdCk7XG4gICAgICBjaGFydC51cGRhdGUoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB1cGRhdGVSZWNlbnRSZXN1bHRzKCkge1xuICAgICAgaWYoIWV0aGVyZXVtLmlzQ29ubmVjdGVkKCkpIHsgcmV0dXJuOyB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25BY2NvdW50Q2hhbmdlZCgpIHtcbiAgICAgIGNoYXJ0LmRlc3Ryb3koKTtcbiAgICAgIGNyZWF0ZUNoYXJ0KCk7XG4gICAgICBpbml0aWFsaXplQ29udHJpYnV0b3JzRGF0YSgpO1xuICAgICAgdXBkYXRlQ29udHJpYnV0aW9ucygpO1xuICAgICAgdm0uZGVzaXJlZENvbnRyaWJ1dGlvbiA9IHZtLmN1cnJlbnRDb250cmlidXRpb247XG5cbiAgICAgIHVwZGF0ZUJhbGFuY2UoKTtcbiAgICAgIHVwZGF0ZU5ld0JhbGFuY2UoKTtcbiAgICAgIHVwZGF0ZVJlY2VudFJlc3VsdHMoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvbkNvbnRyaWJ1dGlvbkNoYW5nZWQoZXJyb3IsIHJlc3VsdCkge1xuICAgICAgaWYoIWVycm9yKSB7XG4gICAgICAgIHZhciBjb250cmlidXRvckFkZHJlc3MgPSByZXN1bHQuYXJncy5jb250cmlidXRvci50b1N0cmluZygpO1xuICAgICAgICB2YXIgdmFsdWUgPSBldGhlcmV1bS53ZWIzLmZyb21XZWkoY29udHJhY3QuY29udHJpYnV0aW9ucyhjb250cmlidXRvckFkZHJlc3MpLCAnZXRoZXInKTtcblxuICAgICAgICBpZihyZXN1bHQuYXJncy5jb250cmlidXRvciA9PSB2bS5zZWxlY3RlZEFjY291bnQpIHtcbiAgICAgICAgICB1cGRhdGVDb250cmlidXRpb25zKCk7XG4gICAgICAgICAgdm0uZGVzaXJlZENvbnRyaWJ1dGlvbiA9IHZtLmN1cnJlbnRDb250cmlidXRpb247XG4gICAgICAgIH1cblxuICAgICAgICBpZihjb250cmlidXRvckFkZHJlc3MgaW4gY29udHJpYnV0b3JzRGF0YSkge1xuICAgICAgICAgIGNoYXJ0LnNlZ21lbnRzW2NvbnRyaWJ1dG9yc0RhdGFbY29udHJpYnV0b3JBZGRyZXNzXS5pbmRleF0udmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgaW5kZXggPSBPYmplY3Qua2V5cyhjb250cmlidXRvcnNEYXRhKS5sZW5ndGg7XG4gICAgICAgICAgY29udHJpYnV0b3JzRGF0YVtjb250cmlidXRvckFkZHJlc3NdID0ge1xuICAgICAgICAgICAgbGFiZWw6IGNvbnRyaWJ1dG9yQWRkcmVzcyxcbiAgICAgICAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgICAgICAgIGNvbG9yOiAoY29udHJpYnV0b3JBZGRyZXNzID09PSB2bS5zZWxlY3RlZEFjY291bnQpID8gJyM1Y2I4NWMnIDogJyMzRDNFM0YnLFxuICAgICAgICAgICAgaW5kZXg6IGluZGV4XG4gICAgICAgICAgfTtcbiAgICAgICAgICBjaGFydC5hZGREYXRhKGNvbnRyaWJ1dG9yc0RhdGFbY29udHJpYnV0b3JBZGRyZXNzXSwgaW5kZXgpO1xuICAgICAgICB9XG5cbiAgICAgICAgY2hhcnQudXBkYXRlKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICB9XG5cbiAgICAgIHVwZGF0ZUJhbGFuY2UoKTtcbiAgICAgIHVwZGF0ZUNvbnRyaWJ1dGlvbnMoKTtcbiAgICAgIHVwZGF0ZU5ld0JhbGFuY2UoKTtcbiAgICAgICRzY29wZS4kYXBwbHkoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvbldvbihlcnJvciwgcmVzdWx0KSB7XG4gICAgICB1cGRhdGVCYWxhbmNlKCk7XG4gICAgICB1cGRhdGVDb250cmlidXRpb25zKCk7XG4gICAgICB1cGRhdGVSZWNlbnRSZXN1bHRzKCk7XG4gICAgICAkc2NvcGUuJGFwcGx5KCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25TbGlkZXJDaGFuZ2VkKHNsaWRlcklkLCBtb2RlbFZhbHVlKSB7XG4gICAgICB2YXIgY3VycmVudEFjY291bnQgPSB2bS5zZWxlY3RlZEFjY291bnQudG9TdHJpbmcoKTtcbiAgICAgIGNoYXJ0LnNlZ21lbnRzW2NvbnRyaWJ1dG9yc0RhdGFbY3VycmVudEFjY291bnRdLmluZGV4XS52YWx1ZSA9IG1vZGVsVmFsdWU7XG4gICAgICB1cGRhdGVOZXdCYWxhbmNlKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0QmFsYW5jZShhY2NvdW50KSB7XG4gICAgICBpZighZXRoZXJldW0uaXNDb25uZWN0ZWQoKSkgeyByZXR1cm47IH1cbiAgICAgIHJldHVybiBldGhlcmV1bS53ZWIzLmZyb21XZWkoZXRoZXJldW0ud2ViMy5ldGguZ2V0QmFsYW5jZShhY2NvdW50KSwgJ2V0aGVyJyk7XG4gICAgfVxuICB9XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ2V0aGVyLXNwaW5uZXInLCBbXG4gICAgJ25nUm91dGUnLFxuICAgICdyek1vZHVsZScsXG4gICAgJ29pdG96ZXJvLm5nU3dlZXRBbGVydCdcbiAgXSkuXG4gIGNvbmZpZyhbJyRyb3V0ZVByb3ZpZGVyJywgZnVuY3Rpb24oJHJvdXRlUHJvdmlkZXIpIHtcbiAgICAkcm91dGVQcm92aWRlci5vdGhlcndpc2Uoe3JlZGlyZWN0VG86ICcvJ30pO1xuICB9XSk7XG59KSgpO1xuXG4oZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBTcGlubmVyQ3RybC4kaW5qZWN0ID0gW1wiJHJvdXRlXCIsIFwiJHNjb3BlXCIsIFwiU3dlZXRBbGVydFwiLCBcImV0aGVyZXVtXCJdO1xuICBhbmd1bGFyLm1vZHVsZSgnZXRoZXItc3Bpbm5lcicpLmNvbnRyb2xsZXIoJ1NwaW5uZXJDdHJsJywgU3Bpbm5lckN0cmwpO1xuXG4gIC8qQG5nSW5qZWN0Ki9cbiAgZnVuY3Rpb24gU3Bpbm5lckN0cmwoJHJvdXRlLCAkc2NvcGUsIFN3ZWV0QWxlcnQsIGV0aGVyZXVtKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5pc0Nvbm5lY3RlZCA9IGV0aGVyZXVtLmlzQ29ubmVjdGVkO1xuICAgIHZtLnNldENvbnRyaWJ1dGlvbiA9IHNldENvbnRyaWJ1dGlvbjtcbiAgICB2bS5vbkFjY291bnRDaGFuZ2VkID0gb25BY2NvdW50Q2hhbmdlZDtcbiAgICB2bS5nZXRCYWxhbmNlID0gZ2V0QmFsYW5jZTtcblxuICAgIHZhciBlbXB0eUJhckNvbG91ciA9ICcjZGNlNmU5JztcbiAgICB2YXIgY29udHJhY3RBZGRyZXNzID0gJzB4NzllZEUzQTk4YjA0Mjg2MzM4NGRFMjU3ODg1MDQ1MzIzNjJkNTJENic7XG4gICAgdmFyIGNvbnRyYWN0ID0gbnVsbDtcblxuICAgIHZhciBjaGFydDtcbiAgICB2YXIgY29udHJpYnV0b3JzRGF0YTtcbiAgICB2YXIgZW1wdHlEYXRhU2xvdCA9IHtcbiAgICAgIHZhbHVlOiA1LjAsXG4gICAgICBjb2xvcjogZW1wdHlCYXJDb2xvdXIsXG4gICAgICBsYWJlbDogXCJFbXB0eVwiXG4gICAgfTtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIGNyZWF0ZUNoYXJ0KCk7XG4gICAgICBpZighZXRoZXJldW0uaXNDb25uZWN0ZWQoKSkgeyByZXR1cm47IH1cblxuICAgICAgdmFyIGFiaSA9IFt7XCJjb25zdGFudFwiOnRydWUsXCJpbnB1dHNcIjpbe1wibmFtZVwiOlwiXCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9XSxcIm5hbWVcIjpcImNvbnRyaWJ1dG9yc1wiLFwib3V0cHV0c1wiOlt7XCJuYW1lXCI6XCJcIixcInR5cGVcIjpcImFkZHJlc3NcIn1dLFwidHlwZVwiOlwiZnVuY3Rpb25cIn0se1wiY29uc3RhbnRcIjp0cnVlLFwiaW5wdXRzXCI6W10sXCJuYW1lXCI6XCJnb2FsXCIsXCJvdXRwdXRzXCI6W3tcIm5hbWVcIjpcIlwiLFwidHlwZVwiOlwidWludDI1NlwifV0sXCJ0eXBlXCI6XCJmdW5jdGlvblwifSx7XCJjb25zdGFudFwiOnRydWUsXCJpbnB1dHNcIjpbe1wibmFtZVwiOlwiXCIsXCJ0eXBlXCI6XCJhZGRyZXNzXCJ9XSxcIm5hbWVcIjpcImNvbnRyaWJ1dGlvbnNcIixcIm91dHB1dHNcIjpbe1wibmFtZVwiOlwiXCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9XSxcInR5cGVcIjpcImZ1bmN0aW9uXCJ9LHtcImNvbnN0YW50XCI6ZmFsc2UsXCJpbnB1dHNcIjpbe1wibmFtZVwiOlwibmV3SG9zdFwiLFwidHlwZVwiOlwiYWRkcmVzc1wifV0sXCJuYW1lXCI6XCJjaGFuZ2VIb3N0XCIsXCJvdXRwdXRzXCI6W10sXCJ0eXBlXCI6XCJmdW5jdGlvblwifSx7XCJjb25zdGFudFwiOmZhbHNlLFwiaW5wdXRzXCI6W10sXCJuYW1lXCI6XCJkZXN0cm95XCIsXCJvdXRwdXRzXCI6W10sXCJ0eXBlXCI6XCJmdW5jdGlvblwifSx7XCJjb25zdGFudFwiOmZhbHNlLFwiaW5wdXRzXCI6W3tcIm5hbWVcIjpcImFtb3VudFwiLFwidHlwZVwiOlwidWludDI1NlwifV0sXCJuYW1lXCI6XCJzZXRDb250cmlidXRpb25cIixcIm91dHB1dHNcIjpbXSxcInR5cGVcIjpcImZ1bmN0aW9uXCJ9LHtcImNvbnN0YW50XCI6dHJ1ZSxcImlucHV0c1wiOltdLFwibmFtZVwiOlwibnVtV2lubmVyc1wiLFwib3V0cHV0c1wiOlt7XCJuYW1lXCI6XCJcIixcInR5cGVcIjpcInVpbnQyNTZcIn1dLFwidHlwZVwiOlwiZnVuY3Rpb25cIn0se1wiY29uc3RhbnRcIjp0cnVlLFwiaW5wdXRzXCI6W10sXCJuYW1lXCI6XCJudW1Db250cmlidXRvcnNcIixcIm91dHB1dHNcIjpbe1wibmFtZVwiOlwiXCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9XSxcInR5cGVcIjpcImZ1bmN0aW9uXCJ9LHtcImNvbnN0YW50XCI6ZmFsc2UsXCJpbnB1dHNcIjpbXSxcIm5hbWVcIjpcImFkZFRvQ29udHJpYnV0aW9uXCIsXCJvdXRwdXRzXCI6W10sXCJ0eXBlXCI6XCJmdW5jdGlvblwifSx7XCJjb25zdGFudFwiOnRydWUsXCJpbnB1dHNcIjpbXSxcIm5hbWVcIjpcImluY3JlbWVudFwiLFwib3V0cHV0c1wiOlt7XCJuYW1lXCI6XCJcIixcInR5cGVcIjpcInVpbnQyNTZcIn1dLFwidHlwZVwiOlwiZnVuY3Rpb25cIn0se1wiY29uc3RhbnRcIjpmYWxzZSxcImlucHV0c1wiOlt7XCJuYW1lXCI6XCJhbW91bnRcIixcInR5cGVcIjpcInVpbnQyNTZcIn1dLFwibmFtZVwiOlwicmVtb3ZlRnJvbUNvbnRyaWJ1dGlvblwiLFwib3V0cHV0c1wiOltdLFwidHlwZVwiOlwiZnVuY3Rpb25cIn0se1wiY29uc3RhbnRcIjp0cnVlLFwiaW5wdXRzXCI6W3tcIm5hbWVcIjpcIlwiLFwidHlwZVwiOlwidWludDI1NlwifV0sXCJuYW1lXCI6XCJyZWNlbnRXaW5zXCIsXCJvdXRwdXRzXCI6W3tcIm5hbWVcIjpcIndpbm5lclwiLFwidHlwZVwiOlwiYWRkcmVzc1wifSx7XCJuYW1lXCI6XCJ0aW1lc3RhbXBcIixcInR5cGVcIjpcInVpbnQyNTZcIn0se1wibmFtZVwiOlwiY29udHJpYnV0aW9uXCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9XSxcInR5cGVcIjpcImZ1bmN0aW9uXCJ9LHtcImNvbnN0YW50XCI6dHJ1ZSxcImlucHV0c1wiOltdLFwibmFtZVwiOlwiaG9zdFwiLFwib3V0cHV0c1wiOlt7XCJuYW1lXCI6XCJcIixcInR5cGVcIjpcImFkZHJlc3NcIn1dLFwidHlwZVwiOlwiZnVuY3Rpb25cIn0se1wiaW5wdXRzXCI6W3tcIm5hbWVcIjpcIl9nb2FsSW5GaW5uZXlcIixcInR5cGVcIjpcInVpbnQyNTZcIn0se1wibmFtZVwiOlwiX2luY3JlbWVudEluRmlubmV5XCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9LHtcIm5hbWVcIjpcIl9yZWNlbnRXaW5zQ291bnRcIixcInR5cGVcIjpcInVpbnQ4XCJ9XSxcInR5cGVcIjpcImNvbnN0cnVjdG9yXCJ9LHtcImFub255bW91c1wiOmZhbHNlLFwiaW5wdXRzXCI6W3tcImluZGV4ZWRcIjpmYWxzZSxcIm5hbWVcIjpcIndpbm5lclwiLFwidHlwZVwiOlwiYWRkcmVzc1wifSx7XCJpbmRleGVkXCI6ZmFsc2UsXCJuYW1lXCI6XCJ0aW1lc3RhbXBcIixcInR5cGVcIjpcInVpbnQyNTZcIn0se1wiaW5kZXhlZFwiOmZhbHNlLFwibmFtZVwiOlwiY29udHJpYnV0aW9uXCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9XSxcIm5hbWVcIjpcIldvblwiLFwidHlwZVwiOlwiZXZlbnRcIn0se1wiYW5vbnltb3VzXCI6ZmFsc2UsXCJpbnB1dHNcIjpbe1wiaW5kZXhlZFwiOmZhbHNlLFwibmFtZVwiOlwiY29udHJpYnV0b3JcIixcInR5cGVcIjpcImFkZHJlc3NcIn1dLFwibmFtZVwiOlwiQ2hhbmdlZENvbnRyaWJ1dGlvblwiLFwidHlwZVwiOlwiZXZlbnRcIn1dO1xuICAgICAgdmFyIGNvbnRyYWN0Qmx1ZXByaW50ID0gZXRoZXJldW0ud2ViMy5ldGguY29udHJhY3QoYWJpKTtcbiAgICAgIGNvbnRyYWN0ID0gY29udHJhY3RCbHVlcHJpbnQuYXQoY29udHJhY3RBZGRyZXNzKTtcblxuICAgICAgdm0uZ29hbCA9IGV0aGVyZXVtLndlYjMuZnJvbVdlaShjb250cmFjdC5nb2FsKCksICdldGhlcicpLnRvU3RyaW5nKCk7XG4gICAgICB2bS5zbGlkZXJTdGVwID0gZXRoZXJldW0ud2ViMy5mcm9tV2VpKGNvbnRyYWN0LmluY3JlbWVudCgpLCAnZXRoZXInKS50b1N0cmluZygpO1xuICAgICAgdm0ub25TbGlkZXJDaGFuZ2VkID0gb25TbGlkZXJDaGFuZ2VkO1xuICAgICAgZW1wdHlEYXRhU2xvdC52YWx1ZSA9IHZtLmdvYWw7XG5cbiAgICAgIHZtLmFjY291bnRzID0gZXRoZXJldW0ud2ViMy5ldGguYWNjb3VudHM7XG4gICAgICB2bS5zZWxlY3RlZEFjY291bnQgPSBldGhlcmV1bS53ZWIzLmV0aC5kZWZhdWx0QWNjb3VudDtcbiAgICAgIGlmKCF2bS5zZWxlY3RlZEFjY291bnQpIHtcbiAgICAgICAgdm0uc2VsZWN0ZWRBY2NvdW50ID0gZXRoZXJldW0ud2ViMy5ldGguY29pbmJhc2U7XG4gICAgICB9XG5cbiAgICAgIGluaXRpYWxpemVDb250cmlidXRvcnNEYXRhKCk7XG4gICAgICB1cGRhdGVDb250cmlidXRpb25zKCk7XG4gICAgICB2bS5kZXNpcmVkQ29udHJpYnV0aW9uID0gdm0uY3VycmVudENvbnRyaWJ1dGlvbjtcblxuICAgICAgdXBkYXRlQmFsYW5jZSgpO1xuICAgICAgdXBkYXRlTmV3QmFsYW5jZSgpO1xuICAgICAgdXBkYXRlUmVjZW50UmVzdWx0cygpO1xuXG4gICAgICB2YXIgb25Db250cmlidXRpb25DaGFuZ2VkRXZlbnQgPSBjb250cmFjdC5DaGFuZ2VkQ29udHJpYnV0aW9uKCk7XG4gICAgICBvbkNvbnRyaWJ1dGlvbkNoYW5nZWRFdmVudC53YXRjaChvbkNvbnRyaWJ1dGlvbkNoYW5nZWQpO1xuXG4gICAgICB2YXIgb25Xb25FdmVudCA9IGNvbnRyYWN0LldvbigpO1xuICAgICAgb25Xb25FdmVudC53YXRjaChvbldvbik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2V0Q29udHJpYnV0aW9uKCkge1xuICAgICAgdmFyIGRlbHRhQ29udHJpYnV0aW9uID0gdm0uZGVzaXJlZENvbnRyaWJ1dGlvbiAtIHZtLmN1cnJlbnRDb250cmlidXRpb247XG4gICAgICB2YXIgY2hhbmdlSW5XZWkgPSBldGhlcmV1bS53ZWIzLnRvV2VpKGRlbHRhQ29udHJpYnV0aW9uLCAnZXRoZXInKTtcbiAgICAgIGNvbnNvbGUubG9nKGNoYW5nZUluV2VpKTtcbiAgICAgIGlmKGRlbHRhQ29udHJpYnV0aW9uID4gMCkge1xuICAgICAgICBjb250cmFjdC5hZGRUb0NvbnRyaWJ1dGlvbihudWxsLCB7IHZhbHVlOiBjaGFuZ2VJbldlaSwgZnJvbTogdm0uc2VsZWN0ZWRBY2NvdW50LCB0bzogY29udHJhY3RBZGRyZXNzIH0sIG9uQ29udHJpYnV0aW9uU2V0KTtcbiAgICAgIH0gZWxzZSBpZihkZWx0YUNvbnRyaWJ1dGlvbiA8IDApe1xuICAgICAgICBjb250cmFjdC5yZW1vdmVGcm9tQ29udHJpYnV0aW9uKC1jaGFuZ2VJbldlaSwgeyBmcm9tOiB2bS5zZWxlY3RlZEFjY291bnQsIHRvOiBjb250cmFjdEFkZHJlc3MgfSwgb25Db250cmlidXRpb25TZXQpO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBvbkNvbnRyaWJ1dGlvblNldChlcnJvciwgcmVzdWx0KSB7XG4gICAgICAgIGlmKGVycm9yKSB7XG4gICAgICAgICAgdmFyIGVycm9yTWVzc2FnZSA9IGVycm9yO1xuICAgICAgICAgIGlmKGVycm9yTWVzc2FnZS50b1N0cmluZygpLmluZGV4T2YoJ3VubG9jayBzaWduZXIgYWNjb3VudCcpID49IDApIHtcbiAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlICs9IFwiPGJyPjxicj5NYWtlIHN1cmUgeW91J3JlIGFjY2Vzc2luZyB0aGlzIHBhZ2UgdGhyb3VnaCB0aGUgPGEgaHJlZj1cXFwiaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL21pc3QvcmVsZWFzZXMvdGFnLzAuMy42XFxcIj5lYXJseSBkZXZlbG9wZXIgcmVsZWFzZTwvYT4gb2YgTWlzdCwgdGhlIG9mZmljaWFsIEV0aGVyZXVtIGJyb3dzZXIuXCI7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgU3dlZXRBbGVydC5zd2FsKHtcbiAgICAgICAgICAgIHRpdGxlOiBcIkVycm9yIFNldHRpbmcgQ29udHJpYnV0aW9uXCIsXG4gICAgICAgICAgICB0ZXh0OiBlcnJvck1lc3NhZ2UsXG4gICAgICAgICAgICB0eXBlOiBcImVycm9yXCIsXG4gICAgICAgICAgICBodG1sOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgU3dlZXRBbGVydC5zd2FsKHtcbiAgICAgICAgICAgIHRpdGxlOiBcIlN1Y2Nlc3MhXCIsXG4gICAgICAgICAgICB0ZXh0OiBcIllvdXIgcmVxdWVzdCBoYXMgYmVlbiBzdWNjZXNzZnVsbHkgc2VudCB0byB0aGUgRXRoZXJldW0gbmV0d29yayBmb3IgcHJvY2Vzc2luZy4gWW91J2xsIHNlZSB5b3VyIGFjY291bnQgYmFsYW5jZSB1cGRhdGVkIHNvb24uPGJyPjxicj48c3Ryb25nPlRoaXMgbWF5IHRha2UgYSBtaW51dGUgb3IgdHdvPC9zdHJvbmc+LlwiLFxuICAgICAgICAgICAgdHlwZTogXCJzdWNjZXNzXCIsXG4gICAgICAgICAgICBodG1sOiB0cnVlXG4gICAgICAgICAgfSlcblxuICAgICAgICAgIHZtLmRlc2lyZWRDb250cmlidXRpb24gPSB2bS5jdXJyZW50Q29udHJpYnV0aW9uO1xuICAgICAgICAgIGNoYXJ0LnNlZ21lbnRzW2NvbnRyaWJ1dG9yc0RhdGFbdm0uc2VsZWN0ZWRBY2NvdW50XS5pbmRleF0udmFsdWUgPSB2bS5jdXJyZW50Q29udHJpYnV0aW9uO1xuICAgICAgICAgIHVwZGF0ZU5ld0JhbGFuY2UoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZUNoYXJ0KCkge1xuICAgICAgdmFyIHN0YXJ0aW5nRGF0YSA9IFtlbXB0eURhdGFTbG90XTtcblxuICAgICAgdmFyIGNoYXJ0T3B0aW9ucyA9IHtcbiAgICAgICAgYW5pbWF0aW9uRWFzaW5nOiAnZWFzZUluT3V0JyxcbiAgICAgICAgc2VnbWVudFN0cm9rZVdpZHRoOiAzLFxuICAgICAgICBhbmltYXRpb25TdGVwczogMjAsXG4gICAgICAgIHNlZ21lbnRTdHJva2VDb2xvcjogJyNFQkYwRjEnLFxuICAgICAgICBwZXJjZW50YWdlSW5uZXJDdXRvdXQ6IDc1LFxuICAgICAgICByZXNwb25zaXZlOiB0cnVlLFxuICAgICAgICB0b29sdGlwVGVtcGxhdGU6IGZ1bmN0aW9uKHZhbHVlT2JqZWN0KSB7XG4gICAgICAgICAgdmFyIG5hbWUgPSAodmFsdWVPYmplY3QubGFiZWwgPT09IHZtLnNlbGVjdGVkQWNjb3VudCkgPyAnWW91JyA6IHZhbHVlT2JqZWN0LmxhYmVsO1xuICAgICAgICAgIHZhciB0b29sdGlwID0gbmFtZSArICc6ICcgKyB2YWx1ZU9iamVjdC52YWx1ZS50b0ZpeGVkKDIpICsgJyDOnic7XG4gICAgICAgICAgaWYoISF2bS5nb2FsKSB7XG4gICAgICAgICAgICB2YXIgcGVyY2VudGFnZSA9ICh2YWx1ZU9iamVjdC52YWx1ZSAvIHZtLmdvYWwgKiAxMDApO1xuICAgICAgICAgICAgdG9vbHRpcCArPSAnICgnICsgTWF0aC5yb3VuZChwZXJjZW50YWdlICogMTAwKSAvIDEwMCArICclKSdcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHRvb2x0aXA7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIHZhciBjdHggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIndoZWVsXCIpLmdldENvbnRleHQoXCIyZFwiKTtcbiAgICAgIGNoYXJ0ID0gbmV3IENoYXJ0KGN0eCkuRG91Z2hudXQoc3RhcnRpbmdEYXRhLCBjaGFydE9wdGlvbnMpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHVwZGF0ZUJhbGFuY2UoKSB7XG4gICAgICBpZighZXRoZXJldW0uaXNDb25uZWN0ZWQoKSkgeyByZXR1cm47IH1cblxuICAgICAgdmFyIHdlaSA9IGV0aGVyZXVtLndlYjMuZXRoLmdldEJhbGFuY2UoY29udHJhY3RBZGRyZXNzKTtcbiAgICAgIHZhciBldGhlciA9IGV0aGVyZXVtLndlYjMuZnJvbVdlaSh3ZWksICdldGhlcicpO1xuICAgICAgdm0uYmFsYW5jZSA9IHBhcnNlRmxvYXQoZXRoZXIudG9TdHJpbmcoKSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdXBkYXRlTmV3QmFsYW5jZSgpIHtcbiAgICAgIHZhciBkZWx0YUNvbnRyaWJ1dGlvbiA9ICh2bS5kZXNpcmVkQ29udHJpYnV0aW9uIC0gdm0uY3VycmVudENvbnRyaWJ1dGlvbik7XG4gICAgICB2bS5uZXdCYWxhbmNlID0gdm0uYmFsYW5jZSArIGRlbHRhQ29udHJpYnV0aW9uO1xuICAgICAgY2hhcnQuc2VnbWVudHNbY2hhcnQuc2VnbWVudHMubGVuZ3RoIC0gMV0udmFsdWUgPSAodm0uZ29hbCAtIHZtLm5ld0JhbGFuY2UpO1xuICAgICAgY2hhcnQudXBkYXRlKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdXBkYXRlQ29udHJpYnV0aW9ucygpIHtcbiAgICAgIGlmKCFldGhlcmV1bS5pc0Nvbm5lY3RlZCgpKSB7IHJldHVybjsgfVxuXG4gICAgICB1cGRhdGVCYWxhbmNlKCk7XG4gICAgICB2bS5jdXJyZW50Q29udHJpYnV0aW9uID0gcGFyc2VGbG9hdChldGhlcmV1bS53ZWIzLmZyb21XZWkoY29udHJhY3QuY29udHJpYnV0aW9ucyh2bS5zZWxlY3RlZEFjY291bnQpLCAnZXRoZXInKS50b1N0cmluZygpKTtcbiAgICAgIHZtLmRlc2lyZWRDb250cmlidXRpb24gPSBNYXRoLm1pbih2bS5kZXNpcmVkQ29udHJpYnV0aW9uLCB2bS5nb2FsIC0gdm0uYmFsYW5jZSArIHZtLmN1cnJlbnRDb250cmlidXRpb24pO1xuICAgICAgdXBkYXRlTmV3QmFsYW5jZSgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluaXRpYWxpemVDb250cmlidXRvcnNEYXRhKCkge1xuICAgICAgaWYoIWV0aGVyZXVtLmlzQ29ubmVjdGVkKCkpIHsgcmV0dXJuOyB9XG5cbiAgICAgIGNoYXJ0LnJlbW92ZURhdGEoKTtcbiAgICAgIGNvbnRyaWJ1dG9yc0RhdGEgPSB7fTtcbiAgICAgIHZhciBudW1Db250cmlidXRvcnMgPSBjb250cmFjdC5udW1Db250cmlidXRvcnMoKTtcbiAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBudW1Db250cmlidXRvcnM7ICsraSkge1xuICAgICAgICB2YXIgY29udHJpYnV0b3JBZGRyZXNzID0gY29udHJhY3QuY29udHJpYnV0b3JzKGkpLnRvU3RyaW5nKCk7XG4gICAgICAgIGNvbnRyaWJ1dG9yc0RhdGFbY29udHJpYnV0b3JBZGRyZXNzXSA9IHtcbiAgICAgICAgICBsYWJlbDogY29udHJpYnV0b3JBZGRyZXNzLFxuICAgICAgICAgIHZhbHVlOiBldGhlcmV1bS53ZWIzLmZyb21XZWkoY29udHJhY3QuY29udHJpYnV0aW9ucyhjb250cmlidXRvckFkZHJlc3MpLCAnZXRoZXInKSxcbiAgICAgICAgICBjb2xvcjogKGNvbnRyaWJ1dG9yQWRkcmVzcyA9PT0gdm0uc2VsZWN0ZWRBY2NvdW50KSA/ICcjNWNiODVjJyA6ICcjM0QzRTNGJyxcbiAgICAgICAgICBpbmRleDogaVxuICAgICAgICB9O1xuXG4gICAgICAgIGNoYXJ0LmFkZERhdGEoY29udHJpYnV0b3JzRGF0YVtjb250cmlidXRvckFkZHJlc3NdKTtcbiAgICAgIH1cblxuICAgICAgdmFyIGN1cnJlbnRBY2NvdW50ID0gdm0uc2VsZWN0ZWRBY2NvdW50LnRvU3RyaW5nKCk7XG4gICAgICBpZighKGN1cnJlbnRBY2NvdW50IGluIGNvbnRyaWJ1dG9yc0RhdGEpKSB7XG4gICAgICAgIHZhciBpbmRleCA9IE9iamVjdC5rZXlzKGNvbnRyaWJ1dG9yc0RhdGEpLmxlbmd0aDtcbiAgICAgICAgY29udHJpYnV0b3JzRGF0YVtjdXJyZW50QWNjb3VudF0gPSB7XG4gICAgICAgICAgbGFiZWw6IGN1cnJlbnRBY2NvdW50LFxuICAgICAgICAgIHZhbHVlOiAwLFxuICAgICAgICAgIGNvbG9yOiAnIzVjYjg1YycsXG4gICAgICAgICAgaW5kZXg6IGluZGV4XG4gICAgICAgIH07XG4gICAgICAgIGNoYXJ0LmFkZERhdGEoY29udHJpYnV0b3JzRGF0YVtjdXJyZW50QWNjb3VudF0sIGluZGV4KTtcbiAgICAgIH1cblxuICAgICAgY2hhcnQuYWRkRGF0YShlbXB0eURhdGFTbG90KTtcbiAgICAgIGNoYXJ0LnVwZGF0ZSgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHVwZGF0ZVJlY2VudFJlc3VsdHMoKSB7XG4gICAgICBpZighZXRoZXJldW0uaXNDb25uZWN0ZWQoKSkgeyByZXR1cm47IH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvbkFjY291bnRDaGFuZ2VkKCkge1xuICAgICAgY2hhcnQuZGVzdHJveSgpO1xuICAgICAgY3JlYXRlQ2hhcnQoKTtcbiAgICAgIGluaXRpYWxpemVDb250cmlidXRvcnNEYXRhKCk7XG4gICAgICB1cGRhdGVDb250cmlidXRpb25zKCk7XG4gICAgICB2bS5kZXNpcmVkQ29udHJpYnV0aW9uID0gdm0uY3VycmVudENvbnRyaWJ1dGlvbjtcblxuICAgICAgdXBkYXRlQmFsYW5jZSgpO1xuICAgICAgdXBkYXRlTmV3QmFsYW5jZSgpO1xuICAgICAgdXBkYXRlUmVjZW50UmVzdWx0cygpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9uQ29udHJpYnV0aW9uQ2hhbmdlZChlcnJvciwgcmVzdWx0KSB7XG4gICAgICBpZighZXJyb3IpIHtcbiAgICAgICAgdmFyIGNvbnRyaWJ1dG9yQWRkcmVzcyA9IHJlc3VsdC5hcmdzLmNvbnRyaWJ1dG9yLnRvU3RyaW5nKCk7XG4gICAgICAgIHZhciB2YWx1ZSA9IGV0aGVyZXVtLndlYjMuZnJvbVdlaShjb250cmFjdC5jb250cmlidXRpb25zKGNvbnRyaWJ1dG9yQWRkcmVzcyksICdldGhlcicpO1xuXG4gICAgICAgIGlmKHJlc3VsdC5hcmdzLmNvbnRyaWJ1dG9yID09IHZtLnNlbGVjdGVkQWNjb3VudCkge1xuICAgICAgICAgIHVwZGF0ZUNvbnRyaWJ1dGlvbnMoKTtcbiAgICAgICAgICB2bS5kZXNpcmVkQ29udHJpYnV0aW9uID0gdm0uY3VycmVudENvbnRyaWJ1dGlvbjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmKGNvbnRyaWJ1dG9yQWRkcmVzcyBpbiBjb250cmlidXRvcnNEYXRhKSB7XG4gICAgICAgICAgY2hhcnQuc2VnbWVudHNbY29udHJpYnV0b3JzRGF0YVtjb250cmlidXRvckFkZHJlc3NdLmluZGV4XS52YWx1ZSA9IHZhbHVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBpbmRleCA9IE9iamVjdC5rZXlzKGNvbnRyaWJ1dG9yc0RhdGEpLmxlbmd0aDtcbiAgICAgICAgICBjb250cmlidXRvcnNEYXRhW2NvbnRyaWJ1dG9yQWRkcmVzc10gPSB7XG4gICAgICAgICAgICBsYWJlbDogY29udHJpYnV0b3JBZGRyZXNzLFxuICAgICAgICAgICAgdmFsdWU6IHZhbHVlLFxuICAgICAgICAgICAgY29sb3I6IChjb250cmlidXRvckFkZHJlc3MgPT09IHZtLnNlbGVjdGVkQWNjb3VudCkgPyAnIzVjYjg1YycgOiAnIzNEM0UzRicsXG4gICAgICAgICAgICBpbmRleDogaW5kZXhcbiAgICAgICAgICB9O1xuICAgICAgICAgIGNoYXJ0LmFkZERhdGEoY29udHJpYnV0b3JzRGF0YVtjb250cmlidXRvckFkZHJlc3NdLCBpbmRleCk7XG4gICAgICAgIH1cblxuICAgICAgICBjaGFydC51cGRhdGUoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgIH1cblxuICAgICAgdXBkYXRlQmFsYW5jZSgpO1xuICAgICAgdXBkYXRlQ29udHJpYnV0aW9ucygpO1xuICAgICAgdXBkYXRlTmV3QmFsYW5jZSgpO1xuICAgICAgJHNjb3BlLiRhcHBseSgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9uV29uKGVycm9yLCByZXN1bHQpIHtcbiAgICAgIHVwZGF0ZUJhbGFuY2UoKTtcbiAgICAgIHVwZGF0ZUNvbnRyaWJ1dGlvbnMoKTtcbiAgICAgIHVwZGF0ZVJlY2VudFJlc3VsdHMoKTtcbiAgICAgICRzY29wZS4kYXBwbHkoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvblNsaWRlckNoYW5nZWQoc2xpZGVySWQsIG1vZGVsVmFsdWUpIHtcbiAgICAgIHZhciBjdXJyZW50QWNjb3VudCA9IHZtLnNlbGVjdGVkQWNjb3VudC50b1N0cmluZygpO1xuICAgICAgY2hhcnQuc2VnbWVudHNbY29udHJpYnV0b3JzRGF0YVtjdXJyZW50QWNjb3VudF0uaW5kZXhdLnZhbHVlID0gbW9kZWxWYWx1ZTtcbiAgICAgIHVwZGF0ZU5ld0JhbGFuY2UoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRCYWxhbmNlKGFjY291bnQpIHtcbiAgICAgIGlmKCFldGhlcmV1bS5pc0Nvbm5lY3RlZCgpKSB7IHJldHVybjsgfVxuICAgICAgcmV0dXJuIGV0aGVyZXVtLndlYjMuZnJvbVdlaShldGhlcmV1bS53ZWIzLmV0aC5nZXRCYWxhbmNlKGFjY291bnQpLCAnZXRoZXInKTtcbiAgICB9XG4gIH1cbn0pKCk7XG5cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnZXRoZXItc3Bpbm5lcicpLnNlcnZpY2UoJ2V0aGVyZXVtJywgZXRoZXJldW0pO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gZXRoZXJldW0oKSB7XG4gICAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgICAgd2ViMzogbmV3IFdlYjMoKSxcbiAgICAgICAgaXNDb25uZWN0ZWQ6IGlzQ29ubmVjdGVkXG4gICAgICB9O1xuXG4gICAgICBhY3RpdmF0ZSgpO1xuXG4gICAgICByZXR1cm4gc2VydmljZTtcblxuICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgICAgc2VydmljZS53ZWIzLnNldFByb3ZpZGVyKG5ldyBzZXJ2aWNlLndlYjMucHJvdmlkZXJzLkh0dHBQcm92aWRlcihcImh0dHA6Ly9sb2NhbGhvc3Q6ODU0NVwiKSk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGlzQ29ubmVjdGVkKCkge1xuICAgICAgICByZXR1cm4gc2VydmljZS53ZWIzLmN1cnJlbnRQcm92aWRlci5pc0Nvbm5lY3RlZCgpO1xuICAgICAgfVxuICAgIH1cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2V0aGVyLXNwaW5uZXInKS5zZXJ2aWNlKCdldGhlcmV1bScsIGV0aGVyZXVtKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIGV0aGVyZXVtKCkge1xuICAgICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICAgIHdlYjM6IG5ldyBXZWIzKCksXG4gICAgICAgIGlzQ29ubmVjdGVkOiBpc0Nvbm5lY3RlZFxuICAgICAgfTtcblxuICAgICAgYWN0aXZhdGUoKTtcblxuICAgICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICAgIHNlcnZpY2Uud2ViMy5zZXRQcm92aWRlcihuZXcgc2VydmljZS53ZWIzLnByb3ZpZGVycy5IdHRwUHJvdmlkZXIoXCJodHRwOi8vbG9jYWxob3N0Ojg1NDVcIikpO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBpc0Nvbm5lY3RlZCgpIHtcbiAgICAgICAgcmV0dXJuIHNlcnZpY2Uud2ViMy5jdXJyZW50UHJvdmlkZXIuaXNDb25uZWN0ZWQoKTtcbiAgICAgIH1cbiAgICB9XG59KSgpO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
