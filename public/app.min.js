!function(){"use strict";angular.module("ether-spinner",["ngRoute","rzModule","oitozero.ngSweetAlert","angularMoment"]).config(["$routeProvider",function(e){e.otherwise({redirectTo:"/"})}])}(),function(){"use strict";function e(e,t,n,o){function i(){if(u(),o.isConnected()){var e=[{constant:!0,inputs:[{name:"",type:"uint256"}],name:"contributors",outputs:[{name:"",type:"address"}],type:"function"},{constant:!0,inputs:[],name:"goal",outputs:[{name:"",type:"uint256"}],type:"function"},{constant:!0,inputs:[{name:"",type:"address"}],name:"contributions",outputs:[{name:"",type:"uint256"}],type:"function"},{constant:!1,inputs:[{name:"newHost",type:"address"}],name:"changeHost",outputs:[],type:"function"},{constant:!1,inputs:[],name:"destroy",outputs:[],type:"function"},{constant:!1,inputs:[{name:"amount",type:"uint256"}],name:"setContribution",outputs:[],type:"function"},{constant:!0,inputs:[],name:"numWinners",outputs:[{name:"",type:"uint256"}],type:"function"},{constant:!0,inputs:[],name:"numContributors",outputs:[{name:"",type:"uint256"}],type:"function"},{constant:!1,inputs:[],name:"addToContribution",outputs:[],type:"function"},{constant:!0,inputs:[],name:"increment",outputs:[{name:"",type:"uint256"}],type:"function"},{constant:!1,inputs:[{name:"amount",type:"uint256"}],name:"removeFromContribution",outputs:[],type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"recentWins",outputs:[{name:"winner",type:"address"},{name:"timestamp",type:"uint256"},{name:"contribution",type:"uint256"}],type:"function"},{constant:!0,inputs:[],name:"host",outputs:[{name:"",type:"address"}],type:"function"},{inputs:[{name:"_goalInFinney",type:"uint256"},{name:"_incrementInFinney",type:"uint256"},{name:"_recentWinsCount",type:"uint8"}],type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,name:"winner",type:"address"},{indexed:!1,name:"timestamp",type:"uint256"},{indexed:!1,name:"contribution",type:"uint256"}],name:"Won",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"contributor",type:"address"}],name:"ChangedContribution",type:"event"}],t=o.web3.eth.contract(e);W=t.at(w),h.goal=o.web3.fromWei(W.goal(),"ether").toString(),h.sliderStep=o.web3.fromWei(W.increment(),"ether").toString(),h.onSliderChanged=f,S.value=h.goal,h.accounts=o.web3.eth.accounts,h.selectedAccount=o.web3.eth.defaultAccount,h.selectedAccount||(h.selectedAccount=o.web3.eth.coinbase),d(),c(),h.desiredContribution=h.currentContribution,a(),s(),l();var n=W.ChangedContribution();n.watch(m);var i=W.Won();i.watch(b)}}function r(){function e(e,t){if(e){var o=e;o.toString().indexOf("unlock signer account")>=0&&(o+='<br><br>Make sure you\'re accessing this page through the <a href="https://github.com/ethereum/mist/releases/tag/0.3.6">early developer release</a> of Mist, the official Ethereum browser.'),n.swal({title:"Error Setting Contribution",text:o,type:"error",html:!0})}else n.swal({title:"Success!",text:"Your request has been successfully sent to the Ethereum network for processing. You'll see your account balance updated soon.<br><br><strong>This may take a minute or two</strong>.",type:"success",html:!0}),h.desiredContribution=h.currentContribution,y.segments[C[h.selectedAccount].index].value=h.currentContribution,s()}var t=o.web3.toWei(h.desiredContribution,"ether")-o.web3.toWei(h.currentContribution,"ether"),i=o.web3.toWei(h.desiredContribution,"ether"),r=0;t>0&&(r=t);var u={value:r,from:h.selectedAccount,to:w};u.gas=o.web3.eth.estimateGas(u)+1e5,console.log(u.gas.toString()),W.setContribution(i,u,e)}function u(){var e=[S],t={animationEasing:"easeInOut",segmentStrokeWidth:3,animationSteps:20,segmentStrokeColor:"#EBF0F1",percentageInnerCutout:75,responsive:!0,tooltipTemplate:function(e){var t=e.label===h.selectedAccount?"You":e.label,n=t+": "+e.value.toFixed(2)+" Îž";if(h.goal){var o=e.value/h.goal*100;n+=" ("+Math.round(100*o)/100+"%)"}return n}},n=document.getElementById("wheel").getContext("2d");y=new Chart(n).Doughnut(e,t)}function a(){if(o.isConnected()){var e=o.web3.eth.getBalance(w),t=o.web3.fromWei(e,"ether");h.balance=parseFloat(t.toString())}}function s(){var e=h.desiredContribution-h.currentContribution;h.newBalance=h.balance+e,y.segments[y.segments.length-1].value=h.goal-h.newBalance,y.update()}function c(){o.isConnected()&&(a(),h.currentContribution=parseFloat(o.web3.fromWei(W.contributions(h.selectedAccount),"ether").toString()),h.desiredContribution=Math.min(h.desiredContribution,h.goal-h.balance+h.currentContribution),s())}function d(){if(o.isConnected()){y.removeData(),C={};for(var e=W.numContributors(),t=0;e>t;++t){var n=W.contributors(t).toString();C[n]={label:n,value:o.web3.fromWei(W.contributions(n),"ether"),color:n===h.selectedAccount?"#5cb85c":"#3D3E3F",index:t},y.addData(C[n])}var i=h.selectedAccount.toString();if(!(i in C)){var r=Object.keys(C).length;C[i]={label:i,value:0,color:"#5cb85c",index:r},y.addData(C[i],r)}y.addData(S),y.update()}}function l(){if(o.isConnected()){h.recentWins=[];for(var e=W.numWinners(),t=0;e>t;++t)h.recentWins.push(W.recentWins(t))}}function p(){y.destroy(),u(),d(),c(),h.desiredContribution=h.currentContribution,a(),s()}function m(e,n){if(!e){var i=n.args.contributor.toString(),r=o.web3.fromWei(W.contributions(i),"ether");if(n.args.contributor==h.selectedAccount&&(c(),h.desiredContribution=h.currentContribution),i in C)y.segments[C[i].index].value=r;else{var u=Object.keys(C).length;C[i]={label:i,value:r,color:i===h.selectedAccount?"#5cb85c":"#3D3E3F",index:u},y.addData(C[i],u)}y.update()}a(),c(),s(),t.$apply()}function b(e,n){y.destroy(),u(),d(),c(),a(),s(),l(),t.$apply()}function f(e,t){var n=h.selectedAccount.toString();y.segments[C[n].index].value=t,s()}function g(e){return o.isConnected()?o.web3.fromWei(o.web3.eth.getBalance(e),"ether"):void 0}var h=this;h.isConnected=o.isConnected,h.setContribution=r,h.onAccountChanged=p,h.getBalance=g,h.fromWei=o.web3.fromWei,h.moment=moment;var y,C,v="#dce6e9",w="0x53891ef3793d8534Ad42312BcC77dFAd51Bb5F1C",W=null,S={value:5,color:v,label:"Empty"};i()}e.$inject=["$route","$scope","SweetAlert","ethereum"],angular.module("ether-spinner").controller("SpinnerCtrl",e)}(),function(){"use strict";function e(){function e(){n.web3.setProvider(new n.web3.providers.HttpProvider("http://localhost:8545"))}function t(){return n.web3.currentProvider.isConnected()}var n={web3:new Web3,isConnected:t};return e(),n}angular.module("ether-spinner").service("ethereum",e)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsInNwaW5uZXIuY29udHJvbGxlci5qcyIsImFwcC5taW4uanMiLCJldGhlcmV1bS5zZXJ2aWNlLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkcm91dGVQcm92aWRlciIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCJTcGlubmVyQ3RybCIsIiRyb3V0ZSIsIiRzY29wZSIsIlN3ZWV0QWxlcnQiLCJldGhlcmV1bSIsImFjdGl2YXRlIiwiY3JlYXRlQ2hhcnQiLCJpc0Nvbm5lY3RlZCIsImFiaSIsImNvbnN0YW50IiwiaW5wdXRzIiwibmFtZSIsInR5cGUiLCJvdXRwdXRzIiwiYW5vbnltb3VzIiwiaW5kZXhlZCIsImNvbnRyYWN0Qmx1ZXByaW50Iiwid2ViMyIsImV0aCIsImNvbnRyYWN0IiwiYXQiLCJjb250cmFjdEFkZHJlc3MiLCJ2bSIsImdvYWwiLCJmcm9tV2VpIiwidG9TdHJpbmciLCJzbGlkZXJTdGVwIiwiaW5jcmVtZW50Iiwib25TbGlkZXJDaGFuZ2VkIiwiZW1wdHlEYXRhU2xvdCIsInZhbHVlIiwiYWNjb3VudHMiLCJzZWxlY3RlZEFjY291bnQiLCJkZWZhdWx0QWNjb3VudCIsImNvaW5iYXNlIiwiaW5pdGlhbGl6ZUNvbnRyaWJ1dG9yc0RhdGEiLCJ1cGRhdGVDb250cmlidXRpb25zIiwiZGVzaXJlZENvbnRyaWJ1dGlvbiIsImN1cnJlbnRDb250cmlidXRpb24iLCJ1cGRhdGVCYWxhbmNlIiwidXBkYXRlTmV3QmFsYW5jZSIsInVwZGF0ZVJlY2VudFJlc3VsdHMiLCJvbkNvbnRyaWJ1dGlvbkNoYW5nZWRFdmVudCIsIkNoYW5nZWRDb250cmlidXRpb24iLCJ3YXRjaCIsIm9uQ29udHJpYnV0aW9uQ2hhbmdlZCIsIm9uV29uRXZlbnQiLCJXb24iLCJvbldvbiIsInNldENvbnRyaWJ1dGlvbiIsIm9uQ29udHJpYnV0aW9uU2V0IiwiZXJyb3IiLCJyZXN1bHQiLCJlcnJvck1lc3NhZ2UiLCJpbmRleE9mIiwic3dhbCIsInRpdGxlIiwidGV4dCIsImh0bWwiLCJjaGFydCIsInNlZ21lbnRzIiwiY29udHJpYnV0b3JzRGF0YSIsImluZGV4IiwiZGVsdGFDb250cmlidXRpb24iLCJ0b1dlaSIsImRlc2lyZWRDb250cmlidXRpb25JbldlaSIsInZhbHVlVG9TZW5kIiwidHJhbnNhY3Rpb24iLCJmcm9tIiwidG8iLCJnYXMiLCJlc3RpbWF0ZUdhcyIsImNvbnNvbGUiLCJsb2ciLCJzdGFydGluZ0RhdGEiLCJjaGFydE9wdGlvbnMiLCJhbmltYXRpb25FYXNpbmciLCJzZWdtZW50U3Ryb2tlV2lkdGgiLCJhbmltYXRpb25TdGVwcyIsInNlZ21lbnRTdHJva2VDb2xvciIsInBlcmNlbnRhZ2VJbm5lckN1dG91dCIsInJlc3BvbnNpdmUiLCJ0b29sdGlwVGVtcGxhdGUiLCJ2YWx1ZU9iamVjdCIsImxhYmVsIiwidG9vbHRpcCIsInRvRml4ZWQiLCJwZXJjZW50YWdlIiwiTWF0aCIsInJvdW5kIiwiY3R4IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImdldENvbnRleHQiLCJDaGFydCIsIkRvdWdobnV0Iiwid2VpIiwiZ2V0QmFsYW5jZSIsImV0aGVyIiwiYmFsYW5jZSIsInBhcnNlRmxvYXQiLCJuZXdCYWxhbmNlIiwibGVuZ3RoIiwidXBkYXRlIiwiY29udHJpYnV0aW9ucyIsIm1pbiIsInJlbW92ZURhdGEiLCJudW1Db250cmlidXRvcnMiLCJpIiwiY29udHJpYnV0b3JBZGRyZXNzIiwiY29udHJpYnV0b3JzIiwiY29sb3IiLCJhZGREYXRhIiwiY3VycmVudEFjY291bnQiLCJPYmplY3QiLCJrZXlzIiwicmVjZW50V2lucyIsIm51bVJlY2VudFdpbnMiLCJudW1XaW5uZXJzIiwicHVzaCIsIm9uQWNjb3VudENoYW5nZWQiLCJkZXN0cm95IiwiYXJncyIsImNvbnRyaWJ1dG9yIiwiJGFwcGx5Iiwic2xpZGVySWQiLCJtb2RlbFZhbHVlIiwiYWNjb3VudCIsInRoaXMiLCJtb21lbnQiLCJlbXB0eUJhckNvbG91ciIsIiRpbmplY3QiLCJjb250cm9sbGVyIiwic2VydmljZSIsInNldFByb3ZpZGVyIiwicHJvdmlkZXJzIiwiSHR0cFByb3ZpZGVyIiwiY3VycmVudFByb3ZpZGVyIiwiV2ViMyJdLCJtYXBwaW5ncyI6IkNBQUEsV0FDRSxZQUVBQSxTQUFRQyxPQUFPLGlCQUNiLFVBQ0EsV0FDQSx3QkFDQSxrQkFFRkMsUUFBUSxpQkFBa0IsU0FBU0MsR0FDakNBLEVBQWVDLFdBQVdDLFdBQVksWUNWMUMsV0FDRSxZQUtBLFNBQVNDLEdBQVlDLEVBQVFDLEVBQVFDLEVBQVlDLEdBeUIvQyxRQUFTQyxLQUVQLEdBREFDLElBQ0lGLEVBQVNHLGNBQWIsQ0FFQSxHQUFJQyxLQUFRQyxVQUFXLEVBQUtDLFNBQVdDLEtBQU8sR0FBR0MsS0FBTyxZQUFZRCxLQUFPLGVBQWVFLFVBQVlGLEtBQU8sR0FBR0MsS0FBTyxZQUFZQSxLQUFPLGFBQWFILFVBQVcsRUFBS0MsVUFBWUMsS0FBTyxPQUFPRSxVQUFZRixLQUFPLEdBQUdDLEtBQU8sWUFBWUEsS0FBTyxhQUFhSCxVQUFXLEVBQUtDLFNBQVdDLEtBQU8sR0FBR0MsS0FBTyxZQUFZRCxLQUFPLGdCQUFnQkUsVUFBWUYsS0FBTyxHQUFHQyxLQUFPLFlBQVlBLEtBQU8sYUFBYUgsVUFBVyxFQUFNQyxTQUFXQyxLQUFPLFVBQVVDLEtBQU8sWUFBWUQsS0FBTyxhQUFhRSxXQUFhRCxLQUFPLGFBQWFILFVBQVcsRUFBTUMsVUFBWUMsS0FBTyxVQUFVRSxXQUFhRCxLQUFPLGFBQWFILFVBQVcsRUFBTUMsU0FBV0MsS0FBTyxTQUFTQyxLQUFPLFlBQVlELEtBQU8sa0JBQWtCRSxXQUFhRCxLQUFPLGFBQWFILFVBQVcsRUFBS0MsVUFBWUMsS0FBTyxhQUFhRSxVQUFZRixLQUFPLEdBQUdDLEtBQU8sWUFBWUEsS0FBTyxhQUFhSCxVQUFXLEVBQUtDLFVBQVlDLEtBQU8sa0JBQWtCRSxVQUFZRixLQUFPLEdBQUdDLEtBQU8sWUFBWUEsS0FBTyxhQUFhSCxVQUFXLEVBQU1DLFVB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LEdBQUdmLFlBQWNILEVBQVNHLFlBQzFCZSxFQUFHMkIsZ0JBQWtCQSxFQUNyQjNCLEVBQUdrRyxpQkFBbUJBLEVBQ3RCbEcsRUFBRzJFLFdBQWFBLEVBQ2hCM0UsRUFBR0UsUUFBVXBCLEVBQVNhLEtBQUtPLFFBQzNCRixFQUFHMkcsT0FBU0EsTUFFWixJQUlJdEUsR0FDQUUsRUFMQXFFLEVBQWlCLFVBQ2pCN0csRUFBa0IsNkNBQ2xCRixFQUFXLEtBSVhVLEdBQ0ZDLE1BQU8sRUFDUGlGLE1BQU9tQixFQUNQOUMsTUFBTyxRQUdUL0UsS0NWRkwsRUFBWW1JLFNBQVcsU0FBVSxTQUFVLGFBQWMsWURkekR6SSxRQUFRQyxPQUFPLGlCQUFpQnlJLFdBQVcsY0FBZXBJLE1FSDVELFdBQ0ksWUFLQSxTQUFTSSxLQVlQLFFBQVNDLEtBQ1BnSSxFQUFRcEgsS0FBS3FILFlBQVksR0FBSUQsR0FBUXBILEtBQUtzSCxVQUFVQyxhQUFhLDBCQUduRSxRQUFTakksS0FDUCxNQUFPOEgsR0FBUXBILEtBQUt3SCxnQkFBZ0JsSSxjQWhCdEMsR0FBSThILElBQ0ZwSCxLQUFNLEdBQUl5SCxNQUNWbkksWUFBYUEsRUFLZixPQUZBRixLQUVPZ0ksRUFYVDNJLFFBQVFDLE9BQU8saUJBQWlCMEksUUFBUSxXQUFZakkiLCJmaWxlIjoiYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCdldGhlci1zcGlubmVyJywgW1xuICAgICduZ1JvdXRlJyxcbiAgICAncnpNb2R1bGUnLFxuICAgICdvaXRvemVyby5uZ1N3ZWV0QWxlcnQnLFxuICAgICdhbmd1bGFyTW9tZW50J1xuICBdKS5cbiAgY29uZmlnKFsnJHJvdXRlUHJvdmlkZXInLCBmdW5jdGlvbigkcm91dGVQcm92aWRlcikge1xuICAgICRyb3V0ZVByb3ZpZGVyLm90aGVyd2lzZSh7cmVkaXJlY3RUbzogJy8nfSk7XG4gIH1dKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnZXRoZXItc3Bpbm5lcicpLmNvbnRyb2xsZXIoJ1NwaW5uZXJDdHJsJywgU3Bpbm5lckN0cmwpO1xuXG4gIC8qQG5nSW5qZWN0Ki9cbiAgZnVuY3Rpb24gU3Bpbm5lckN0cmwoJHJvdXRlLCAkc2NvcGUsIFN3ZWV0QWxlcnQsIGV0aGVyZXVtKSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5pc0Nvbm5lY3RlZCA9IGV0aGVyZXVtLmlzQ29ubmVjdGVkO1xuICAgIHZtLnNldENvbnRyaWJ1dGlvbiA9IHNldENvbnRyaWJ1dGlvbjtcbiAgICB2bS5vbkFjY291bnRDaGFuZ2VkID0gb25BY2NvdW50Q2hhbmdlZDtcbiAgICB2bS5nZXRCYWxhbmNlID0gZ2V0QmFsYW5jZTtcbiAgICB2bS5mcm9tV2VpID0gZXRoZXJldW0ud2ViMy5mcm9tV2VpO1xuICAgIHZtLm1vbWVudCA9IG1vbWVudDtcblxuICAgIHZhciBlbXB0eUJhckNvbG91ciA9ICcjZGNlNmU5JztcbiAgICB2YXIgY29udHJhY3RBZGRyZXNzID0gJzB4NTM4OTFlZjM3OTNkODUzNEFkNDIzMTJCY0M3N2RGQWQ1MUJiNUYxQyc7XG4gICAgdmFyIGNvbnRyYWN0ID0gbnVsbDtcblxuICAgIHZhciBjaGFydDtcbiAgICB2YXIgY29udHJpYnV0b3JzRGF0YTtcbiAgICB2YXIgZW1wdHlEYXRhU2xvdCA9IHtcbiAgICAgIHZhbHVlOiA1LjAsXG4gICAgICBjb2xvcjogZW1wdHlCYXJDb2xvdXIsXG4gICAgICBsYWJlbDogXCJFbXB0eVwiXG4gICAgfTtcblxuICAgIGFjdGl2YXRlKCk7XG5cbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgIGNyZWF0ZUNoYXJ0KCk7XG4gICAgICBpZighZXRoZXJldW0uaXNDb25uZWN0ZWQoKSkgeyByZXR1cm47IH1cblxuICAgICAgdmFyIGFiaSA9IFt7XCJjb25zdGFudFwiOnRydWUsXCJpbnB1dHNcIjpbe1wibmFtZVwiOlwiXCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9XSxcIm5hbWVcIjpcImNvbnRyaWJ1dG9yc1wiLFwib3V0cHV0c1wiOlt7XCJuYW1lXCI6XCJcIixcInR5cGVcIjpcImFkZHJlc3NcIn1dLFwidHlwZVwiOlwiZnVuY3Rpb25cIn0se1wiY29uc3RhbnRcIjp0cnVlLFwiaW5wdXRzXCI6W10sXCJuYW1lXCI6XCJnb2FsXCIsXCJvdXRwdXRzXCI6W3tcIm5hbWVcIjpcIlwiLFwidHlwZVwiOlwidWludDI1NlwifV0sXCJ0eXBlXCI6XCJmdW5jdGlvblwifSx7XCJjb25zdGFudFwiOnRydWUsXCJpbnB1dHNcIjpbe1wibmFtZVwiOlwiXCIsXCJ0eXBlXCI6XCJhZGRyZXNzXCJ9XSxcIm5hbWVcIjpcImNvbnRyaWJ1dGlvbnNcIixcIm91dHB1dHNcIjpbe1wibmFtZVwiOlwiXCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9XSxcInR5cGVcIjpcImZ1bmN0aW9uXCJ9LHtcImNvbnN0YW50XCI6ZmFsc2UsXCJpbnB1dHNcIjpbe1wibmFtZVwiOlwibmV3SG9zdFwiLFwidHlwZVwiOlwiYWRkcmVzc1wifV0sXCJuYW1lXCI6XCJjaGFuZ2VIb3N0XCIsXCJvdXRwdXRzXCI6W10sXCJ0eXBlXCI6XCJmdW5jdGlvblwifSx7XCJjb25zdGFudFwiOmZhbHNlLFwiaW5wdXRzXCI6W10sXCJuYW1lXCI6XCJkZXN0cm95XCIsXCJvdXRwdXRzXCI6W10sXCJ0eXBlXCI6XCJmdW5jdGlvblwifSx7XCJjb25zdGFudFwiOmZhbHNlLFwiaW5wdXRzXCI6W3tcIm5hbWVcIjpcImFtb3VudFwiLFwidHlwZVwiOlwidWludDI1NlwifV0sXCJuYW1lXCI6XCJzZXRDb250cmlidXRpb25cIixcIm91dHB1dHNcIjpbXSxcInR5cGVcIjpcImZ1bmN0aW9uXCJ9LHtcImNvbnN0YW50XCI6dHJ1ZSxcImlucHV0c1wiOltdLFwibmFtZVwiOlwibnVtV2lubmVyc1wiLFwib3V0cHV0c1wiOlt7XCJuYW1lXCI6XCJcIixcInR5cGVcIjpcInVpbnQyNTZcIn1dLFwidHlwZVwiOlwiZnVuY3Rpb25cIn0se1wiY29uc3RhbnRcIjp0cnVlLFwiaW5wdXRzXCI6W10sXCJuYW1lXCI6XCJudW1Db250cmlidXRvcnNcIixcIm91dHB1dHNcIjpbe1wibmFtZVwiOlwiXCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9XSxcInR5cGVcIjpcImZ1bmN0aW9uXCJ9LHtcImNvbnN0YW50XCI6ZmFsc2UsXCJpbnB1dHNcIjpbXSxcIm5hbWVcIjpcImFkZFRvQ29udHJpYnV0aW9uXCIsXCJvdXRwdXRzXCI6W10sXCJ0eXBlXCI6XCJmdW5jdGlvblwifSx7XCJjb25zdGFudFwiOnRydWUsXCJpbnB1dHNcIjpbXSxcIm5hbWVcIjpcImluY3JlbWVudFwiLFwib3V0cHV0c1wiOlt7XCJuYW1lXCI6XCJcIixcInR5cGVcIjpcInVpbnQyNTZcIn1dLFwidHlwZVwiOlwiZnVuY3Rpb25cIn0se1wiY29uc3RhbnRcIjpmYWxzZSxcImlucHV0c1wiOlt7XCJuYW1lXCI6XCJhbW91bnRcIixcInR5cGVcIjpcInVpbnQyNTZcIn1dLFwibmFtZVwiOlwicmVtb3ZlRnJvbUNvbnRyaWJ1dGlvblwiLFwib3V0cHV0c1wiOltdLFwidHlwZVwiOlwiZnVuY3Rpb25cIn0se1wiY29uc3RhbnRcIjp0cnVlLFwiaW5wdXRzXCI6W3tcIm5hbWVcIjpcIlwiLFwidHlwZVwiOlwidWludDI1NlwifV0sXCJuYW1lXCI6XCJyZWNlbnRXaW5zXCIsXCJvdXRwdXRzXCI6W3tcIm5hbWVcIjpcIndpbm5lclwiLFwidHlwZVwiOlwiYWRkcmVzc1wifSx7XCJuYW1lXCI6XCJ0aW1lc3RhbXBcIixcInR5cGVcIjpcInVpbnQyNTZcIn0se1wibmFtZVwiOlwiY29udHJpYnV0aW9uXCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9XSxcInR5cGVcIjpcImZ1bmN0aW9uXCJ9LHtcImNvbnN0YW50XCI6dHJ1ZSxcImlucHV0c1wiOltdLFwibmFtZVwiOlwiaG9zdFwiLFwib3V0cHV0c1wiOlt7XCJuYW1lXCI6XCJcIixcInR5cGVcIjpcImFkZHJlc3NcIn1dLFwidHlwZVwiOlwiZnVuY3Rpb25cIn0se1wiaW5wdXRzXCI6W3tcIm5hbWVcIjpcIl9nb2FsSW5GaW5uZXlcIixcInR5cGVcIjpcInVpbnQyNTZcIn0se1wibmFtZVwiOlwiX2luY3JlbWVudEluRmlubmV5XCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9LHtcIm5hbWVcIjpcIl9yZWNlbnRXaW5zQ291bnRcIixcInR5cGVcIjpcInVpbnQ4XCJ9XSxcInR5cGVcIjpcImNvbnN0cnVjdG9yXCJ9LHtcImFub255bW91c1wiOmZhbHNlLFwiaW5wdXRzXCI6W3tcImluZGV4ZWRcIjpmYWxzZSxcIm5hbWVcIjpcIndpbm5lclwiLFwidHlwZVwiOlwiYWRkcmVzc1wifSx7XCJpbmRleGVkXCI6ZmFsc2UsXCJuYW1lXCI6XCJ0aW1lc3RhbXBcIixcInR5cGVcIjpcInVpbnQyNTZcIn0se1wiaW5kZXhlZFwiOmZhbHNlLFwibmFtZVwiOlwiY29udHJpYnV0aW9uXCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9XSxcIm5hbWVcIjpcIldvblwiLFwidHlwZVwiOlwiZXZlbnRcIn0se1wiYW5vbnltb3VzXCI6ZmFsc2UsXCJpbnB1dHNcIjpbe1wiaW5kZXhlZFwiOmZhbHNlLFwibmFtZVwiOlwiY29udHJpYnV0b3JcIixcInR5cGVcIjpcImFkZHJlc3NcIn1dLFwibmFtZVwiOlwiQ2hhbmdlZENvbnRyaWJ1dGlvblwiLFwidHlwZVwiOlwiZXZlbnRcIn1dO1xuICAgICAgdmFyIGNvbnRyYWN0Qmx1ZXByaW50ID0gZXRoZXJldW0ud2ViMy5ldGguY29udHJhY3QoYWJpKTtcbiAgICAgIGNvbnRyYWN0ID0gY29udHJhY3RCbHVlcHJpbnQuYXQoY29udHJhY3RBZGRyZXNzKTtcblxuICAgICAgdm0uZ29hbCA9IGV0aGVyZXVtLndlYjMuZnJvbVdlaShjb250cmFjdC5nb2FsKCksICdldGhlcicpLnRvU3RyaW5nKCk7XG4gICAgICB2bS5zbGlkZXJTdGVwID0gZXRoZXJldW0ud2ViMy5mcm9tV2VpKGNvbnRyYWN0LmluY3JlbWVudCgpLCAnZXRoZXInKS50b1N0cmluZygpO1xuICAgICAgdm0ub25TbGlkZXJDaGFuZ2VkID0gb25TbGlkZXJDaGFuZ2VkO1xuICAgICAgZW1wdHlEYXRhU2xvdC52YWx1ZSA9IHZtLmdvYWw7XG5cbiAgICAgIHZtLmFjY291bnRzID0gZXRoZXJldW0ud2ViMy5ldGguYWNjb3VudHM7XG4gICAgICB2bS5zZWxlY3RlZEFjY291bnQgPSBldGhlcmV1bS53ZWIzLmV0aC5kZWZhdWx0QWNjb3VudDtcbiAgICAgIGlmKCF2bS5zZWxlY3RlZEFjY291bnQpIHtcbiAgICAgICAgdm0uc2VsZWN0ZWRBY2NvdW50ID0gZXRoZXJldW0ud2ViMy5ldGguY29pbmJhc2U7XG4gICAgICB9XG5cbiAgICAgIGluaXRpYWxpemVDb250cmlidXRvcnNEYXRhKCk7XG4gICAgICB1cGRhdGVDb250cmlidXRpb25zKCk7XG4gICAgICB2bS5kZXNpcmVkQ29udHJpYnV0aW9uID0gdm0uY3VycmVudENvbnRyaWJ1dGlvbjtcblxuICAgICAgdXBkYXRlQmFsYW5jZSgpO1xuICAgICAgdXBkYXRlTmV3QmFsYW5jZSgpO1xuICAgICAgdXBkYXRlUmVjZW50UmVzdWx0cygpO1xuXG4gICAgICB2YXIgb25Db250cmlidXRpb25DaGFuZ2VkRXZlbnQgPSBjb250cmFjdC5DaGFuZ2VkQ29udHJpYnV0aW9uKCk7XG4gICAgICBvbkNvbnRyaWJ1dGlvbkNoYW5nZWRFdmVudC53YXRjaChvbkNvbnRyaWJ1dGlvbkNoYW5nZWQpO1xuXG4gICAgICB2YXIgb25Xb25FdmVudCA9IGNvbnRyYWN0LldvbigpO1xuICAgICAgb25Xb25FdmVudC53YXRjaChvbldvbik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2V0Q29udHJpYnV0aW9uKCkge1xuICAgICAgdmFyIGRlbHRhQ29udHJpYnV0aW9uID0gZXRoZXJldW0ud2ViMy50b1dlaSh2bS5kZXNpcmVkQ29udHJpYnV0aW9uLCAnZXRoZXInKSAtIGV0aGVyZXVtLndlYjMudG9XZWkodm0uY3VycmVudENvbnRyaWJ1dGlvbiwgJ2V0aGVyJyk7XG4gICAgICB2YXIgZGVzaXJlZENvbnRyaWJ1dGlvbkluV2VpID0gZXRoZXJldW0ud2ViMy50b1dlaSh2bS5kZXNpcmVkQ29udHJpYnV0aW9uLCAnZXRoZXInKTtcblxuICAgICAgdmFyIHZhbHVlVG9TZW5kID0gMDtcbiAgICAgIGlmKGRlbHRhQ29udHJpYnV0aW9uID4gMCkge1xuICAgICAgICB2YWx1ZVRvU2VuZCA9IGRlbHRhQ29udHJpYnV0aW9uO1xuICAgICAgfVxuXG4gICAgICB2YXIgdHJhbnNhY3Rpb24gPSB7IHZhbHVlOiB2YWx1ZVRvU2VuZCwgZnJvbTogdm0uc2VsZWN0ZWRBY2NvdW50LCB0bzogY29udHJhY3RBZGRyZXNzIH07XG4gICAgICB0cmFuc2FjdGlvbi5nYXMgPSBldGhlcmV1bS53ZWIzLmV0aC5lc3RpbWF0ZUdhcyh0cmFuc2FjdGlvbikgKyAxMDAwMDA7XG4gICAgICBjb25zb2xlLmxvZyh0cmFuc2FjdGlvbi5nYXMudG9TdHJpbmcoKSk7XG4gICAgICBjb250cmFjdC5zZXRDb250cmlidXRpb24oZGVzaXJlZENvbnRyaWJ1dGlvbkluV2VpLCB0cmFuc2FjdGlvbiwgb25Db250cmlidXRpb25TZXQpO1xuXG4gICAgICBmdW5jdGlvbiBvbkNvbnRyaWJ1dGlvblNldChlcnJvciwgcmVzdWx0KSB7XG4gICAgICAgIGlmKGVycm9yKSB7XG4gICAgICAgICAgdmFyIGVycm9yTWVzc2FnZSA9IGVycm9yO1xuICAgICAgICAgIGlmKGVycm9yTWVzc2FnZS50b1N0cmluZygpLmluZGV4T2YoJ3VubG9jayBzaWduZXIgYWNjb3VudCcpID49IDApIHtcbiAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlICs9IFwiPGJyPjxicj5NYWtlIHN1cmUgeW91J3JlIGFjY2Vzc2luZyB0aGlzIHBhZ2UgdGhyb3VnaCB0aGUgPGEgaHJlZj1cXFwiaHR0cHM6Ly9naXRodWIuY29tL2V0aGVyZXVtL21pc3QvcmVsZWFzZXMvdGFnLzAuMy42XFxcIj5lYXJseSBkZXZlbG9wZXIgcmVsZWFzZTwvYT4gb2YgTWlzdCwgdGhlIG9mZmljaWFsIEV0aGVyZXVtIGJyb3dzZXIuXCI7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgU3dlZXRBbGVydC5zd2FsKHtcbiAgICAgICAgICAgIHRpdGxlOiBcIkVycm9yIFNldHRpbmcgQ29udHJpYnV0aW9uXCIsXG4gICAgICAgICAgICB0ZXh0OiBlcnJvck1lc3NhZ2UsXG4gICAgICAgICAgICB0eXBlOiBcImVycm9yXCIsXG4gICAgICAgICAgICBodG1sOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgU3dlZXRBbGVydC5zd2FsKHtcbiAgICAgICAgICAgIHRpdGxlOiBcIlN1Y2Nlc3MhXCIsXG4gICAgICAgICAgICB0ZXh0OiBcIllvdXIgcmVxdWVzdCBoYXMgYmVlbiBzdWNjZXNzZnVsbHkgc2VudCB0byB0aGUgRXRoZXJldW0gbmV0d29yayBmb3IgcHJvY2Vzc2luZy4gWW91J2xsIHNlZSB5b3VyIGFjY291bnQgYmFsYW5jZSB1cGRhdGVkIHNvb24uPGJyPjxicj48c3Ryb25nPlRoaXMgbWF5IHRha2UgYSBtaW51dGUgb3IgdHdvPC9zdHJvbmc+LlwiLFxuICAgICAgICAgICAgdHlwZTogXCJzdWNjZXNzXCIsXG4gICAgICAgICAgICBodG1sOiB0cnVlXG4gICAgICAgICAgfSlcblxuICAgICAgICAgIHZtLmRlc2lyZWRDb250cmlidXRpb24gPSB2bS5jdXJyZW50Q29udHJpYnV0aW9uO1xuICAgICAgICAgIGNoYXJ0LnNlZ21lbnRzW2NvbnRyaWJ1dG9yc0RhdGFbdm0uc2VsZWN0ZWRBY2NvdW50XS5pbmRleF0udmFsdWUgPSB2bS5jdXJyZW50Q29udHJpYnV0aW9uO1xuICAgICAgICAgIHVwZGF0ZU5ld0JhbGFuY2UoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZUNoYXJ0KCkge1xuICAgICAgdmFyIHN0YXJ0aW5nRGF0YSA9IFtlbXB0eURhdGFTbG90XTtcblxuICAgICAgdmFyIGNoYXJ0T3B0aW9ucyA9IHtcbiAgICAgICAgYW5pbWF0aW9uRWFzaW5nOiAnZWFzZUluT3V0JyxcbiAgICAgICAgc2VnbWVudFN0cm9rZVdpZHRoOiAzLFxuICAgICAgICBhbmltYXRpb25TdGVwczogMjAsXG4gICAgICAgIHNlZ21lbnRTdHJva2VDb2xvcjogJyNFQkYwRjEnLFxuICAgICAgICBwZXJjZW50YWdlSW5uZXJDdXRvdXQ6IDc1LFxuICAgICAgICByZXNwb25zaXZlOiB0cnVlLFxuICAgICAgICB0b29sdGlwVGVtcGxhdGU6IGZ1bmN0aW9uKHZhbHVlT2JqZWN0KSB7XG4gICAgICAgICAgdmFyIG5hbWUgPSAodmFsdWVPYmplY3QubGFiZWwgPT09IHZtLnNlbGVjdGVkQWNjb3VudCkgPyAnWW91JyA6IHZhbHVlT2JqZWN0LmxhYmVsO1xuICAgICAgICAgIHZhciB0b29sdGlwID0gbmFtZSArICc6ICcgKyB2YWx1ZU9iamVjdC52YWx1ZS50b0ZpeGVkKDIpICsgJyDOnic7XG4gICAgICAgICAgaWYoISF2bS5nb2FsKSB7XG4gICAgICAgICAgICB2YXIgcGVyY2VudGFnZSA9ICh2YWx1ZU9iamVjdC52YWx1ZSAvIHZtLmdvYWwgKiAxMDApO1xuICAgICAgICAgICAgdG9vbHRpcCArPSAnICgnICsgTWF0aC5yb3VuZChwZXJjZW50YWdlICogMTAwKSAvIDEwMCArICclKSdcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHRvb2x0aXA7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIHZhciBjdHggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIndoZWVsXCIpLmdldENvbnRleHQoXCIyZFwiKTtcbiAgICAgIGNoYXJ0ID0gbmV3IENoYXJ0KGN0eCkuRG91Z2hudXQoc3RhcnRpbmdEYXRhLCBjaGFydE9wdGlvbnMpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHVwZGF0ZUJhbGFuY2UoKSB7XG4gICAgICBpZighZXRoZXJldW0uaXNDb25uZWN0ZWQoKSkgeyByZXR1cm47IH1cblxuICAgICAgdmFyIHdlaSA9IGV0aGVyZXVtLndlYjMuZXRoLmdldEJhbGFuY2UoY29udHJhY3RBZGRyZXNzKTtcbiAgICAgIHZhciBldGhlciA9IGV0aGVyZXVtLndlYjMuZnJvbVdlaSh3ZWksICdldGhlcicpO1xuICAgICAgdm0uYmFsYW5jZSA9IHBhcnNlRmxvYXQoZXRoZXIudG9TdHJpbmcoKSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdXBkYXRlTmV3QmFsYW5jZSgpIHtcbiAgICAgIHZhciBkZWx0YUNvbnRyaWJ1dGlvbiA9ICh2bS5kZXNpcmVkQ29udHJpYnV0aW9uIC0gdm0uY3VycmVudENvbnRyaWJ1dGlvbik7XG4gICAgICB2bS5uZXdCYWxhbmNlID0gdm0uYmFsYW5jZSArIGRlbHRhQ29udHJpYnV0aW9uO1xuICAgICAgY2hhcnQuc2VnbWVudHNbY2hhcnQuc2VnbWVudHMubGVuZ3RoIC0gMV0udmFsdWUgPSAodm0uZ29hbCAtIHZtLm5ld0JhbGFuY2UpO1xuICAgICAgY2hhcnQudXBkYXRlKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdXBkYXRlQ29udHJpYnV0aW9ucygpIHtcbiAgICAgIGlmKCFldGhlcmV1bS5pc0Nvbm5lY3RlZCgpKSB7IHJldHVybjsgfVxuXG4gICAgICB1cGRhdGVCYWxhbmNlKCk7XG4gICAgICB2bS5jdXJyZW50Q29udHJpYnV0aW9uID0gcGFyc2VGbG9hdChldGhlcmV1bS53ZWIzLmZyb21XZWkoY29udHJhY3QuY29udHJpYnV0aW9ucyh2bS5zZWxlY3RlZEFjY291bnQpLCAnZXRoZXInKS50b1N0cmluZygpKTtcbiAgICAgIHZtLmRlc2lyZWRDb250cmlidXRpb24gPSBNYXRoLm1pbih2bS5kZXNpcmVkQ29udHJpYnV0aW9uLCB2bS5nb2FsIC0gdm0uYmFsYW5jZSArIHZtLmN1cnJlbnRDb250cmlidXRpb24pO1xuICAgICAgdXBkYXRlTmV3QmFsYW5jZSgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluaXRpYWxpemVDb250cmlidXRvcnNEYXRhKCkge1xuICAgICAgaWYoIWV0aGVyZXVtLmlzQ29ubmVjdGVkKCkpIHsgcmV0dXJuOyB9XG5cbiAgICAgIGNoYXJ0LnJlbW92ZURhdGEoKTtcbiAgICAgIGNvbnRyaWJ1dG9yc0RhdGEgPSB7fTtcbiAgICAgIHZhciBudW1Db250cmlidXRvcnMgPSBjb250cmFjdC5udW1Db250cmlidXRvcnMoKTtcbiAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBudW1Db250cmlidXRvcnM7ICsraSkge1xuICAgICAgICB2YXIgY29udHJpYnV0b3JBZGRyZXNzID0gY29udHJhY3QuY29udHJpYnV0b3JzKGkpLnRvU3RyaW5nKCk7XG4gICAgICAgIGNvbnRyaWJ1dG9yc0RhdGFbY29udHJpYnV0b3JBZGRyZXNzXSA9IHtcbiAgICAgICAgICBsYWJlbDogY29udHJpYnV0b3JBZGRyZXNzLFxuICAgICAgICAgIHZhbHVlOiBldGhlcmV1bS53ZWIzLmZyb21XZWkoY29udHJhY3QuY29udHJpYnV0aW9ucyhjb250cmlidXRvckFkZHJlc3MpLCAnZXRoZXInKSxcbiAgICAgICAgICBjb2xvcjogKGNvbnRyaWJ1dG9yQWRkcmVzcyA9PT0gdm0uc2VsZWN0ZWRBY2NvdW50KSA/ICcjNWNiODVjJyA6ICcjM0QzRTNGJyxcbiAgICAgICAgICBpbmRleDogaVxuICAgICAgICB9O1xuXG4gICAgICAgIGNoYXJ0LmFkZERhdGEoY29udHJpYnV0b3JzRGF0YVtjb250cmlidXRvckFkZHJlc3NdKTtcbiAgICAgIH1cblxuICAgICAgdmFyIGN1cnJlbnRBY2NvdW50ID0gdm0uc2VsZWN0ZWRBY2NvdW50LnRvU3RyaW5nKCk7XG4gICAgICBpZighKGN1cnJlbnRBY2NvdW50IGluIGNvbnRyaWJ1dG9yc0RhdGEpKSB7XG4gICAgICAgIHZhciBpbmRleCA9IE9iamVjdC5rZXlzKGNvbnRyaWJ1dG9yc0RhdGEpLmxlbmd0aDtcbiAgICAgICAgY29udHJpYnV0b3JzRGF0YVtjdXJyZW50QWNjb3VudF0gPSB7XG4gICAgICAgICAgbGFiZWw6IGN1cnJlbnRBY2NvdW50LFxuICAgICAgICAgIHZhbHVlOiAwLFxuICAgICAgICAgIGNvbG9yOiAnIzVjYjg1YycsXG4gICAgICAgICAgaW5kZXg6IGluZGV4XG4gICAgICAgIH07XG4gICAgICAgIGNoYXJ0LmFkZERhdGEoY29udHJpYnV0b3JzRGF0YVtjdXJyZW50QWNjb3VudF0sIGluZGV4KTtcbiAgICAgIH1cblxuICAgICAgY2hhcnQuYWRkRGF0YShlbXB0eURhdGFTbG90KTtcbiAgICAgIGNoYXJ0LnVwZGF0ZSgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHVwZGF0ZVJlY2VudFJlc3VsdHMoKSB7XG4gICAgICBpZighZXRoZXJldW0uaXNDb25uZWN0ZWQoKSkgeyByZXR1cm47IH1cblxuICAgICAgdm0ucmVjZW50V2lucyA9IFtdO1xuICAgICAgdmFyIG51bVJlY2VudFdpbnMgPSBjb250cmFjdC5udW1XaW5uZXJzKCk7XG4gICAgICBmb3IodmFyIGkgPSAwOyBpIDwgbnVtUmVjZW50V2luczsgKytpKSB7XG4gICAgICAgIHZtLnJlY2VudFdpbnMucHVzaChjb250cmFjdC5yZWNlbnRXaW5zKGkpKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvbkFjY291bnRDaGFuZ2VkKCkge1xuICAgICAgY2hhcnQuZGVzdHJveSgpO1xuICAgICAgY3JlYXRlQ2hhcnQoKTtcbiAgICAgIGluaXRpYWxpemVDb250cmlidXRvcnNEYXRhKCk7XG4gICAgICB1cGRhdGVDb250cmlidXRpb25zKCk7XG4gICAgICB2bS5kZXNpcmVkQ29udHJpYnV0aW9uID0gdm0uY3VycmVudENvbnRyaWJ1dGlvbjtcblxuICAgICAgdXBkYXRlQmFsYW5jZSgpO1xuICAgICAgdXBkYXRlTmV3QmFsYW5jZSgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9uQ29udHJpYnV0aW9uQ2hhbmdlZChlcnJvciwgcmVzdWx0KSB7XG4gICAgICBpZighZXJyb3IpIHtcbiAgICAgICAgdmFyIGNvbnRyaWJ1dG9yQWRkcmVzcyA9IHJlc3VsdC5hcmdzLmNvbnRyaWJ1dG9yLnRvU3RyaW5nKCk7XG4gICAgICAgIHZhciB2YWx1ZSA9IGV0aGVyZXVtLndlYjMuZnJvbVdlaShjb250cmFjdC5jb250cmlidXRpb25zKGNvbnRyaWJ1dG9yQWRkcmVzcyksICdldGhlcicpO1xuXG4gICAgICAgIGlmKHJlc3VsdC5hcmdzLmNvbnRyaWJ1dG9yID09IHZtLnNlbGVjdGVkQWNjb3VudCkge1xuICAgICAgICAgIHVwZGF0ZUNvbnRyaWJ1dGlvbnMoKTtcbiAgICAgICAgICB2bS5kZXNpcmVkQ29udHJpYnV0aW9uID0gdm0uY3VycmVudENvbnRyaWJ1dGlvbjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmKGNvbnRyaWJ1dG9yQWRkcmVzcyBpbiBjb250cmlidXRvcnNEYXRhKSB7XG4gICAgICAgICAgY2hhcnQuc2VnbWVudHNbY29udHJpYnV0b3JzRGF0YVtjb250cmlidXRvckFkZHJlc3NdLmluZGV4XS52YWx1ZSA9IHZhbHVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBpbmRleCA9IE9iamVjdC5rZXlzKGNvbnRyaWJ1dG9yc0RhdGEpLmxlbmd0aDtcbiAgICAgICAgICBjb250cmlidXRvcnNEYXRhW2NvbnRyaWJ1dG9yQWRkcmVzc10gPSB7XG4gICAgICAgICAgICBsYWJlbDogY29udHJpYnV0b3JBZGRyZXNzLFxuICAgICAgICAgICAgdmFsdWU6IHZhbHVlLFxuICAgICAgICAgICAgY29sb3I6IChjb250cmlidXRvckFkZHJlc3MgPT09IHZtLnNlbGVjdGVkQWNjb3VudCkgPyAnIzVjYjg1YycgOiAnIzNEM0UzRicsXG4gICAgICAgICAgICBpbmRleDogaW5kZXhcbiAgICAgICAgICB9O1xuICAgICAgICAgIGNoYXJ0LmFkZERhdGEoY29udHJpYnV0b3JzRGF0YVtjb250cmlidXRvckFkZHJlc3NdLCBpbmRleCk7XG4gICAgICAgIH1cblxuICAgICAgICBjaGFydC51cGRhdGUoKTtcbiAgICAgIH1cblxuICAgICAgdXBkYXRlQmFsYW5jZSgpO1xuICAgICAgdXBkYXRlQ29udHJpYnV0aW9ucygpO1xuICAgICAgdXBkYXRlTmV3QmFsYW5jZSgpO1xuICAgICAgJHNjb3BlLiRhcHBseSgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9uV29uKGVycm9yLCByZXN1bHQpIHtcbiAgICAgIGNoYXJ0LmRlc3Ryb3koKTtcbiAgICAgIGNyZWF0ZUNoYXJ0KCk7XG4gICAgICBpbml0aWFsaXplQ29udHJpYnV0b3JzRGF0YSgpO1xuICAgICAgdXBkYXRlQ29udHJpYnV0aW9ucygpO1xuXG4gICAgICB1cGRhdGVCYWxhbmNlKCk7XG4gICAgICB1cGRhdGVOZXdCYWxhbmNlKCk7XG4gICAgICB1cGRhdGVSZWNlbnRSZXN1bHRzKCk7XG4gICAgICAkc2NvcGUuJGFwcGx5KCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25TbGlkZXJDaGFuZ2VkKHNsaWRlcklkLCBtb2RlbFZhbHVlKSB7XG4gICAgICB2YXIgY3VycmVudEFjY291bnQgPSB2bS5zZWxlY3RlZEFjY291bnQudG9TdHJpbmcoKTtcbiAgICAgIGNoYXJ0LnNlZ21lbnRzW2NvbnRyaWJ1dG9yc0RhdGFbY3VycmVudEFjY291bnRdLmluZGV4XS52YWx1ZSA9IG1vZGVsVmFsdWU7XG4gICAgICB1cGRhdGVOZXdCYWxhbmNlKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0QmFsYW5jZShhY2NvdW50KSB7XG4gICAgICBpZighZXRoZXJldW0uaXNDb25uZWN0ZWQoKSkgeyByZXR1cm47IH1cbiAgICAgIHJldHVybiBldGhlcmV1bS53ZWIzLmZyb21XZWkoZXRoZXJldW0ud2ViMy5ldGguZ2V0QmFsYW5jZShhY2NvdW50KSwgJ2V0aGVyJyk7XG4gICAgfVxuICB9XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ2V0aGVyLXNwaW5uZXInLCBbXG4gICAgJ25nUm91dGUnLFxuICAgICdyek1vZHVsZScsXG4gICAgJ29pdG96ZXJvLm5nU3dlZXRBbGVydCcsXG4gICAgJ2FuZ3VsYXJNb21lbnQnXG4gIF0pLlxuICBjb25maWcoWyckcm91dGVQcm92aWRlcicsIGZ1bmN0aW9uKCRyb3V0ZVByb3ZpZGVyKSB7XG4gICAgJHJvdXRlUHJvdmlkZXIub3RoZXJ3aXNlKHtyZWRpcmVjdFRvOiAnLyd9KTtcbiAgfV0pO1xufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgU3Bpbm5lckN0cmwuJGluamVjdCA9IFtcIiRyb3V0ZVwiLCBcIiRzY29wZVwiLCBcIlN3ZWV0QWxlcnRcIiwgXCJldGhlcmV1bVwiXTtcbiAgYW5ndWxhci5tb2R1bGUoJ2V0aGVyLXNwaW5uZXInKS5jb250cm9sbGVyKCdTcGlubmVyQ3RybCcsIFNwaW5uZXJDdHJsKTtcblxuICAvKkBuZ0luamVjdCovXG4gIGZ1bmN0aW9uIFNwaW5uZXJDdHJsKCRyb3V0ZSwgJHNjb3BlLCBTd2VldEFsZXJ0LCBldGhlcmV1bSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG4gICAgdm0uaXNDb25uZWN0ZWQgPSBldGhlcmV1bS5pc0Nvbm5lY3RlZDtcbiAgICB2bS5zZXRDb250cmlidXRpb24gPSBzZXRDb250cmlidXRpb247XG4gICAgdm0ub25BY2NvdW50Q2hhbmdlZCA9IG9uQWNjb3VudENoYW5nZWQ7XG4gICAgdm0uZ2V0QmFsYW5jZSA9IGdldEJhbGFuY2U7XG4gICAgdm0uZnJvbVdlaSA9IGV0aGVyZXVtLndlYjMuZnJvbVdlaTtcbiAgICB2bS5tb21lbnQgPSBtb21lbnQ7XG5cbiAgICB2YXIgZW1wdHlCYXJDb2xvdXIgPSAnI2RjZTZlOSc7XG4gICAgdmFyIGNvbnRyYWN0QWRkcmVzcyA9ICcweDUzODkxZWYzNzkzZDg1MzRBZDQyMzEyQmNDNzdkRkFkNTFCYjVGMUMnO1xuICAgIHZhciBjb250cmFjdCA9IG51bGw7XG5cbiAgICB2YXIgY2hhcnQ7XG4gICAgdmFyIGNvbnRyaWJ1dG9yc0RhdGE7XG4gICAgdmFyIGVtcHR5RGF0YVNsb3QgPSB7XG4gICAgICB2YWx1ZTogNS4wLFxuICAgICAgY29sb3I6IGVtcHR5QmFyQ29sb3VyLFxuICAgICAgbGFiZWw6IFwiRW1wdHlcIlxuICAgIH07XG5cbiAgICBhY3RpdmF0ZSgpO1xuXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICBjcmVhdGVDaGFydCgpO1xuICAgICAgaWYoIWV0aGVyZXVtLmlzQ29ubmVjdGVkKCkpIHsgcmV0dXJuOyB9XG5cbiAgICAgIHZhciBhYmkgPSBbe1wiY29uc3RhbnRcIjp0cnVlLFwiaW5wdXRzXCI6W3tcIm5hbWVcIjpcIlwiLFwidHlwZVwiOlwidWludDI1NlwifV0sXCJuYW1lXCI6XCJjb250cmlidXRvcnNcIixcIm91dHB1dHNcIjpbe1wibmFtZVwiOlwiXCIsXCJ0eXBlXCI6XCJhZGRyZXNzXCJ9XSxcInR5cGVcIjpcImZ1bmN0aW9uXCJ9LHtcImNvbnN0YW50XCI6dHJ1ZSxcImlucHV0c1wiOltdLFwibmFtZVwiOlwiZ29hbFwiLFwib3V0cHV0c1wiOlt7XCJuYW1lXCI6XCJcIixcInR5cGVcIjpcInVpbnQyNTZcIn1dLFwidHlwZVwiOlwiZnVuY3Rpb25cIn0se1wiY29uc3RhbnRcIjp0cnVlLFwiaW5wdXRzXCI6W3tcIm5hbWVcIjpcIlwiLFwidHlwZVwiOlwiYWRkcmVzc1wifV0sXCJuYW1lXCI6XCJjb250cmlidXRpb25zXCIsXCJvdXRwdXRzXCI6W3tcIm5hbWVcIjpcIlwiLFwidHlwZVwiOlwidWludDI1NlwifV0sXCJ0eXBlXCI6XCJmdW5jdGlvblwifSx7XCJjb25zdGFudFwiOmZhbHNlLFwiaW5wdXRzXCI6W3tcIm5hbWVcIjpcIm5ld0hvc3RcIixcInR5cGVcIjpcImFkZHJlc3NcIn1dLFwibmFtZVwiOlwiY2hhbmdlSG9zdFwiLFwib3V0cHV0c1wiOltdLFwidHlwZVwiOlwiZnVuY3Rpb25cIn0se1wiY29uc3RhbnRcIjpmYWxzZSxcImlucHV0c1wiOltdLFwibmFtZVwiOlwiZGVzdHJveVwiLFwib3V0cHV0c1wiOltdLFwidHlwZVwiOlwiZnVuY3Rpb25cIn0se1wiY29uc3RhbnRcIjpmYWxzZSxcImlucHV0c1wiOlt7XCJuYW1lXCI6XCJhbW91bnRcIixcInR5cGVcIjpcInVpbnQyNTZcIn1dLFwibmFtZVwiOlwic2V0Q29udHJpYnV0aW9uXCIsXCJvdXRwdXRzXCI6W10sXCJ0eXBlXCI6XCJmdW5jdGlvblwifSx7XCJjb25zdGFudFwiOnRydWUsXCJpbnB1dHNcIjpbXSxcIm5hbWVcIjpcIm51bVdpbm5lcnNcIixcIm91dHB1dHNcIjpbe1wibmFtZVwiOlwiXCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9XSxcInR5cGVcIjpcImZ1bmN0aW9uXCJ9LHtcImNvbnN0YW50XCI6dHJ1ZSxcImlucHV0c1wiOltdLFwibmFtZVwiOlwibnVtQ29udHJpYnV0b3JzXCIsXCJvdXRwdXRzXCI6W3tcIm5hbWVcIjpcIlwiLFwidHlwZVwiOlwidWludDI1NlwifV0sXCJ0eXBlXCI6XCJmdW5jdGlvblwifSx7XCJjb25zdGFudFwiOmZhbHNlLFwiaW5wdXRzXCI6W10sXCJuYW1lXCI6XCJhZGRUb0NvbnRyaWJ1dGlvblwiLFwib3V0cHV0c1wiOltdLFwidHlwZVwiOlwiZnVuY3Rpb25cIn0se1wiY29uc3RhbnRcIjp0cnVlLFwiaW5wdXRzXCI6W10sXCJuYW1lXCI6XCJpbmNyZW1lbnRcIixcIm91dHB1dHNcIjpbe1wibmFtZVwiOlwiXCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9XSxcInR5cGVcIjpcImZ1bmN0aW9uXCJ9LHtcImNvbnN0YW50XCI6ZmFsc2UsXCJpbnB1dHNcIjpbe1wibmFtZVwiOlwiYW1vdW50XCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9XSxcIm5hbWVcIjpcInJlbW92ZUZyb21Db250cmlidXRpb25cIixcIm91dHB1dHNcIjpbXSxcInR5cGVcIjpcImZ1bmN0aW9uXCJ9LHtcImNvbnN0YW50XCI6dHJ1ZSxcImlucHV0c1wiOlt7XCJuYW1lXCI6XCJcIixcInR5cGVcIjpcInVpbnQyNTZcIn1dLFwibmFtZVwiOlwicmVjZW50V2luc1wiLFwib3V0cHV0c1wiOlt7XCJuYW1lXCI6XCJ3aW5uZXJcIixcInR5cGVcIjpcImFkZHJlc3NcIn0se1wibmFtZVwiOlwidGltZXN0YW1wXCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9LHtcIm5hbWVcIjpcImNvbnRyaWJ1dGlvblwiLFwidHlwZVwiOlwidWludDI1NlwifV0sXCJ0eXBlXCI6XCJmdW5jdGlvblwifSx7XCJjb25zdGFudFwiOnRydWUsXCJpbnB1dHNcIjpbXSxcIm5hbWVcIjpcImhvc3RcIixcIm91dHB1dHNcIjpbe1wibmFtZVwiOlwiXCIsXCJ0eXBlXCI6XCJhZGRyZXNzXCJ9XSxcInR5cGVcIjpcImZ1bmN0aW9uXCJ9LHtcImlucHV0c1wiOlt7XCJuYW1lXCI6XCJfZ29hbEluRmlubmV5XCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9LHtcIm5hbWVcIjpcIl9pbmNyZW1lbnRJbkZpbm5leVwiLFwidHlwZVwiOlwidWludDI1NlwifSx7XCJuYW1lXCI6XCJfcmVjZW50V2luc0NvdW50XCIsXCJ0eXBlXCI6XCJ1aW50OFwifV0sXCJ0eXBlXCI6XCJjb25zdHJ1Y3RvclwifSx7XCJhbm9ueW1vdXNcIjpmYWxzZSxcImlucHV0c1wiOlt7XCJpbmRleGVkXCI6ZmFsc2UsXCJuYW1lXCI6XCJ3aW5uZXJcIixcInR5cGVcIjpcImFkZHJlc3NcIn0se1wiaW5kZXhlZFwiOmZhbHNlLFwibmFtZVwiOlwidGltZXN0YW1wXCIsXCJ0eXBlXCI6XCJ1aW50MjU2XCJ9LHtcImluZGV4ZWRcIjpmYWxzZSxcIm5hbWVcIjpcImNvbnRyaWJ1dGlvblwiLFwidHlwZVwiOlwidWludDI1NlwifV0sXCJuYW1lXCI6XCJXb25cIixcInR5cGVcIjpcImV2ZW50XCJ9LHtcImFub255bW91c1wiOmZhbHNlLFwiaW5wdXRzXCI6W3tcImluZGV4ZWRcIjpmYWxzZSxcIm5hbWVcIjpcImNvbnRyaWJ1dG9yXCIsXCJ0eXBlXCI6XCJhZGRyZXNzXCJ9XSxcIm5hbWVcIjpcIkNoYW5nZWRDb250cmlidXRpb25cIixcInR5cGVcIjpcImV2ZW50XCJ9XTtcbiAgICAgIHZhciBjb250cmFjdEJsdWVwcmludCA9IGV0aGVyZXVtLndlYjMuZXRoLmNvbnRyYWN0KGFiaSk7XG4gICAgICBjb250cmFjdCA9IGNvbnRyYWN0Qmx1ZXByaW50LmF0KGNvbnRyYWN0QWRkcmVzcyk7XG5cbiAgICAgIHZtLmdvYWwgPSBldGhlcmV1bS53ZWIzLmZyb21XZWkoY29udHJhY3QuZ29hbCgpLCAnZXRoZXInKS50b1N0cmluZygpO1xuICAgICAgdm0uc2xpZGVyU3RlcCA9IGV0aGVyZXVtLndlYjMuZnJvbVdlaShjb250cmFjdC5pbmNyZW1lbnQoKSwgJ2V0aGVyJykudG9TdHJpbmcoKTtcbiAgICAgIHZtLm9uU2xpZGVyQ2hhbmdlZCA9IG9uU2xpZGVyQ2hhbmdlZDtcbiAgICAgIGVtcHR5RGF0YVNsb3QudmFsdWUgPSB2bS5nb2FsO1xuXG4gICAgICB2bS5hY2NvdW50cyA9IGV0aGVyZXVtLndlYjMuZXRoLmFjY291bnRzO1xuICAgICAgdm0uc2VsZWN0ZWRBY2NvdW50ID0gZXRoZXJldW0ud2ViMy5ldGguZGVmYXVsdEFjY291bnQ7XG4gICAgICBpZighdm0uc2VsZWN0ZWRBY2NvdW50KSB7XG4gICAgICAgIHZtLnNlbGVjdGVkQWNjb3VudCA9IGV0aGVyZXVtLndlYjMuZXRoLmNvaW5iYXNlO1xuICAgICAgfVxuXG4gICAgICBpbml0aWFsaXplQ29udHJpYnV0b3JzRGF0YSgpO1xuICAgICAgdXBkYXRlQ29udHJpYnV0aW9ucygpO1xuICAgICAgdm0uZGVzaXJlZENvbnRyaWJ1dGlvbiA9IHZtLmN1cnJlbnRDb250cmlidXRpb247XG5cbiAgICAgIHVwZGF0ZUJhbGFuY2UoKTtcbiAgICAgIHVwZGF0ZU5ld0JhbGFuY2UoKTtcbiAgICAgIHVwZGF0ZVJlY2VudFJlc3VsdHMoKTtcblxuICAgICAgdmFyIG9uQ29udHJpYnV0aW9uQ2hhbmdlZEV2ZW50ID0gY29udHJhY3QuQ2hhbmdlZENvbnRyaWJ1dGlvbigpO1xuICAgICAgb25Db250cmlidXRpb25DaGFuZ2VkRXZlbnQud2F0Y2gob25Db250cmlidXRpb25DaGFuZ2VkKTtcblxuICAgICAgdmFyIG9uV29uRXZlbnQgPSBjb250cmFjdC5Xb24oKTtcbiAgICAgIG9uV29uRXZlbnQud2F0Y2gob25Xb24pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldENvbnRyaWJ1dGlvbigpIHtcbiAgICAgIHZhciBkZWx0YUNvbnRyaWJ1dGlvbiA9IGV0aGVyZXVtLndlYjMudG9XZWkodm0uZGVzaXJlZENvbnRyaWJ1dGlvbiwgJ2V0aGVyJykgLSBldGhlcmV1bS53ZWIzLnRvV2VpKHZtLmN1cnJlbnRDb250cmlidXRpb24sICdldGhlcicpO1xuICAgICAgdmFyIGRlc2lyZWRDb250cmlidXRpb25JbldlaSA9IGV0aGVyZXVtLndlYjMudG9XZWkodm0uZGVzaXJlZENvbnRyaWJ1dGlvbiwgJ2V0aGVyJyk7XG5cbiAgICAgIHZhciB2YWx1ZVRvU2VuZCA9IDA7XG4gICAgICBpZihkZWx0YUNvbnRyaWJ1dGlvbiA+IDApIHtcbiAgICAgICAgdmFsdWVUb1NlbmQgPSBkZWx0YUNvbnRyaWJ1dGlvbjtcbiAgICAgIH1cblxuICAgICAgdmFyIHRyYW5zYWN0aW9uID0geyB2YWx1ZTogdmFsdWVUb1NlbmQsIGZyb206IHZtLnNlbGVjdGVkQWNjb3VudCwgdG86IGNvbnRyYWN0QWRkcmVzcyB9O1xuICAgICAgdHJhbnNhY3Rpb24uZ2FzID0gZXRoZXJldW0ud2ViMy5ldGguZXN0aW1hdGVHYXModHJhbnNhY3Rpb24pICsgMTAwMDAwO1xuICAgICAgY29uc29sZS5sb2codHJhbnNhY3Rpb24uZ2FzLnRvU3RyaW5nKCkpO1xuICAgICAgY29udHJhY3Quc2V0Q29udHJpYnV0aW9uKGRlc2lyZWRDb250cmlidXRpb25JbldlaSwgdHJhbnNhY3Rpb24sIG9uQ29udHJpYnV0aW9uU2V0KTtcblxuICAgICAgZnVuY3Rpb24gb25Db250cmlidXRpb25TZXQoZXJyb3IsIHJlc3VsdCkge1xuICAgICAgICBpZihlcnJvcikge1xuICAgICAgICAgIHZhciBlcnJvck1lc3NhZ2UgPSBlcnJvcjtcbiAgICAgICAgICBpZihlcnJvck1lc3NhZ2UudG9TdHJpbmcoKS5pbmRleE9mKCd1bmxvY2sgc2lnbmVyIGFjY291bnQnKSA+PSAwKSB7XG4gICAgICAgICAgICAgIGVycm9yTWVzc2FnZSArPSBcIjxicj48YnI+TWFrZSBzdXJlIHlvdSdyZSBhY2Nlc3NpbmcgdGhpcyBwYWdlIHRocm91Z2ggdGhlIDxhIGhyZWY9XFxcImh0dHBzOi8vZ2l0aHViLmNvbS9ldGhlcmV1bS9taXN0L3JlbGVhc2VzL3RhZy8wLjMuNlxcXCI+ZWFybHkgZGV2ZWxvcGVyIHJlbGVhc2U8L2E+IG9mIE1pc3QsIHRoZSBvZmZpY2lhbCBFdGhlcmV1bSBicm93c2VyLlwiO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIFN3ZWV0QWxlcnQuc3dhbCh7XG4gICAgICAgICAgICB0aXRsZTogXCJFcnJvciBTZXR0aW5nIENvbnRyaWJ1dGlvblwiLFxuICAgICAgICAgICAgdGV4dDogZXJyb3JNZXNzYWdlLFxuICAgICAgICAgICAgdHlwZTogXCJlcnJvclwiLFxuICAgICAgICAgICAgaHRtbDogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIFN3ZWV0QWxlcnQuc3dhbCh7XG4gICAgICAgICAgICB0aXRsZTogXCJTdWNjZXNzIVwiLFxuICAgICAgICAgICAgdGV4dDogXCJZb3VyIHJlcXVlc3QgaGFzIGJlZW4gc3VjY2Vzc2Z1bGx5IHNlbnQgdG8gdGhlIEV0aGVyZXVtIG5ldHdvcmsgZm9yIHByb2Nlc3NpbmcuIFlvdSdsbCBzZWUgeW91ciBhY2NvdW50IGJhbGFuY2UgdXBkYXRlZCBzb29uLjxicj48YnI+PHN0cm9uZz5UaGlzIG1heSB0YWtlIGEgbWludXRlIG9yIHR3bzwvc3Ryb25nPi5cIixcbiAgICAgICAgICAgIHR5cGU6IFwic3VjY2Vzc1wiLFxuICAgICAgICAgICAgaHRtbDogdHJ1ZVxuICAgICAgICAgIH0pXG5cbiAgICAgICAgICB2bS5kZXNpcmVkQ29udHJpYnV0aW9uID0gdm0uY3VycmVudENvbnRyaWJ1dGlvbjtcbiAgICAgICAgICBjaGFydC5zZWdtZW50c1tjb250cmlidXRvcnNEYXRhW3ZtLnNlbGVjdGVkQWNjb3VudF0uaW5kZXhdLnZhbHVlID0gdm0uY3VycmVudENvbnRyaWJ1dGlvbjtcbiAgICAgICAgICB1cGRhdGVOZXdCYWxhbmNlKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVDaGFydCgpIHtcbiAgICAgIHZhciBzdGFydGluZ0RhdGEgPSBbZW1wdHlEYXRhU2xvdF07XG5cbiAgICAgIHZhciBjaGFydE9wdGlvbnMgPSB7XG4gICAgICAgIGFuaW1hdGlvbkVhc2luZzogJ2Vhc2VJbk91dCcsXG4gICAgICAgIHNlZ21lbnRTdHJva2VXaWR0aDogMyxcbiAgICAgICAgYW5pbWF0aW9uU3RlcHM6IDIwLFxuICAgICAgICBzZWdtZW50U3Ryb2tlQ29sb3I6ICcjRUJGMEYxJyxcbiAgICAgICAgcGVyY2VudGFnZUlubmVyQ3V0b3V0OiA3NSxcbiAgICAgICAgcmVzcG9uc2l2ZTogdHJ1ZSxcbiAgICAgICAgdG9vbHRpcFRlbXBsYXRlOiBmdW5jdGlvbih2YWx1ZU9iamVjdCkge1xuICAgICAgICAgIHZhciBuYW1lID0gKHZhbHVlT2JqZWN0LmxhYmVsID09PSB2bS5zZWxlY3RlZEFjY291bnQpID8gJ1lvdScgOiB2YWx1ZU9iamVjdC5sYWJlbDtcbiAgICAgICAgICB2YXIgdG9vbHRpcCA9IG5hbWUgKyAnOiAnICsgdmFsdWVPYmplY3QudmFsdWUudG9GaXhlZCgyKSArICcgzp4nO1xuICAgICAgICAgIGlmKCEhdm0uZ29hbCkge1xuICAgICAgICAgICAgdmFyIHBlcmNlbnRhZ2UgPSAodmFsdWVPYmplY3QudmFsdWUgLyB2bS5nb2FsICogMTAwKTtcbiAgICAgICAgICAgIHRvb2x0aXAgKz0gJyAoJyArIE1hdGgucm91bmQocGVyY2VudGFnZSAqIDEwMCkgLyAxMDAgKyAnJSknXG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB0b29sdGlwO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICB2YXIgY3R4ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ3aGVlbFwiKS5nZXRDb250ZXh0KFwiMmRcIik7XG4gICAgICBjaGFydCA9IG5ldyBDaGFydChjdHgpLkRvdWdobnV0KHN0YXJ0aW5nRGF0YSwgY2hhcnRPcHRpb25zKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB1cGRhdGVCYWxhbmNlKCkge1xuICAgICAgaWYoIWV0aGVyZXVtLmlzQ29ubmVjdGVkKCkpIHsgcmV0dXJuOyB9XG5cbiAgICAgIHZhciB3ZWkgPSBldGhlcmV1bS53ZWIzLmV0aC5nZXRCYWxhbmNlKGNvbnRyYWN0QWRkcmVzcyk7XG4gICAgICB2YXIgZXRoZXIgPSBldGhlcmV1bS53ZWIzLmZyb21XZWkod2VpLCAnZXRoZXInKTtcbiAgICAgIHZtLmJhbGFuY2UgPSBwYXJzZUZsb2F0KGV0aGVyLnRvU3RyaW5nKCkpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHVwZGF0ZU5ld0JhbGFuY2UoKSB7XG4gICAgICB2YXIgZGVsdGFDb250cmlidXRpb24gPSAodm0uZGVzaXJlZENvbnRyaWJ1dGlvbiAtIHZtLmN1cnJlbnRDb250cmlidXRpb24pO1xuICAgICAgdm0ubmV3QmFsYW5jZSA9IHZtLmJhbGFuY2UgKyBkZWx0YUNvbnRyaWJ1dGlvbjtcbiAgICAgIGNoYXJ0LnNlZ21lbnRzW2NoYXJ0LnNlZ21lbnRzLmxlbmd0aCAtIDFdLnZhbHVlID0gKHZtLmdvYWwgLSB2bS5uZXdCYWxhbmNlKTtcbiAgICAgIGNoYXJ0LnVwZGF0ZSgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHVwZGF0ZUNvbnRyaWJ1dGlvbnMoKSB7XG4gICAgICBpZighZXRoZXJldW0uaXNDb25uZWN0ZWQoKSkgeyByZXR1cm47IH1cblxuICAgICAgdXBkYXRlQmFsYW5jZSgpO1xuICAgICAgdm0uY3VycmVudENvbnRyaWJ1dGlvbiA9IHBhcnNlRmxvYXQoZXRoZXJldW0ud2ViMy5mcm9tV2VpKGNvbnRyYWN0LmNvbnRyaWJ1dGlvbnModm0uc2VsZWN0ZWRBY2NvdW50KSwgJ2V0aGVyJykudG9TdHJpbmcoKSk7XG4gICAgICB2bS5kZXNpcmVkQ29udHJpYnV0aW9uID0gTWF0aC5taW4odm0uZGVzaXJlZENvbnRyaWJ1dGlvbiwgdm0uZ29hbCAtIHZtLmJhbGFuY2UgKyB2bS5jdXJyZW50Q29udHJpYnV0aW9uKTtcbiAgICAgIHVwZGF0ZU5ld0JhbGFuY2UoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbml0aWFsaXplQ29udHJpYnV0b3JzRGF0YSgpIHtcbiAgICAgIGlmKCFldGhlcmV1bS5pc0Nvbm5lY3RlZCgpKSB7IHJldHVybjsgfVxuXG4gICAgICBjaGFydC5yZW1vdmVEYXRhKCk7XG4gICAgICBjb250cmlidXRvcnNEYXRhID0ge307XG4gICAgICB2YXIgbnVtQ29udHJpYnV0b3JzID0gY29udHJhY3QubnVtQ29udHJpYnV0b3JzKCk7XG4gICAgICBmb3IodmFyIGkgPSAwOyBpIDwgbnVtQ29udHJpYnV0b3JzOyArK2kpIHtcbiAgICAgICAgdmFyIGNvbnRyaWJ1dG9yQWRkcmVzcyA9IGNvbnRyYWN0LmNvbnRyaWJ1dG9ycyhpKS50b1N0cmluZygpO1xuICAgICAgICBjb250cmlidXRvcnNEYXRhW2NvbnRyaWJ1dG9yQWRkcmVzc10gPSB7XG4gICAgICAgICAgbGFiZWw6IGNvbnRyaWJ1dG9yQWRkcmVzcyxcbiAgICAgICAgICB2YWx1ZTogZXRoZXJldW0ud2ViMy5mcm9tV2VpKGNvbnRyYWN0LmNvbnRyaWJ1dGlvbnMoY29udHJpYnV0b3JBZGRyZXNzKSwgJ2V0aGVyJyksXG4gICAgICAgICAgY29sb3I6IChjb250cmlidXRvckFkZHJlc3MgPT09IHZtLnNlbGVjdGVkQWNjb3VudCkgPyAnIzVjYjg1YycgOiAnIzNEM0UzRicsXG4gICAgICAgICAgaW5kZXg6IGlcbiAgICAgICAgfTtcblxuICAgICAgICBjaGFydC5hZGREYXRhKGNvbnRyaWJ1dG9yc0RhdGFbY29udHJpYnV0b3JBZGRyZXNzXSk7XG4gICAgICB9XG5cbiAgICAgIHZhciBjdXJyZW50QWNjb3VudCA9IHZtLnNlbGVjdGVkQWNjb3VudC50b1N0cmluZygpO1xuICAgICAgaWYoIShjdXJyZW50QWNjb3VudCBpbiBjb250cmlidXRvcnNEYXRhKSkge1xuICAgICAgICB2YXIgaW5kZXggPSBPYmplY3Qua2V5cyhjb250cmlidXRvcnNEYXRhKS5sZW5ndGg7XG4gICAgICAgIGNvbnRyaWJ1dG9yc0RhdGFbY3VycmVudEFjY291bnRdID0ge1xuICAgICAgICAgIGxhYmVsOiBjdXJyZW50QWNjb3VudCxcbiAgICAgICAgICB2YWx1ZTogMCxcbiAgICAgICAgICBjb2xvcjogJyM1Y2I4NWMnLFxuICAgICAgICAgIGluZGV4OiBpbmRleFxuICAgICAgICB9O1xuICAgICAgICBjaGFydC5hZGREYXRhKGNvbnRyaWJ1dG9yc0RhdGFbY3VycmVudEFjY291bnRdLCBpbmRleCk7XG4gICAgICB9XG5cbiAgICAgIGNoYXJ0LmFkZERhdGEoZW1wdHlEYXRhU2xvdCk7XG4gICAgICBjaGFydC51cGRhdGUoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB1cGRhdGVSZWNlbnRSZXN1bHRzKCkge1xuICAgICAgaWYoIWV0aGVyZXVtLmlzQ29ubmVjdGVkKCkpIHsgcmV0dXJuOyB9XG5cbiAgICAgIHZtLnJlY2VudFdpbnMgPSBbXTtcbiAgICAgIHZhciBudW1SZWNlbnRXaW5zID0gY29udHJhY3QubnVtV2lubmVycygpO1xuICAgICAgZm9yKHZhciBpID0gMDsgaSA8IG51bVJlY2VudFdpbnM7ICsraSkge1xuICAgICAgICB2bS5yZWNlbnRXaW5zLnB1c2goY29udHJhY3QucmVjZW50V2lucyhpKSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25BY2NvdW50Q2hhbmdlZCgpIHtcbiAgICAgIGNoYXJ0LmRlc3Ryb3koKTtcbiAgICAgIGNyZWF0ZUNoYXJ0KCk7XG4gICAgICBpbml0aWFsaXplQ29udHJpYnV0b3JzRGF0YSgpO1xuICAgICAgdXBkYXRlQ29udHJpYnV0aW9ucygpO1xuICAgICAgdm0uZGVzaXJlZENvbnRyaWJ1dGlvbiA9IHZtLmN1cnJlbnRDb250cmlidXRpb247XG5cbiAgICAgIHVwZGF0ZUJhbGFuY2UoKTtcbiAgICAgIHVwZGF0ZU5ld0JhbGFuY2UoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvbkNvbnRyaWJ1dGlvbkNoYW5nZWQoZXJyb3IsIHJlc3VsdCkge1xuICAgICAgaWYoIWVycm9yKSB7XG4gICAgICAgIHZhciBjb250cmlidXRvckFkZHJlc3MgPSByZXN1bHQuYXJncy5jb250cmlidXRvci50b1N0cmluZygpO1xuICAgICAgICB2YXIgdmFsdWUgPSBldGhlcmV1bS53ZWIzLmZyb21XZWkoY29udHJhY3QuY29udHJpYnV0aW9ucyhjb250cmlidXRvckFkZHJlc3MpLCAnZXRoZXInKTtcblxuICAgICAgICBpZihyZXN1bHQuYXJncy5jb250cmlidXRvciA9PSB2bS5zZWxlY3RlZEFjY291bnQpIHtcbiAgICAgICAgICB1cGRhdGVDb250cmlidXRpb25zKCk7XG4gICAgICAgICAgdm0uZGVzaXJlZENvbnRyaWJ1dGlvbiA9IHZtLmN1cnJlbnRDb250cmlidXRpb247XG4gICAgICAgIH1cblxuICAgICAgICBpZihjb250cmlidXRvckFkZHJlc3MgaW4gY29udHJpYnV0b3JzRGF0YSkge1xuICAgICAgICAgIGNoYXJ0LnNlZ21lbnRzW2NvbnRyaWJ1dG9yc0RhdGFbY29udHJpYnV0b3JBZGRyZXNzXS5pbmRleF0udmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgaW5kZXggPSBPYmplY3Qua2V5cyhjb250cmlidXRvcnNEYXRhKS5sZW5ndGg7XG4gICAgICAgICAgY29udHJpYnV0b3JzRGF0YVtjb250cmlidXRvckFkZHJlc3NdID0ge1xuICAgICAgICAgICAgbGFiZWw6IGNvbnRyaWJ1dG9yQWRkcmVzcyxcbiAgICAgICAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgICAgICAgIGNvbG9yOiAoY29udHJpYnV0b3JBZGRyZXNzID09PSB2bS5zZWxlY3RlZEFjY291bnQpID8gJyM1Y2I4NWMnIDogJyMzRDNFM0YnLFxuICAgICAgICAgICAgaW5kZXg6IGluZGV4XG4gICAgICAgICAgfTtcbiAgICAgICAgICBjaGFydC5hZGREYXRhKGNvbnRyaWJ1dG9yc0RhdGFbY29udHJpYnV0b3JBZGRyZXNzXSwgaW5kZXgpO1xuICAgICAgICB9XG5cbiAgICAgICAgY2hhcnQudXBkYXRlKCk7XG4gICAgICB9XG5cbiAgICAgIHVwZGF0ZUJhbGFuY2UoKTtcbiAgICAgIHVwZGF0ZUNvbnRyaWJ1dGlvbnMoKTtcbiAgICAgIHVwZGF0ZU5ld0JhbGFuY2UoKTtcbiAgICAgICRzY29wZS4kYXBwbHkoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvbldvbihlcnJvciwgcmVzdWx0KSB7XG4gICAgICBjaGFydC5kZXN0cm95KCk7XG4gICAgICBjcmVhdGVDaGFydCgpO1xuICAgICAgaW5pdGlhbGl6ZUNvbnRyaWJ1dG9yc0RhdGEoKTtcbiAgICAgIHVwZGF0ZUNvbnRyaWJ1dGlvbnMoKTtcblxuICAgICAgdXBkYXRlQmFsYW5jZSgpO1xuICAgICAgdXBkYXRlTmV3QmFsYW5jZSgpO1xuICAgICAgdXBkYXRlUmVjZW50UmVzdWx0cygpO1xuICAgICAgJHNjb3BlLiRhcHBseSgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9uU2xpZGVyQ2hhbmdlZChzbGlkZXJJZCwgbW9kZWxWYWx1ZSkge1xuICAgICAgdmFyIGN1cnJlbnRBY2NvdW50ID0gdm0uc2VsZWN0ZWRBY2NvdW50LnRvU3RyaW5nKCk7XG4gICAgICBjaGFydC5zZWdtZW50c1tjb250cmlidXRvcnNEYXRhW2N1cnJlbnRBY2NvdW50XS5pbmRleF0udmFsdWUgPSBtb2RlbFZhbHVlO1xuICAgICAgdXBkYXRlTmV3QmFsYW5jZSgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldEJhbGFuY2UoYWNjb3VudCkge1xuICAgICAgaWYoIWV0aGVyZXVtLmlzQ29ubmVjdGVkKCkpIHsgcmV0dXJuOyB9XG4gICAgICByZXR1cm4gZXRoZXJldW0ud2ViMy5mcm9tV2VpKGV0aGVyZXVtLndlYjMuZXRoLmdldEJhbGFuY2UoYWNjb3VudCksICdldGhlcicpO1xuICAgIH1cbiAgfVxufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdldGhlci1zcGlubmVyJykuc2VydmljZSgnZXRoZXJldW0nLCBldGhlcmV1bSk7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBldGhlcmV1bSgpIHtcbiAgICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgICB3ZWIzOiBuZXcgV2ViMygpLFxuICAgICAgICBpc0Nvbm5lY3RlZDogaXNDb25uZWN0ZWRcbiAgICAgIH07XG5cbiAgICAgIGFjdGl2YXRlKCk7XG5cbiAgICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuICAgICAgICBzZXJ2aWNlLndlYjMuc2V0UHJvdmlkZXIobmV3IHNlcnZpY2Uud2ViMy5wcm92aWRlcnMuSHR0cFByb3ZpZGVyKFwiaHR0cDovL2xvY2FsaG9zdDo4NTQ1XCIpKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gaXNDb25uZWN0ZWQoKSB7XG4gICAgICAgIHJldHVybiBzZXJ2aWNlLndlYjMuY3VycmVudFByb3ZpZGVyLmlzQ29ubmVjdGVkKCk7XG4gICAgICB9XG4gICAgfVxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnZXRoZXItc3Bpbm5lcicpLnNlcnZpY2UoJ2V0aGVyZXVtJywgZXRoZXJldW0pO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gZXRoZXJldW0oKSB7XG4gICAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgICAgd2ViMzogbmV3IFdlYjMoKSxcbiAgICAgICAgaXNDb25uZWN0ZWQ6IGlzQ29ubmVjdGVkXG4gICAgICB9O1xuXG4gICAgICBhY3RpdmF0ZSgpO1xuXG4gICAgICByZXR1cm4gc2VydmljZTtcblxuICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgICAgc2VydmljZS53ZWIzLnNldFByb3ZpZGVyKG5ldyBzZXJ2aWNlLndlYjMucHJvdmlkZXJzLkh0dHBQcm92aWRlcihcImh0dHA6Ly9sb2NhbGhvc3Q6ODU0NVwiKSk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGlzQ29ubmVjdGVkKCkge1xuICAgICAgICByZXR1cm4gc2VydmljZS53ZWIzLmN1cnJlbnRQcm92aWRlci5pc0Nvbm5lY3RlZCgpO1xuICAgICAgfVxuICAgIH1cbn0pKCk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
